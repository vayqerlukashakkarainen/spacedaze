import{U as qe}from"./kaplay-D9oRpw-2.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function o(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=o(a);fetch(a.href,i)}})();const Ce={toolName:"Blaster",upgrades:[{name:"Level 1",desc:"Add a second blaster to your ship",price:12,sprite:"blaster1",value:1},{name:"Level 2",desc:"Add a third blaster to your ship",price:12,sprite:"blaster1",value:2}]},Ne={toolName:"Parallel processor",requiredTool:"blaster",upgrades:[{name:"Level 1",desc:"Fire all blasters at the same time",price:12,sprite:"parallel_blasters_upg1",value:1}]},Re={toolName:"Blaster speed",requiredTool:"blaster",upgrades:[{name:"Level 1",desc:"Increase velocity of blaster projectiles",price:12,sprite:"blaster_upg_speed1",value:1.65}]},We={toolName:"Blaster dmg",requiredTool:"blaster",upgrades:[{name:"Level 1",desc:"Increase damage of the ships primary blasters",price:12,sprite:"blaster_upg_dmg1",value:2}]},ze={toolName:"Followers",upgrades:[{name:"Level 1",desc:"Purchase a follower for your social media account",sprite:"follower_upg1",price:22,value:1},{name:"Level 2",desc:"Your social media is blowing up",sprite:"follower_upg1",price:22,value:2},{name:"Level 3",desc:"Wow, you are popular!!",sprite:"follower_upg1",price:22,value:3},{name:"Level 4",desc:"Alright rockstar...",sprite:"follower_upg1",price:22,value:10}]},Ge={toolName:"Followers",requiredTool:"follower",upgrades:[{name:"Level 1",desc:"Increase your followers blaster damage",sprite:"follower_blaster_dmg_upg1",price:22,value:1},{name:"Level 2",desc:"Too... Many... Damage... Numbers...",sprite:"follower_blaster_dmg_upg1",price:22,value:2}]},Ke={toolName:"Followers",requiredTool:"follower",upgrades:[{name:"Level 1",desc:"Your followers will become quite dangerous (with missiles)",sprite:"follower_missiles_upg1",price:22,value:1}]},Je={toolName:"Missile barrage",upgrades:[{name:"Level 1",desc:"Install missile pods to the ship",sprite:"rocket_upg1",price:22,value:1}]},Ye={toolName:"Increase missiles",requiredTool:"rockets",upgrades:[{name:"Level 1",desc:"Increase missiles to 6",sprite:"more_missiles_upg1",price:22,value:6},{name:"Level 2",desc:"Increase missiles to 8",sprite:"more_missiles_upg1",price:22,value:8},{name:"Level 3",desc:"Increase missiles to 10",sprite:"more_missiles_upg1",price:22,value:10},{name:"Level 4",desc:"Increase missiles to 16, missiles will be taped outside the pod",sprite:"more_missiles_upg1",price:22,value:16}]},$e={toolName:"Missile shards",requiredTool:"rockets",upgrades:[{name:"Level 1",desc:"Missiles are loaded with space debree, shooting shards when exploded",sprite:"missile_shards_upg1",price:22,value:5},{name:"Level 2",desc:"Squeeze some more debree in those missiles!!",sprite:"missile_shards_upg1",price:22,value:7},{name:"Level 3",desc:"Squeeze some more debree in those missiles!!",sprite:"missile_shards_upg1",price:22,value:9}]},Qe={toolName:"Debree magnets",upgrades:[{name:"Level 1",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.2},{name:"Level 2",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.4},{name:"Level 3",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.6},{name:"Level 4",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.8},{name:"Level 5",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:2}]},Xe={toolName:"Stronger magnets",upgrades:[{name:"Level 1",desc:"Stronger magnets = faster debree, easy math",sprite:"debree_speed_upg1",price:32,value:1.2},{name:"Level 2",desc:"Stronger magnets = faster debree, easy math",sprite:"debree_speed_upg1",price:32,value:1.4},{name:"Level 3",desc:"Stronger magnets = faster debree, easy math",sprite:"debree_speed_upg1",price:32,value:2}]},Ze={toolName:"Thrusters overclock",upgrades:[{name:"Level 1",desc:"Hold SHIFT to overclock thrusters, increasing speed",sprite:"overclock_thrusters_upg1",price:32,value:1.2},{name:"Level 2",desc:"Increase speed when overclocking thrusters",sprite:"overclock_thrusters_upg1",price:32,value:1.4}]},et={toolName:"Thrusters cooling",requiredTool:"sprint",upgrades:[{name:"Level 1",desc:"Pouring unknown liquid on the thrusters seems to make them go faster during overclock??",sprite:"faster_speed_upg1",price:32,value:1.3},{name:"Level 2",desc:"Pour more liquid, the ship probably need some pumps soon...",sprite:"faster_speed_upg1",price:32,value:1.4}]},tt={toolName:"Improved thrusters",upgrades:[{name:"Level 1",desc:"Bigger thrusters, more speed",sprite:"faster_speed_upg1",price:32,value:1.05},{name:"Level 2",desc:"Bigger thrusters, more speed",sprite:"faster_speed_upg1",price:32,value:1.15}]},rt={toolName:"Shiny debree",requiredTool:"debreeDist",upgrades:[{name:"Level 1",desc:"Debree becomes more valueable, who could have thought",sprite:"debree_value_upg1",price:32,value:2},{name:"Level 2",desc:"Debree becomes almost as valuable as gold",sprite:"debree_value_upg1",price:32,value:3}]},st={toolName:"Stronger hull",upgrades:[{name:"Level 1",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:3},{name:"Level 2",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:4},{name:"Level 3",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:5},{name:"Level 4",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:6},{name:"Level 5",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:7},{name:"Level 6",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:8},{name:"Level 7",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:9},{name:"Level 8",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:10}]},Z={blaster:Ce,blasterParallel:Ne,blasterDmg:We,blasterSpeed:Re,rockets:Je,nrOfRockets:Ye,rocketShards:$e,debreeDist:Qe,debreeSpeed:Xe,debreeValue:rt,sprint:Ze,sprintSpeed:et,movespeed:tt,maxHealth:st,follower:ze,followerBlasterDmg:Ge,followerMissiles:Ke};let V={blaster:void 0,blasterDmg:void 0,blasterSpeed:void 0,rockets:void 0,debreeDist:void 0,debreeSpeed:void 0,nrOfRockets:void 0,sprint:void 0,movespeed:void 0,debreeValue:void 0,maxHealth:void 0,follower:void 0,followerBlasterDmg:void 0,followerMissiles:void 0,rocketShards:void 0,sprintSpeed:void 0,blasterParallel:void 0};function b(t){if(V[t]!==void 0)return Z[t].upgrades[V[t]].value}function ot(t){V[t]=Te(t),Ue("slot1")}function Te(t){return V[t]===void 0?0:V[t]+1}function at(t){V=t}async function it(t){await t.loadRoot("./"),await t.loadSprite("ship","sprites/ship.png"),await t.loadSprite("crate1","sprites/crate1.png"),await t.loadSprite("bullet1","sprites/bullet1.png"),await t.loadSprite("rocket1","sprites/rocket1.png"),await t.loadSprite("follower","sprites/follower.png"),await t.loadSprite("asteroid1","sprites/asteroid1.png"),await t.loadSprite("enemy_ship1","sprites/enemy_ship1.png"),await t.loadSprite("bike1","sprites/bike1.png"),await t.loadSprite("particle1","sprites/particle1.png"),await t.loadSprite("particle2","sprites/particle2.png"),await t.loadSprite("particle3","sprites/particle3.png"),await t.loadSprite("particle4","sprites/particle4.png"),await t.loadSprite("spark1","sprites/spark1.png"),await t.loadSprite("debree_part1","sprites/debree_part1.png"),await t.loadSprite("blaster1","sprites/upgrades/laser_cannon1.png"),await t.loadSprite("rocket_upg1","sprites/upgrades/rocket_upg1.png"),await t.loadSprite("blaster_upg_speed1","sprites/upgrades/blaster_upg_speed1.png"),await t.loadSprite("blaster_upg_dmg1","sprites/upgrades/blaster_upg_dmg1.png"),await t.loadSprite("debree_dist_upg1","sprites/upgrades/debree_dist_upg1.png"),await t.loadSprite("debree_speed_upg1","sprites/upgrades/debree_speed_upg1.png"),await t.loadSprite("debree_value_upg1","sprites/upgrades/debree_value_upg1.png"),await t.loadSprite("faster_speed_upg1","sprites/upgrades/faster_speed_upg1.png"),await t.loadSprite("hull_upg1","sprites/upgrades/hull_upg1.png"),await t.loadSprite("missile_shards_upg1","sprites/upgrades/missiles_shards_upg1.png"),await t.loadSprite("more_missiles_upg1","sprites/upgrades/more_missiles_upg1.png"),await t.loadSprite("overclock_thrusters_upg1","sprites/upgrades/overclock_thrusters_upg1.png"),await t.loadSprite("parallel_blasters_upg1","sprites/upgrades/parallel_blasters_upg1.png"),await t.loadSprite("follower_upg1","sprites/upgrades/follower_upg1.png"),await t.loadSprite("follower_missiles_upg1","sprites/upgrades/follower_missiles_upg1.png"),await t.loadSprite("follower_blaster_dmg_upg1","sprites/upgrades/follower_blaster_dmg_upg1.png"),await t.loadSprite("bg_moon1","sprites/bg/moon1.png"),await t.loadSprite("bg_building1","sprites/bg/building1.png"),await t.loadBitmapFont("unscii","/fonts/unscii_8x8.png",8,8),await t.loadSound("shoot1","sounds/shoot1.wav"),await t.loadSound("fire_rocket1","sounds/rocket_fire1.wav"),await t.loadSound("explosion1","sounds/explosion1.wav"),await t.loadSound("explosion2","sounds/explosion2.wav"),await t.loadSound("explosion3","sounds/explosion3.wav"),await t.loadSound("explosion4","sounds/explosion4.wav"),await t.loadSound("hit1","sounds/hit1.wav"),await t.loadSound("hit2","sounds/hit2.wav"),await t.loadSound("player_hit1","sounds/player_hit1.wav"),await t.loadSound("collect1","sounds/collect1.wav"),await t.loadSound("click1","sounds/click.wav"),await t.loadSound("purchase","sounds/purchase.wav"),await t.loadSound("error","sounds/error.wav"),await t.loadSound("purchase1","sounds/purchase1.wav"),await t.loadMusic("arcadia","songs/arcadia.mp3"),await t.loadSprite("enemy_ship1_left_wing","sprites/ships/enemy1/enemy_ship1_left_wing.png"),await t.loadSprite("enemy_ship1_right_wing","sprites/ships/enemy1/enemy_ship1_right_wing.png"),await t.loadSprite("enemy_ship1_body","sprites/ships/enemy1/enemy_ship1_body.png")}const De=["explosion1","explosion2","explosion3"];function B(){const t=Math.floor(Math.random()*De.length);return De[t]}function lt(t,r){return t+nt(t,r)}function nt(t,r){let o=(r-t)%360;return o>180&&(o-=360),o<-180&&(o+=360),o}function Ue(t){const r={loadout:V,score:N,time:we};localStorage.setItem(t,JSON.stringify(r))}function dt(t){var r=localStorage.getItem(t);return r?JSON.parse(r):null}const d={maxHealth:2,scorePerPickup:1,blasterDmg:2,blasterDmgMultiplier:1,blasterLvl:void 0,blasterParallel:void 0,rocketsLvl:void 0,nrOfRockets:3,rocketShards:0,blasterSpeedMultiplier:1,debreePickupDistance:10,debreeSeekDistance:50,debreeSeekSpeed:80,debreeSeekDistanceMultiplier:1,debreeSeekSpeedMultiplier:1,debreeValueMultiplier:1,rocketImpactDmg:10,rocketSplashDmg:5,rocketDmgMultiplier:1,rocketSplashSize:30,rocketSplashSizeMultiplier:1,rocketSplashDmgFallOverDistance:.7,rocketSplashDmgFallDistanceValue:.6,speed:100,canSprint:void 0,sprintSpeedMultiplier:1,speedMultiplier:1,speedPwrUpMultiplier:1,nrOfFollowers:0,followerBlasterDmg:1,followerBlasterDmgMultiplier:1,followerCanUseMissiles:void 0};function Me(){d.blasterLvl=b("blaster"),d.blasterParallel=b("blasterParallel"),d.blasterDmgMultiplier=b("blasterDmg")??1,d.blasterSpeedMultiplier=b("blasterSpeed")??1,d.rocketsLvl=b("rockets"),d.nrOfRockets=b("nrOfRockets")??3,d.rocketShards=b("rocketShards")??0,d.debreeSeekDistanceMultiplier=b("debreeDist")??1,d.debreeSeekSpeedMultiplier=b("debreeSpeed")??1,d.debreeValueMultiplier=b("debreeValue")??1,d.canSprint=b("sprint"),d.sprintSpeedMultiplier=b("sprintSpeed")??1,d.speedMultiplier=b("movespeed")??1,d.maxHealth=b("maxHealth")??2,d.nrOfFollowers=b("follower")??0,d.followerBlasterDmg=b("followerBlasterDmg")??1,d.followerCanUseMissiles=b("followerMissiles")}function ce(t,r){return t===void 0?!1:t>=r}let U,_,oe,fe,ae;function pt(){U=e.add([e.pos(),e.particles({max:2e3,speed:[2,30],lifeTime:[.2,.6],colors:[e.WHITE],opacities:[.8,.6],angle:[0,360],damping:[2,2],scales:[.4,.2,.1],texture:e.getSprite("particle3").data.tex,quads:[e.getSprite("particle3").data.frames[0]]},{rate:1,direction:0,spread:90,position:e.vec2(0,0)}),"trail"]),_=e.add([e.pos(),e.particles({max:1e3,speed:[10,40],angle:[0,360],lifeTime:[1,1.5],colors:[e.rgb(255,255,255)],opacities:[1,.5],scales:[1.4,1,.4,.1],damping:[0,.5],angularVelocity:[-90,90],texture:e.getSprite("particle1").data.tex,quads:[e.getSprite("particle1").data.frames[0]]},{rate:0,direction:-90,spread:360,position:e.vec2()})]),oe=e.add([e.pos(),e.particles({max:1e3,speed:[200,300],angle:[0,360],lifeTime:[1,1.5],colors:[e.rgb(255,255,255)],opacities:[1,.5],scales:[1.4,1,.4,.1],damping:[0,.5],angularVelocity:[-90,90],texture:e.getSprite("particle1").data.tex,quads:[e.getSprite("particle1").data.frames[0]]},{rate:0,direction:-90,spread:40,position:e.vec2()})]),e.add([e.pos(),e.particles({max:1e3,speed:[100,150],lifeTime:[1,1.5],angle:[0,360],colors:[e.rgb(255,255,255)],opacities:[1,.5],damping:[0,.5],texture:e.getSprite("particle4").data.tex,quads:[e.getSprite("particle4").data.frames[0]]},{rate:0,direction:-90,spread:40,position:e.vec2()})]),e.add([e.pos(),e.particles({max:1e3,speed:[10,40],lifeTime:[1,1.5],colors:[e.rgb(255,255,255)],opacities:[1,.5],scales:[1,.4,.1],acceleration:[e.vec2(0,1),e.vec2(0,2)],angularVelocity:[-90,90],texture:e.getSprite("particle1").data.tex,quads:[e.getSprite("particle1").data.frames[0]]},{rate:0,direction:-90,spread:0,position:e.vec2()})]),e.add([e.pos(),e.particles({max:1e3,speed:[5,40],angle:[0,360],lifeTime:[1,2],colors:[e.rgb(255,255,255)],opacities:[.7,.4],angularVelocity:[-90,90],scales:[1,.8,0],texture:e.getSprite("debree_part1").data.tex,quads:[e.getSprite("debree_part1").data.frames[0]]},{rate:0,direction:-90,spread:360,position:e.vec2()})]),ae=e.add([e.pos(),e.particles({max:1e3,speed:[60,80],angle:[0,360],lifeTime:[1,2],colors:[e.rgb(255,255,255)],angularVelocity:[-90,90],scales:[1,.8,.2,0],texture:e.getSprite("debree_part1").data.tex,quads:[e.getSprite("debree_part1").data.frames[0]]},{rate:0,direction:-90,spread:55,position:e.vec2()})]),fe=e.add([e.pos(),e.particles({max:1e3,speed:[30,80],angle:[0,360],lifeTime:[.5,1.2],colors:[e.rgb(255,255,255)],opacities:[.8,.5],scales:[.4,2,1.2,.4,.1],damping:[1,2],texture:e.getSprite("particle3").data.tex,quads:[e.getSprite("particle3").data.frames[0]]},{rate:0,direction:-90,spread:360,position:e.vec2()})])}let y=null,q=-1,L=-1,H=0;function ct(t){y=t,q=0,L=-1}function ut(){if(!y)return!1;if(H+=e.dt()*1e3,y.levelLengthSeconds<H/1e3)return!0;if(q<y.waves.length&&y.waves[q].timeStamp<H&&L!=q&&(L=q,q++,y.waves[L].begin&&y.waves[L].begin(H)),L>0&&L<y.waves.length){const t=(y.waves[L].duration??0)+y.waves[L].timeStamp;if(H<t)return y.waves[L].upd(H-y.waves[L].timeStamp),y.lvlUpd(),!1}return!1}function xe(){return y!=null}function Ae(){y&&(gt(y),y=null,H=0)}function gt(t){q=-1,L=-1,t.reset()}const l={friendly:"friendly",enemy:"enemy",gameLoopUi:"game_loop_ui",blaster:"blaster",rocket:"rocket",debree:"debree",unit:"unit",part:"part",levelBg:"level_bg"};let Q=[],Se=null;const mt=10,K=80;function ht(t){for(let r=0;r<t;r++){const o=mt*(r+1),s=e.add([e.pos(10,e.height()-o),e.rect(10,6),e.color(e.WHITE),e.opacity(1),l.gameLoopUi]);Q.push(s)}e.add([e.pos(22,e.height()-4-K),e.rect(4,K),e.color(e.WHITE),e.opacity(.2),l.gameLoopUi]),Se=e.add([e.pos(22,e.height()-4-K),e.rect(4,K),e.color(e.WHITE),l.gameLoopUi])}function ft(t){const r=e.clamp(t,0,Q.length-1);for(let o=Q.length-1;o>r;o--)Q[o].opacity=.2}function vt(t,r){Se.height=K*(t/r)}function bt(){e.destroyAll(l.gameLoopUi),Q=[],Se=null}function W(t,r,o,s,a,i,p){const n=e.add([e.pos(t),e.move(r,zt*a),e.area(),e.rotate(o),e.offscreen({destroy:!0}),e.anchor("center"),e.sprite("bullet1"),{dmg:s},...i]);n.onDestroy(()=>{const h=A.findIndex(v=>v.id==n.id);A.splice(h,1)}),p&&e.play("shoot1",{volume:m}),A.push(n)}function z(t){t.animate("opacity",[0,1,0,1],{duration:.14,loops:1})}function ne(t,r,o,s,a){const i=r.sub(o).unit(),p=Math.atan2(i.y,i.x),n=e.rad2deg(p)+a,h=lt(t,n);return{dir:i,lerp:e.lerp(t,h,s)}}function de(t,r,o){const s=e.deg2rad(r+90),a=Math.cos(s),i=Math.sin(s);t.move(a*o*-1,i*o*-1),t.angle=r,t.scale=e.vec2(1,Math.abs(i))}const yt=.5,Le=12,St=400;function Be(t,r,o,s,a,i,p,n,h,v,D){const c=e.add([e.pos(t),e.area(),e.rotate(o),e.offscreen({destroy:!0}),e.anchor("center"),e.scale(1),e.sprite("rocket1"),{impactDmg:s,splashDmg:a,splashSize:i,splashDmgFallof:p,splashDmgFallofDist:n,lifetime:0,speedMltp:h,dir:r,targetUnit:null,canSeek:D},...v]);e.play("fire_rocket1",{volume:m}),c.onUpdate(()=>{c.lifetime+=e.dt();const f=e.clamp(Gt*c.speedMltp*(.3+c.lifetime),0,St),S=e.Vec2.fromAngle(c.angle-90);if(c.targetUnit){const{lerp:I}=ne(c.angle,c.pos,c.targetUnit.pos,.04,-90);de(c,I,f)}else c.move(S.x*f,S.y*f);const k=e.vec2(c.pos.x-Le*S.x,c.pos.y-Le*S.y);U.emitter.position=k,U.emitter.direction=c.angle,U.emit(1),c.canSeek&&c.lifetime>yt&&c.targetUnit==null&&Oe(c.pos,200,"enemy",I=>{var pe;c.targetUnit=I,(pe=c.targetUnit)==null||pe.onDestroy(()=>{c.targetUnit=null})})}),c.onDestroy(()=>{const f=A.findIndex(k=>k.id==c.id);A.splice(f,1);const S=d.rocketShards;for(let k=0;k<S;k++){const I=360*(k/S);W(c.pos,e.Vec2.fromAngle(I),I+90,1,1,[l.friendly,l.blaster],!1)}}),A.push(c)}let F=0,ve=1,G=0;const ue=6;function wt(){const t=e.add([e.pos(e.center()),e.sprite("ship"),e.rotate(0),e.scale(),e.health(d.maxHealth),e.area(),e.anchor("center"),e.animate(),l.friendly]);return z(t),ce(d.blasterLvl,1)?(t.add([e.anchor("center"),e.pos(10,0)]),F++,t.add([e.anchor("center"),e.pos(-10,0)]),F++):(t.add([e.anchor("center"),e.pos(0,-6)]),F++),ce(d.blasterLvl,2)&&(t.add([e.anchor("center"),e.pos(0,-6)]),F++),t.onDeath(()=>{e.destroy(t),_.emitter.position=t.pos,_.emit(20),e.play("explosion1",{volume:m}),Vt()}),t.onUpdate(()=>{G<ue&&(G+=e.dt(),vt(G,ue)),re(t.pos,12,l.enemy,h=>{e.destroy(h),h.tags.includes(l.blaster)?t.hurt(h.dmg):h.tags.includes(l.rocket)&&(t.hurt(h.impactDmg),te(h.pos,h.splashSize,h.splashDmg,h.splashDmgFallof,h.splashDmgFallofDist),e.play(B(),{volume:m}),e.shake(3))});const r=t.pos.dist(e.mousePos())-12,{dir:o,lerp:s}=ne(t.angle,t.pos,e.mousePos(),.05,-90),a=d.speed*d.speedMultiplier*d.speedPwrUpMultiplier,i=e.clamp(r*4,0,a);t.angle=s;const p=e.Vec2.fromAngle(t.angle+90),n=e.vec2(t.pos.x+12*p.x,t.pos.y+12*p.y);i>4&&(U.emitter.position=n,U.emitter.direction=e.Vec2.toAngle(o),U.emit(1)),de(t,s,i)}),t.onHurt(()=>{e.play("hit2",{volume:m}),t.animation.seek(0),e.shake(20),e.flash(e.RED,.4),ft(t.hp())}),t.onMousePress("left",()=>{if(ce(d.blasterParallel,1)){for(let o=0;o<F;o++){const s=t.children[o];W(s.worldPos(),e.Vec2.fromAngle(t.angle-90),t.angle,d.blasterDmg*d.blasterDmgMultiplier,d.blasterSpeedMultiplier,[l.friendly,l.blaster],!0)}return}const r=t.children[ve%F];W(r.worldPos(),e.Vec2.fromAngle(t.angle-90),t.angle,d.blasterDmg*d.blasterDmgMultiplier,d.blasterSpeedMultiplier,[l.friendly,l.blaster],!0),ve++}),t.onMousePress("right",()=>{d.rocketsLvl!==void 0&&(G<ue||(G=0,e.loop(.1,()=>{Be(t.pos,e.Vec2.fromAngle(t.angle-90),t.angle,d.rocketImpactDmg*d.rocketDmgMultiplier,d.rocketSplashDmg*d.rocketDmgMultiplier,d.rocketSplashSize*d.rocketSplashSizeMultiplier,d.rocketSplashDmgFallDistanceValue,d.rocketSplashDmgFallOverDistance,1,[l.friendly,l.rocket],!0)},d.nrOfRockets)))}),t.onKeyDown("shift",()=>{d.canSprint!==void 0&&(d.speedPwrUpMultiplier=1.8*d.sprintSpeedMultiplier)}),t.onKeyRelease("shift",()=>{d.speedPwrUpMultiplier=1}),t}function _t(){ve=0,F=0}function ee(t,r){for(let o=0;o<r;o++){const s=e.add([e.pos(t),e.sprite("particle2"),e.animate({relative:!0}),e.rotate(e.rand(360)),e.opacity(1),{dir:e.rand(e.vec2(-1,-1),e.vec2(1,1)),speed:e.rand(40,60),lifeSpan:0},l.debree]);s.onUpdate(()=>{s.lifeSpan>s.speed||(s.move(s.dir.x*(s.speed-s.lifeSpan),s.dir.y*(s.speed-s.lifeSpan)),s.lifeSpan+=e.dt()*45)}),s.animate("opacity",[1,.5],{duration:1}),X.push(s)}}function ge(t,r,o,s){const a=12*s,i=e.add([e.pos(t),e.sprite("enemy_ship1"),e.rotate(0),e.anchor("center"),e.health(o),e.animate(),e.scale(s),e.offscreen({destroy:!0}),{speed:e.rand(100,130),hb:a,targetPos:e.rand(e.vec2(e.width(),e.height()))},e.state("retreat",["attack","retreat"]),l.enemy,l.unit]);i.onStateEnter("retreat",async()=>{const p=e.rand(e.vec2(e.width(),e.height()));i.targetPos=p,await e.wait(1),i.enterState("attack")}),i.onStateEnter("attack",async()=>{await e.wait(3),i.enterState("retreat")}),i.onStateUpdate("attack",()=>{const p=M.pos;i.targetPos=p;const n=i.pos.dist(i.targetPos);n<50?i.enterState("retreat"):n>50&&n<200&&Math.floor(e.rand(0,200))==1&&W(i.pos,e.Vec2.fromAngle(i.angle-90),i.angle,2,1,[l.enemy,l.blaster],!0)}),z(i),i.onUpdate(()=>{const{lerp:p}=ne(i.angle,i.pos,i.targetPos,.01,-90);de(i,p,i.speed),re(i.pos,i.hb,l.friendly,n=>{e.destroy(n),n.tags.includes(l.blaster)?i.hurt(n.dmg):n.tags.includes(l.rocket)&&(i.hurt(n.impactDmg),te(n.pos,n.splashSize,n.splashDmg,n.splashDmgFallof,n.splashDmgFallofDist),e.play(B(),{volume:m}),e.shake(3))})}),i.onDeath(()=>{_.emitter.position=i.pos,_.emit(20),ee(i.pos,r),e.play(B(),{volume:m}),e.destroy(i)}),i.onHurt(()=>{e.play("hit1",{volume:m}),i.animation.seek(0)})}function J(t){const r=e.rand(1,2),o=12*r,s=e.add([e.pos(t.pos),e.sprite("asteroid1"),e.rotate(0),e.anchor("center"),e.scale(e.rand(1,2)),e.health(t.hp),e.animate(),e.offscreen({destroy:!0}),{vel:t.dir,rotVel:e.rand(-4,4),speed:t.speed,initScale:r,hb:o},l.enemy,l.unit]);z(s),s.onUpdate(()=>{s.move(s.vel.scale(s.speed)),s.angle+=s.rotVel,re(s.pos,s.hb,l.friendly,a=>{e.destroy(a),a.tags.includes(l.blaster)?(s.hurt(a.dmg),ee(s.pos,1)):a.tags.includes(l.rocket)&&(s.hurt(a.impactDmg),te(a.pos,a.splashSize,a.splashDmg,a.splashDmgFallof,a.splashDmgFallofDist),e.play(B(),{volume:m}),e.shake(3),ae.emitter.position=s.pos,ae.emitter.direction=a.angle-90,ae.emit(6))}),M.pos.dist(s.pos)<s.hb&&(M.hurt(1),s.hurt(t.hp))}),s.onDeath(()=>{if(_.emitter.position=s.pos,_.emit(20),ee(s.pos,t.scoreOnKill),e.play(B(),{volume:m}),e.destroy(s),t.splitOnDeath)for(let a=0;a<t.splitOnDeath;a++)J({pos:s.pos,dir:e.rand(e.vec2(-1,-1),e.vec2(1,1)),scoreOnKill:t.scoreOnKill/2,hp:t.hp/2,speed:t.speed*2,splitOnDeath:0})}),s.onHurt(()=>{e.play("hit1",{volume:m}),s.animation.seek(0)})}function Dt(t,r,o,s,a){const p=e.add([e.pos(r),e.sprite(a),e.rotate(o.angle()-90),e.anchor("center"),e.health(s),e.animate(),e.offscreen({destroy:!0}),{vel:o,speed:e.rand(300,340),hb:12},l.enemy,l.unit]);z(p),p.onUpdate(()=>{p.move(p.vel.scale(p.speed)),re(p.pos,p.hb,l.friendly,n=>{e.destroy(n),n.tags.includes(l.blaster)?(p.hurt(n.dmg),ee(p.pos,1)):n.tags.includes(l.rocket)&&(p.hurt(n.impactDmg),te(n.pos,n.splashSize,n.splashDmg,n.splashDmgFallof,n.splashDmgFallofDist),e.play(B(),{volume:m}),e.shake(3))}),M.pos.dist(p.pos)<p.hb&&(M.hurt(1),p.hurt(s))}),p.onDeath(()=>{oe.emitter.position=p.pos,oe.emitter.direction=p.angle+90,oe.emit(20),e.play(B(),{volume:m}),e.destroy(p),t.killed+=1}),p.onHurt(()=>{e.play("hit1",{volume:m}),p.animation.seek(0)})}function xt(t,r,o){const s=e.add([e.animate(),{startPos:t,endPos:r,opacity:.15,killed:0},l.enemy]);s.onUpdate(()=>{if(Math.floor(e.rand(0,100-o))==1){const a=kt(6);Dt(s,s.startPos.add(a),s.endPos.add(a).sub(s.startPos).unit(),4,Lt())}s.opacity=e.wave(.1,.2,e.time()),s.killed>=5&&s.destroy()}),s.onDraw(()=>{e.drawLines({pts:[s.startPos,s.endPos],width:40,opacity:s.opacity})})}const ke=["enemy_ship1","bike1"];function Lt(){return ke[Math.floor(e.rand(0,ke.length))]}function kt(t){return e.rand(e.vec2(-6,-6),e.vec2(t,t))}function Pt(t){const r=[],o=t.parts.find(s=>s.isBody);for(let s=0;s<t.parts.length;s++){const a=t.parts[s];z(a.obj),a.obj.onHurt(()=>{e.play("hit1",{volume:m}),t.parts[s].obj.animation.seek(0)}),a.obj.onDeath(()=>{const i=a.isBody?a.obj.pos:o.obj.pos.sub(a.obj.pos);if(_.emitter.position=i,_.emit(20),ee(i,a.scoreOnDestroy),e.play(B(),{volume:m}),a.isBody){delete Y[a.obj.id],e.destroy(a.obj);return}a.obj.hidden=!0,a.obj.paused=!0,Tt(i,a.obj.sprite,e.rand(40,80)),o.obj.jitter(20)}),r.push({obj:a.obj,localPos:a.isBody?e.vec2(0,0):a.obj.pos,hitbox:a.hitbox,isBody:a.isBody})}return r}function Tt(t,r,o){const s=e.add([e.pos(t),e.sprite(r),e.lifespan(2,{fade:.2}),e.offscreen({destroy:!0}),e.opacity(1),e.scale(1),e.rotate(e.rand(0,360)),e.move(e.rand(e.vec2(-1,-1),e.vec2(1,1)),o),{spin:e.rand(2,8)}]);s.onUpdate(()=>{const a=e.wave(-1,1,e.time()*s.spin);s.scale=e.vec2(a,a)})}function me(){return{jitterValue:0,id:"jitter",require:["pos"],update(){if(this.jitterValue>0){const r=this.jitterValue*8;var t=e.rand(e.vec2(-r,-r),e.vec2(r,r));this.move(t),this.jitterValue-=e.dt()*100}},jitter(t){this.jitterValue=t}}}const Ut=[6,2],Y={};function he(t,r,o,s,a,i){const p=16*a,n=e.add([e.pos(t),e.sprite("enemy_ship1_body"),e.rotate(r.angle()+90),e.anchor("center"),e.health(s),e.animate(),e.scale(a),me(),e.offscreen({destroy:!0}),{vel:r,speed:i,hb:p},l.enemy,l.unit]),h=n.add([e.pos(e.vec2(-6,-2)),e.sprite("enemy_ship1_left_wing"),e.anchor("center"),e.health(Math.floor(s/2)),e.animate(),me(),l.part]),v=n.add([e.pos(e.vec2(Ut[0],-2)),e.sprite("enemy_ship1_right_wing"),e.anchor("center"),e.health(Math.floor(s/2)),e.animate(),me(),l.part]);Y[n.id]=Pt({parts:[{obj:n,hitbox:8,isBody:!0,scoreOnDestroy:o},{obj:h,hitbox:8,isBody:!1,scoreOnDestroy:2},{obj:v,hitbox:8,isBody:!1,scoreOnDestroy:2}]}),n.onUpdate(()=>{n.move(n.vel.scale(n.speed)),Ht(n.pos,n.hb,l.friendly,Y[n.id],(f,S)=>{e.destroy(f),f.tags.includes(l.blaster)?Y[n.id][S].obj.hurt(f.dmg):f.tags.includes(l.rocket)&&(Y[n.id][S].obj.hurt(f.impactDmg),te(f.pos,f.splashSize,f.splashDmg,f.splashDmgFallof,f.splashDmgFallofDist),e.play(B(),{volume:m}),e.shake(3))}),Math.floor(e.rand(0,500))==10&&W(n.pos,e.Vec2.fromAngle(n.angle-90),n.angle,2,1,[l.enemy,l.blaster],!0);const D=e.Vec2.fromAngle(n.angle-90),c=e.vec2(n.pos.x-12*D.x,n.pos.y-12*D.y);U.emitter.position=c,U.emitter.direction=e.Vec2.toAngle(D),U.emit(1)})}function Mt(t,r,o){const s=document.getElementById("song"),a=document.getElementById("song_title"),i=document.getElementById("song_author"),p=document.getElementById("song_cover");i.textContent=r,a.textContent=t,p.setAttribute("src",o),s==null||s.classList.add("show")}function At(){const t=document.getElementById("song");t==null||t.classList.remove("show")}let P={},g=0,x=0,O=0,Pe;const T={music:"arcadia",songTitle:"Arcadia",songAuthor:"Dunderpatrullen",songAlbumCover:"/covers/arcadia_cover.jpg",bpm:.44,title:"",introduceSound:"",levelLengthSeconds:190,reset:()=>{P={},Pe.stop(),At()},lvlUpd:()=>{},waves:[{timeStamp:0,begin:()=>{Pe=e.play(T.music,{volume:Kt})},upd:()=>{}},{timeStamp:3500,begin:()=>{Mt(T.songTitle,T.songAuthor,T.songAlbumCover)},upd:()=>{}},{timeStamp:4500,begin:t=>{var r=e.add([e.pos(e.center()),e.anchor("center"),e.animate(),e.text("...INIT SPACEJUMP...",{font:"",size:42}),l.gameLoopUi]);r.animate("opacity",[1,0],{loops:5,duration:.7}),P.txt=r},upd:()=>{}},{timeStamp:4550,duration:3550,begin:()=>{P.lines=[]},upd:t=>{var r=e.rand(e.vec2(e.width(),e.height())),o=e.add([e.pos(r),e.rect(2,4*(t/100)),e.color(e.WHITE),"dust"]);P.lines.push(o);for(let s=0;s<P.lines.length;s++)P.lines[s].move(0,-10*(t/50));t>2e3&&e.shake(.01*(t/100))}},{timeStamp:8120,begin:()=>{e.destroyAll("dust"),e.flash(e.WHITE,1),e.destroy(P.txt),delete P.lines;const t=40;for(let o=0;o<t;o++){var r=e.rand(e.vec2(e.width(),e.height()));M.pos.dist(r)<200||J({pos:r,dir:e.DOWN,scoreOnKill:1,hp:3,speed:e.rand(20,40),splitOnDeath:2})}e.add([e.pos(100),e.color(e.rgb(50,50,50)),e.sprite("bg_moon1"),e.scale(2),e.layer(R.bg),l.levelBg]),e.add([e.pos(100,400),e.color(e.rgb(50,50,50)),e.sprite("bg_building1"),e.scale(2),e.layer(R.bg),l.levelBg])},upd:t=>{}},{timeStamp:16e3,begin:()=>{var t=e.add([e.pos(e.center()),e.anchor("center"),e.animate(),e.text("!!THREAT DETECTED!!",{font:"",size:42}),l.gameLoopUi]);t.animate("opacity",[1,0],{loops:10,duration:T.bpm}),P.txt=t},upd:t=>{}},{timeStamp:21e3,begin:()=>{e.destroy(P.txt);const t=6;for(let r=0;r<t;r++){const o=E(.25*(r/t));he(o,e.DOWN,3,5,1,e.rand(40,60))}},upd:t=>{}},{timeStamp:18790,begin:()=>{e.flash(e.WHITE,T.bpm);const t=12;for(let r=0;r<t;r++){const o=E(1*(r/t));he(o,e.Vec2.fromAngle(o.angleBetween(e.center())),3,5,1,e.rand(40,60))}},upd:t=>{}},{timeStamp:22790,begin:()=>{e.flash(e.WHITE,T.bpm);const t=12;for(let r=0;r<t;r++){const o=E(1*(r/t));he(o,e.Vec2.fromAngle(o.angleBetween(e.center())),3,5,1,e.rand(40,60))}},upd:t=>{}},{timeStamp:36744,duration:1e3,begin:()=>{e.shake(10)},upd:t=>{if(g+=e.dt(),g>=.05){const r=e.rand(1);ge(E(r),2,2,1),g=0}}},{timeStamp:43824,duration:1500,begin:()=>{g=0,x=0,O=30},upd:t=>{if(g+=e.dt(),g>=.03&&x<O){const r=.25+.25*(x/O);J({pos:E(r),dir:e.LEFT,scoreOnKill:1,hp:3,speed:40,splitOnDeath:2}),x++,g=0}}},{timeStamp:45600,duration:1500,begin:()=>{g=0,x=0,O=30},upd:t=>{if(g+=e.dt(),g>=.03&&x<O){const r=.75+.25*(x/O);J({pos:E(r),dir:e.RIGHT,scoreOnKill:1,hp:3,speed:40,splitOnDeath:2}),x++,g=0}}},{timeStamp:47e3,duration:5e3,begin:()=>{g=0,x=0,O=30},upd:t=>{if(g+=e.dt(),g>=.03&&x<O){for(let r=0;r<2;r++){const o=.5*r+.25*(x/O);J({pos:E(o),dir:r==0?e.DOWN:e.UP,scoreOnKill:1,hp:3,speed:40,splitOnDeath:2})}x++,g=0}}},{timeStamp:66e3,duration:14e3,begin:()=>{g=0},upd:t=>{if(g+=e.dt(),g>=T.bpm*2){const r=e.rand(1);ge(E(r),2,2,1),g=0}}},{timeStamp:79300,begin:()=>{g=0;for(let t=0;t<2;t++){const r=200+300*t;xt(e.vec2(0,r),e.vec2(e.width(),r),10)}},upd:t=>{if(g+=e.dt(),g>=T.bpm){const r=e.rand(1);ge(E(r),2,2,1),g=0}}}]};function Bt(){return{lockedTarget:null,id:"target",require:["pos"],pickTarget(t,r,o){return this.lockedTarget?!0:Oe(t,r,o,s=>{this.lockedTarget=s,this.lockedTarget.onDestroy(()=>{this.lockedTarget=null})})},hasTarget(){return this.lockedTarget},targetAngle(){return this.lockedTarget?this.lockedTarget.pos.angle(this.pos):this.angle}}}function Ot(t){const o=e.add([e.pos(t.pos),e.sprite("follower"),e.rotate(0),e.anchor("center"),e.scale(.4),e.health(t.hp),Bt(),e.animate(),e.offscreen({destroy:!0}),{speed:t.speed,hb:12,dmg:t.blasterDmg,missiles:t.canUseMissiles},l.friendly,l.unit]);z(o),o.onUpdate(()=>{const{lerp:s}=ne(o.angle,o.pos,t.follow.pos,.015,-90);de(o,s,o.speed),re(o.pos,o.hb,l.enemy,a=>{e.destroy(a),a.tags.includes(l.blaster)&&o.hurt(a.dmg)}),o.missiles&&o.hasTarget()&&Math.floor(e.rand(0,300))==1&&Be(o.pos,e.Vec2.fromAngle(o.angle-90),o.angle,d.rocketImpactDmg*d.rocketDmgMultiplier,d.rocketSplashDmg*d.rocketDmgMultiplier,d.rocketSplashSize*d.rocketSplashSizeMultiplier,d.rocketSplashDmgFallDistanceValue,d.rocketSplashDmgFallOverDistance,.8,[l.friendly,l.rocket],!0),Math.floor(e.rand(0,110))==1&&o.pickTarget(o.pos,400,l.enemy)&&W(o.pos,e.Vec2.fromAngle(o.targetAngle()),o.targetAngle()+90,o.dmg,2,[l.friendly,l.blaster],!0)}),o.onDeath(()=>{_.emitter.position=o.pos,_.emit(20),e.play(B(),{volume:m}),e.destroy(o)}),o.onHurt(()=>{e.play("hit1",{volume:m}),o.animation.seek(0)})}const Et=1;let M,ie=0,X=[];const A=[];function It(){M=wt(),ht(d.maxHealth)}function jt(){const t=e.dt();if(ie+=t,ie>=Et&&!xe()){ct(T);for(let r=0;r<d.nrOfFollowers;r++)Ot({follow:M,hp:6,pos:e.vec2(e.rand(e.width()),0),speed:e.rand(80,110),blasterDmg:d.followerBlasterDmg*d.followerBlasterDmgMultiplier,canUseMissiles:d.followerCanUseMissiles!==void 0})}xe()&&ut()&&(ie=0,Ae());for(let r=0;r<X.length;r++){const o=X[r],s=o.pos.dist(M.pos);s<d.debreeSeekDistance*d.debreeSeekDistanceMultiplier&&(o.moveTo(M.pos,d.debreeSeekSpeed*d.debreeSeekSpeedMultiplier),s<d.debreePickupDistance&&(e.destroy(o),X.splice(r,1),e.play("collect1",{volume:m}),Fe(d.scorePerPickup),r--))}}function Vt(){_t(),ie=0,X=[],Ae(),e.destroyAll(l.enemy),e.destroyAll(l.blaster),e.destroyAll(l.rocket),e.destroyAll(l.enemy),e.destroyAll(l.levelBg),e.destroyAll(l.unit),e.destroyAll(l.debree),bt(),_e(C.LevelUp)}function te(t,r,o,s,a){const i=e.query({include:[l.enemy,l.unit],includeOp:"and"});fe.emitter.position=t,fe.emit(14);for(let p=0;p<i.length;p++)i[p].pos.dist(t)<r&&i[p].hurt(o)}function re(t,r,o,s){for(let a=0;a<A.length;a++){const i=A[a];if(i.pos.dist(t)<r){if(!i.tags.includes(o))continue;s(i)}}}function Ht(t,r,o,s,a){for(let i=0;i<A.length;i++){const p=A[i];if(p.pos.dist(t)<r){if(!p.tags.includes(o))continue;for(let n=0;n<s.length;n++)if(!s[n].obj.hidden&&p.pos.dist(t.sub(s[n].localPos))<s[n].hitbox){a(p,n);return}}}}function Oe(t,r,o,s){const a=e.query({include:[o,l.unit],includeOp:"and"});for(let i=0;i<a.length;i++){const p=a[i];if(p.pos.dist(t)<r)return s(p),!0}return!1}const $="ui_grid";let j,u={group:void 0,title:void 0,header:void 0,desc:void 0,icon:void 0},be={},Ee,Ie;function Ft(){const t=e.center(),r=ye(e.vec2(t.x,40),"ui");r.add([e.text("UPGRADE",{size:22,font:"unscii"}),e.anchor("center")]),Ee=Wt(r,12,He(N),e.vec2(0,50)),je(t),u.group=ye(e.vec2(t.x+t.x/2-100,t.y-t.y/2-40),"ui"),u.group.hidden=!0,Nt(),Rt("START GAME",e.vec2(t.x,t.y*2-60),()=>{qt(),_e(C.Playing)})}function qt(){e.destroyAll("ui"),e.destroyAll($)}function je(t){e.destroyAll($);const r=ye(e.vec2(60,t.y),$);var o=Z,s=Object.entries(o).filter(([v,D])=>D.requiredTool?V[D.requiredTool]!==void 0:!0).map(([v,D])=>v);const a=4;let i=-1;const p=42,n=8,h=16;for(let v=0;v<s.length;v++){const D=Z[s[v]],c=Te(s[v]);v%a==0&&i++;const f=v-a*i,S=r.add([e.pos(e.vec2((p+n)*f,(p+n)*i)),e.rect(p,p),e.area(),e.color(0,0,0),e.anchor("center"),e.outline(1,new e.Color(255,255,255)),$]),k=S.add([e.rect(p+6,p+6),e.pos(0,0),e.color(0,0,0),e.anchor("center"),e.outline(2,new e.Color(255,255,255)),$]);k.hidden=!0,be[s[v]]=k,c>0&&S.add([e.pos(h,-21),e.rect(h,h),e.anchor("center"),e.color(255,255,255)]).add([e.text(`${c}`,{size:14,font:"unscii"}),e.pos(0,2),e.anchor("center"),e.color(0,0,0)]);const I=e.clamp(c,0,D.upgrades.length-1);S.add([e.sprite(D.upgrades[I].sprite,{height:24,width:24}),e.anchor("center")]),S.onClick(()=>Ct(s[v],c,S.worldPos()))}}function Ct(t,r,o){j&&(be[j.key].hidden=!0),be[t].hidden=!1,Ve(t,r),e.play("click1",{volume:m}),Ie=o}function Nt(){u.header=u.group.add([e.text("LEVEL 1",{size:10,font:"unscii"}),e.anchor("top"),e.pos(200/2,0)]),u.title=u.group.add([e.text("BLASTER",{size:14,font:"unscii"}),e.anchor("top"),e.pos(200/2,22)]);const o=u.group.add([e.pos(0,80),e.rect(200,300),e.color(0,0,0),e.outline(2,new e.Color(255,255,255))]),s=o.add([e.rect(200/2,60),e.color(0,0,0),e.anchor("center"),e.pos(200/2,10),e.outline(2,new e.Color(255,255,255))]);u.icon=s.add([e.sprite("ship",{height:32,width:32}),e.anchor("center")]),u.desc=o.add([e.pos(0,80),e.text("EQUIPE YOUR SHIP WITH A LASER BLASTER, LEFT MOUSE TO FIRE",{size:12,font:"unscii",width:200,align:"center",lineSpacing:12})]),u.purchaseBtn=u.group.add([e.rect(240,50),e.area(),e.opacity(1),e.anchor("center"),e.pos(200/2,340)]),u.purchaseBtnText=u.purchaseBtn.add([e.text("PURCHASE 12P",{size:16,font:"unscii"}),e.color(0,0,0),e.anchor("center")]),u.purchaseBtn.onClick(()=>{var i;if(u.group.hidden||(i=u.purchaseBtn)!=null&&i.hidden)return;const a=Z[j.key].upgrades[j.index];if(N<a.price){e.play("error",{volume:m});return}Fe(-a.price),ot(j.key),je(e.center()),Ve(j.key,j.index+1),_.emitter.position=Ie,_.emit(20),Me(),e.play("purchase1",{volume:m}),Ee.text=He(N)})}function Ve(t,r){const o=Z[t],s=e.clamp(r,0,o.upgrades.length-1);u.group.hidden=!1;const a=o.upgrades[s];if(u.title.text=o.toolName.toUpperCase(),u.desc.text=a.desc.toUpperCase(),u.header.text=a.name.toUpperCase(),u.icon.sprite=a.sprite,j={key:t,index:s},r!=s){u.purchaseBtn.hidden=!0;return}if(u.purchaseBtnText.text=`PURCHASE ${a.price}P`,u.purchaseBtn.hidden=!1,N<a.price){u.purchaseBtn.opacity=.3;return}u.purchaseBtn.opacity=1}function Rt(t,r,o){const s=e.add([e.pos(r),e.rect(300,50),e.area(),e.color(0,0,0),e.anchor("center"),"ui"]);return s.add([e.text(t,{size:16,font:"unscii"}),e.anchor("center")]),s.onClick(o),s}function Wt(t,r,o,s){return t.add([e.rect(80,40),e.pos(s),e.anchor("center"),e.outline(2,new e.Color(255,255,255)),e.color(0,0,0)]).add([e.text(o,{size:r,font:"unscii"}),e.anchor("center")])}function ye(t,r){return e.add([e.pos(t),r])}function He(t){return`${t}P`}const R={bg:"bg",game:"game",ui:"ui"},C={Playing:1,LevelUp:2},se=-22;let N=60;const zt=320,Gt=280;let we=0;const w=[],m=.4,Kt=.9;let le=C.Playing;const e=qe({background:"#000000",global:!1,scale:1.3,width:600,height:600});it(e).then(()=>{pt(),Jt(),e.setLayers([R.bg,R.game,R.ui],R.game),Yt(),_e(C.LevelUp),e.onUpdate(()=>{le==C.Playing&&(we+=e.dt(),jt())})});function _e(t){le=t,le==C.Playing?It():le==C.LevelUp&&(Ue("slot1"),Ft())}function Fe(t){N+=t}function Jt(){var t=dt("slot1");t&&(at(t.loadout),N=t.score,we=t.time,Me())}function Yt(){const t=e.center();w.push(e.vec2(22,22)),w.push(e.vec2(t.x*2+se,22)),w.push(e.vec2(t.x*2+se,t.y*2+se)),w.push(e.vec2(22,t.y*2+se))}function E(t){const r=Math.floor(w.length*t),o=1/w.length*r,s=(t-o)*w.length,a=(r+1>=w.length?w[0]:w[r+1]).sub(w[r]),i=e.clamp(r,0,w.length-1);return w[i].add(a.scale(s))}
//# sourceMappingURL=index-BxliPvtz.js.map
