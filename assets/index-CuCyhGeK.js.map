{"version":3,"file":"index-CuCyhGeK.js","sources":["../../src/upgrades/blasters.ts","../../src/upgrades/follower.ts","../../src/upgrades/rockets.ts","../../src/upgrades/ship.ts","../../src/upg.ts","../../src/util.ts","../../src/player.ts","../../src/particles.ts","../../src/wave.ts","../../src/tags.ts","../../src/gameUi.ts","../../src/spawn/spawnFlash.ts","../../src/projectiles/blaster.ts","../../src/shared.ts","../../src/projectiles/rocket.ts","../../src/setupPlayer.ts","../../src/comp/target.ts","../../src/spawn/spawnFollower.ts","../../src/spawn/spawnPowerup.ts","../../src/powerups.ts","../../src/projectiles/shared.ts","../../src/spawn/spawnDebree.ts","../../src/spawn/enemyShared.ts","../../src/spawn/spawnAssasin.ts","../../src/spawn/spawnAsteroid.ts","../../src/spawn/spawnGenericVehicle.ts","../../src/spawn/spawnHighway.ts","../../src/compose.ts","../../src/comp/jitter.ts","../../src/spawn/spawnShip1.ts","../../src/web.ts","../../src/spawn/spawnCrate.ts","../../src/spawn/spawnSpawner.ts","../../src/levels/level1.ts","../../src/game.ts","../../src/levelUp.ts","../../src/main.ts"],"sourcesContent":["import { Tool } from \"../upg\";\n\nexport const blaster: Tool = {\n\ttoolName: \"Blaster\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Add a second blaster to your ship\",\n\t\t\tprice: 12,\n\t\t\tsprite: \"blaster1\",\n\t\t\tvalue: 1,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Add a third blaster to your ship\",\n\t\t\tprice: 12,\n\t\t\tsprite: \"blaster1\",\n\t\t\tvalue: 2,\n\t\t},\n\t],\n};\n\nexport const blasterMultiple: Tool = {\n\ttoolName: \"Parallel processor\",\n\trequiredTool: \"blaster\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Fire all blasters at the same time\",\n\t\t\tprice: 12,\n\t\t\tsprite: \"parallel_blasters_upg1\",\n\t\t\tvalue: 1,\n\t\t},\n\t],\n};\n\nexport const blasterSpeed: Tool = {\n\ttoolName: \"Blaster speed\",\n\trequiredTool: \"blaster\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Increase velocity of blaster projectiles\",\n\t\t\tprice: 12,\n\t\t\tsprite: \"blaster_upg_speed1\",\n\t\t\tvalue: 1.65,\n\t\t},\n\t],\n};\n\nexport const blasterDmg: Tool = {\n\ttoolName: \"Blaster dmg\",\n\trequiredTool: \"blaster\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Increase damage of the ships primary blasters\",\n\t\t\tprice: 12,\n\t\t\tsprite: \"blaster_upg_dmg1\",\n\t\t\tvalue: 2,\n\t\t},\n\t],\n};\n","import { Tool } from \"../upg\";\n\nexport const followerBlasterDmg: Tool = {\n\ttoolName: \"Followers\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Increase your followers blaster damage\",\n\t\t\tsprite: \"follower_blaster_dmg_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 1,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Too... Many... Damage... Numbers...\",\n\t\t\tsprite: \"follower_blaster_dmg_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 2,\n\t\t},\n\t],\n};\n\nexport const followerMissiles: Tool = {\n\ttoolName: \"Followers\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Your followers will become quite dangerous (with missiles)\",\n\t\t\tsprite: \"follower_missiles_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 1,\n\t\t},\n\t],\n};\n","import { Tool } from \"../upg\";\n\nexport const rocket: Tool = {\n\ttoolName: \"Missile barrage\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Install missile pods to the ship, right mouse to fire\",\n\t\t\tsprite: \"rocket_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 1,\n\t\t},\n\t],\n};\n\nexport const increaseRockets: Tool = {\n\ttoolName: \"Increase missiles\",\n\trequiredTool: \"rockets\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Increase missiles to 6\",\n\t\t\tsprite: \"more_missiles_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 6,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Increase missiles to 8\",\n\t\t\tsprite: \"more_missiles_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 8,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 3\",\n\t\t\tdesc: \"Increase missiles to 10\",\n\t\t\tsprite: \"more_missiles_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 10,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 4\",\n\t\t\tdesc: \"Increase missiles to 16, missiles will be taped outside the pod\",\n\t\t\tsprite: \"more_missiles_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 16,\n\t\t},\n\t],\n};\n\nexport const rocketShards: Tool = {\n\ttoolName: \"Missile shards\",\n\trequiredTool: \"rockets\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Missiles are loaded with space debree, shooting shards when exploded\",\n\t\t\tsprite: \"missile_shards_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 5,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Squeeze some more debree in those missiles!!\",\n\t\t\tsprite: \"missile_shards_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 7,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 3\",\n\t\t\tdesc: \"Squeeze some more debree in those missiles!!\",\n\t\t\tsprite: \"missile_shards_upg1\",\n\t\t\tprice: 22,\n\t\t\tvalue: 9,\n\t\t},\n\t],\n};\n","import { Tool } from \"../upg\";\n\nexport const debreeDist: Tool = {\n\ttoolName: \"Debree magnets\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Upgrade the ships magnetic magnets and increase debree collect distance\",\n\t\t\tsprite: \"debree_dist_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.2,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Upgrade the ships magnetic magnets and increase debree collect distance\",\n\t\t\tsprite: \"debree_dist_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.4,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 3\",\n\t\t\tdesc: \"Upgrade the ships magnetic magnets and increase debree collect distance\",\n\t\t\tsprite: \"debree_dist_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.6,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 4\",\n\t\t\tdesc: \"Upgrade the ships magnetic magnets and increase debree collect distance\",\n\t\t\tsprite: \"debree_dist_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.8,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 5\",\n\t\t\tdesc: \"Upgrade the ships magnetic magnets and increase debree collect distance\",\n\t\t\tsprite: \"debree_dist_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 2,\n\t\t},\n\t],\n};\n\nexport const debreeSpeed: Tool = {\n\ttoolName: \"Stronger magnets\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Stronger magnets = faster debree, easy math\",\n\t\t\tsprite: \"debree_speed_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.2,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Stronger magnets = faster debree, easy math\",\n\t\t\tsprite: \"debree_speed_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.4,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 3\",\n\t\t\tdesc: \"Stronger magnets = faster debree, easy math\",\n\t\t\tsprite: \"debree_speed_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 2,\n\t\t},\n\t],\n};\n\nexport const sprint: Tool = {\n\ttoolName: \"Thrusters overclock\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Hold SHIFT to overclock thrusters, increasing speed\",\n\t\t\tsprite: \"overclock_thrusters_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.2,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Increase speed when overclocking thrusters\",\n\t\t\tsprite: \"overclock_thrusters_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.4,\n\t\t},\n\t],\n};\n\nexport const sprintSpeed: Tool = {\n\ttoolName: \"Thrusters cooling\",\n\trequiredTool: \"sprint\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Pouring unknown liquid on the thrusters seems to make them go faster during overclock??\",\n\t\t\tsprite: \"faster_speed_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.3,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Pour more liquid, the ship probably need some pumps soon...\",\n\t\t\tsprite: \"faster_speed_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.4,\n\t\t},\n\t],\n};\n\nexport const movespeed: Tool = {\n\ttoolName: \"Improved thrusters\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Bigger thrusters, more speed\",\n\t\t\tsprite: \"faster_speed_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.05,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Bigger thrusters, more speed\",\n\t\t\tsprite: \"faster_speed_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 1.15,\n\t\t},\n\t],\n};\n\nexport const debreeValue: Tool = {\n\ttoolName: \"Shiny debree\",\n\trequiredTool: \"debreeDist\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Debree becomes more valueable, who could have thought\",\n\t\t\tsprite: \"debree_value_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 2,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Debree becomes almost as valuable as gold\",\n\t\t\tsprite: \"debree_value_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 3,\n\t\t},\n\t],\n};\n\nexport const maxHealth: Tool = {\n\ttoolName: \"Stronger hull\",\n\tupgrades: [\n\t\t{\n\t\t\tname: \"Level 1\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 3,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 2\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 4,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 3\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 5,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 4\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 6,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 5\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 7,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 6\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 8,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 7\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 9,\n\t\t},\n\t\t{\n\t\t\tname: \"Level 8\",\n\t\t\tdesc: \"Upgrade hull and increase health by one\",\n\t\t\tsprite: \"hull_upg1\",\n\t\t\tprice: 32,\n\t\t\tvalue: 10,\n\t\t},\n\t],\n};\n","import {\n\tblaster,\n\tblasterDmg,\n\tblasterMultiple,\n\tblasterSpeed,\n} from \"./upgrades/blasters\";\nimport { followerBlasterDmg, followerMissiles } from \"./upgrades/follower\";\nimport { increaseRockets, rocket, rocketShards } from \"./upgrades/rockets\";\nimport {\n\tdebreeDist,\n\tdebreeSpeed,\n\tdebreeValue,\n\tmaxHealth,\n\tmovespeed,\n\tsprint,\n\tsprintSpeed,\n} from \"./upgrades/ship\";\nimport { saveGame } from \"./util\";\n\ninterface Upgrade {\n\tname: string;\n\tdesc: string;\n\tprice: number;\n\tsprite: string;\n\tvalue: number;\n}\n\nexport type ToolKey = keyof typeof upgrades;\n\nexport interface Tool {\n\ttoolName: string;\n\trequiredTool?: ToolKey;\n\tupgrades: Upgrade[];\n}\n\nexport const upgrades = {\n\tblaster: blaster,\n\tblasterParallel: blasterMultiple,\n\tblasterDmg: blasterDmg,\n\tblasterSpeed: blasterSpeed,\n\n\trockets: rocket,\n\tnrOfRockets: increaseRockets,\n\trocketShards: rocketShards,\n\n\tdebreeDist: debreeDist,\n\tdebreeSpeed: debreeSpeed,\n\tdebreeValue: debreeValue,\n\n\tsprint: sprint,\n\tsprintSpeed: sprintSpeed,\n\n\tmovespeed: movespeed,\n\tmaxHealth: maxHealth,\n\n\tfollowerBlasterDmg: followerBlasterDmg,\n\tfollowerMissiles: followerMissiles,\n} as const;\n\nexport let loadout: Record<ToolKey, number | undefined> = {\n\tblaster: undefined,\n\tblasterDmg: undefined,\n\tblasterSpeed: undefined,\n\trockets: undefined,\n\tdebreeDist: undefined,\n\tdebreeSpeed: undefined,\n\tnrOfRockets: undefined,\n\tsprint: undefined,\n\tmovespeed: undefined,\n\tdebreeValue: undefined,\n\tmaxHealth: undefined,\n\tfollowerBlasterDmg: undefined,\n\tfollowerMissiles: undefined,\n\trocketShards: undefined,\n\tsprintSpeed: undefined,\n\tblasterParallel: undefined,\n};\n\nexport let levelLoadout: Record<ToolKey, number | undefined> = {\n\tblaster: undefined,\n\tblasterDmg: undefined,\n\tblasterSpeed: undefined,\n\trockets: undefined,\n\tdebreeDist: undefined,\n\tdebreeSpeed: undefined,\n\tnrOfRockets: undefined,\n\tsprint: undefined,\n\tmovespeed: undefined,\n\tdebreeValue: undefined,\n\tmaxHealth: undefined,\n\tfollowerBlasterDmg: undefined,\n\tfollowerMissiles: undefined,\n\trocketShards: undefined,\n\tsprintSpeed: undefined,\n\tblasterParallel: undefined,\n};\n\nexport function getToolUpgradeLvlValue(key: ToolKey) {\n\tif (loadout[key] === undefined) return undefined;\n\n\treturn upgrades[key].upgrades[loadout[key]].value;\n}\n\nexport function addLvl(key: ToolKey) {\n\tloadout[key] = getNextLvl(key);\n\tsaveGame(\"slot1\");\n}\n\nexport function getNextLvl(key: ToolKey) {\n\tif (loadout[key] === undefined) return 0;\n\treturn loadout[key] + 1;\n}\n\nexport function setLoadout(set: Record<string, number | undefined>) {\n\tloadout = set;\n}\n\nexport function resetLevelLoadout() {\n\tlevelLoadout = {\n\t\tblaster: undefined,\n\t\tblasterDmg: undefined,\n\t\tblasterSpeed: undefined,\n\t\trockets: undefined,\n\t\tdebreeDist: undefined,\n\t\tdebreeSpeed: undefined,\n\t\tnrOfRockets: undefined,\n\t\tsprint: undefined,\n\t\tmovespeed: undefined,\n\t\tdebreeValue: undefined,\n\t\tmaxHealth: undefined,\n\t\tfollowerBlasterDmg: undefined,\n\t\tfollowerMissiles: undefined,\n\t\trocketShards: undefined,\n\t\tsprintSpeed: undefined,\n\t\tblasterParallel: undefined,\n\t};\n}\n","import { KAPLAYCtx } from \"kaplay\";\nimport { loadout, upgrades } from \"./upg\";\nimport { score, timeSeconds } from \"./main\";\n\ninterface SaveSlot {\n\ttime: number;\n\tscore: number;\n\tloadout: Record<string, number | undefined>;\n}\n\nexport async function init(k: KAPLAYCtx<{}, never>) {\n\tawait k.loadRoot(\"./\"); // A good idea for Itch.io publishing later\n\tawait k.loadSprite(\"ship\", \"sprites/ship.png\");\n\tawait k.loadSprite(\"crate1\", \"sprites/crate1.png\");\n\tawait k.loadSprite(\"bullet1\", \"sprites/bullet1.png\");\n\tawait k.loadSprite(\"rocket1\", \"sprites/rocket1.png\");\n\tawait k.loadSprite(\"follower\", \"sprites/follower.png\");\n\n\tawait k.loadSprite(\"asteroid1\", \"sprites/asteroid1.png\");\n\tawait k.loadSprite(\"enemy_ship1\", \"sprites/enemy_ship1.png\");\n\tawait k.loadSprite(\"bike1\", \"sprites/bike1.png\");\n\n\tawait k.loadSprite(\"particle1\", \"sprites/particle1.png\");\n\tawait k.loadSprite(\"particle2\", \"sprites/particle2.png\");\n\tawait k.loadSprite(\"particle3\", \"sprites/particle3.png\");\n\tawait k.loadSprite(\"particle4\", \"sprites/particle4.png\");\n\tawait k.loadSprite(\"spark1\", \"sprites/spark1.png\");\n\n\tawait k.loadSprite(\"debree_part1\", \"sprites/debree_part1.png\");\n\n\tawait k.loadSprite(\"blaster1\", \"sprites/upgrades/laser_cannon1.png\");\n\tawait k.loadSprite(\"rocket_upg1\", \"sprites/upgrades/rocket_upg1.png\");\n\tawait k.loadSprite(\n\t\t\"blaster_upg_speed1\",\n\t\t\"sprites/upgrades/blaster_upg_speed1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"blaster_upg_dmg1\",\n\t\t\"sprites/upgrades/blaster_upg_dmg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"debree_dist_upg1\",\n\t\t\"sprites/upgrades/debree_dist_upg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"debree_speed_upg1\",\n\t\t\"sprites/upgrades/debree_speed_upg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"debree_value_upg1\",\n\t\t\"sprites/upgrades/debree_value_upg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"faster_speed_upg1\",\n\t\t\"sprites/upgrades/faster_speed_upg1.png\"\n\t);\n\tawait k.loadSprite(\"hull_upg1\", \"sprites/upgrades/hull_upg1.png\");\n\tawait k.loadSprite(\n\t\t\"missile_shards_upg1\",\n\t\t\"sprites/upgrades/missiles_shards_upg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"more_missiles_upg1\",\n\t\t\"sprites/upgrades/more_missiles_upg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"overclock_thrusters_upg1\",\n\t\t\"sprites/upgrades/overclock_thrusters_upg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"parallel_blasters_upg1\",\n\t\t\"sprites/upgrades/parallel_blasters_upg1.png\"\n\t);\n\tawait k.loadSprite(\"follower_upg1\", \"sprites/upgrades/follower_upg1.png\");\n\tawait k.loadSprite(\n\t\t\"follower_missiles_upg1\",\n\t\t\"sprites/upgrades/follower_missiles_upg1.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"follower_blaster_dmg_upg1\",\n\t\t\"sprites/upgrades/follower_blaster_dmg_upg1.png\"\n\t);\n\n\tawait k.loadSprite(\"bg_moon1\", \"sprites/bg/moon1.png\");\n\tawait k.loadSprite(\"bg_building1\", \"sprites/bg/building1.png\");\n\n\tawait k.loadBitmapFont(\"unscii\", \"/fonts/unscii_8x8.png\", 8, 8);\n\n\tawait k.loadSound(\"shoot1\", \"sounds/shoot1.wav\");\n\tawait k.loadSound(\"fire_rocket1\", \"sounds/rocket_fire1.wav\");\n\n\tawait k.loadSound(\"explosion1\", \"sounds/explosion1.wav\");\n\tawait k.loadSound(\"explosion2\", \"sounds/explosion2.wav\");\n\tawait k.loadSound(\"explosion3\", \"sounds/explosion3.wav\");\n\tawait k.loadSound(\"explosion4\", \"sounds/explosion4.wav\");\n\tawait k.loadSound(\"hit1\", \"sounds/hit1.wav\");\n\tawait k.loadSound(\"hit2\", \"sounds/hit2.wav\");\n\tawait k.loadSound(\"player_hit1\", \"sounds/player_hit1.wav\");\n\tawait k.loadSound(\"collect1\", \"sounds/collect1.wav\");\n\tawait k.loadSound(\"click1\", \"sounds/click.wav\");\n\tawait k.loadSound(\"purchase\", \"sounds/purchase.wav\");\n\tawait k.loadSound(\"error\", \"sounds/error.wav\");\n\tawait k.loadSound(\"purchase1\", \"sounds/purchase1.wav\");\n\tawait k.loadSound(\"powerup1\", \"sounds/powerup1.wav\");\n\tawait k.loadSound(\"crit1\", \"sounds/crit1.wav\");\n\n\tawait k.loadMusic(\"arcadia\", \"songs/arcadia.mp3\");\n\n\tawait k.loadSprite(\n\t\t\"enemy_ship1_left_wing\",\n\t\t\"sprites/ships/enemy1/enemy_ship1_left_wing.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"enemy_ship1_right_wing\",\n\t\t\"sprites/ships/enemy1/enemy_ship1_right_wing.png\"\n\t);\n\tawait k.loadSprite(\n\t\t\"enemy_ship1_body\",\n\t\t\"sprites/ships/enemy1/enemy_ship1_body.png\"\n\t);\n}\n\nconst explArr = [\"explosion1\", \"explosion2\", \"explosion3\"];\n\nexport function randomExplosion() {\n\tconst r = Math.floor(Math.random() * explArr.length);\n\treturn explArr[r];\n}\n\nexport function adjustedTarget(from, to) {\n\treturn from + shortestAngleDelta(from, to);\n}\n\nexport function shortestAngleDelta(from, to) {\n\tlet delta = (to - from) % 360;\n\tif (delta > 180) delta -= 360;\n\tif (delta < -180) delta += 360;\n\treturn delta;\n}\n\nexport function saveGame(slot: string) {\n\tconst save: SaveSlot = {\n\t\tloadout,\n\t\tscore: score,\n\t\ttime: timeSeconds,\n\t};\n\tlocalStorage.setItem(slot, JSON.stringify(save));\n}\nexport function loadGame(slot: string): SaveSlot | null {\n\tvar p = localStorage.getItem(slot);\n\n\tif (!p) return null;\n\n\treturn JSON.parse(p);\n}\n","import { escape } from \"querystring\";\nimport { getToolUpgradeLvlValue, ToolKey } from \"./upg\";\n\ninterface Ship {\n\tspeed: number;\n\tspeedMultiplier: number;\n\tspeedPwrUpMultiplier: number;\n\n\tcanSprint: number | undefined;\n\tsprintSpeedMultiplier: number;\n\n\tmaxHealth: number;\n\tscorePerPickup: number;\n\tblasterDmg: number;\n\tblasterDmgMultiplier: number;\n\tblasterSpeedMultiplier: number;\n\n\tdebreePickupDistance: number;\n\tdebreeSeekDistance: number;\n\tdebreeSeekDistanceMultiplier: number;\n\tdebreeSeekSpeed: number;\n\tdebreeSeekSpeedMultiplier: number;\n\tdebreeValueMultiplier: number;\n\n\tblasterLvl: number | undefined;\n\tblasterParallel: number | undefined;\n\trocketsLvl: number | undefined;\n\n\trocketImpactDmg: number;\n\trocketSplashDmg: number;\n\trocketDmgMultiplier: number;\n\trocketSeekDistance: number;\n\n\trocketSplashSize: number;\n\trocketSplashSizeMultiplier: number;\n\n\trocketSplashDmgFallOverDistance: number;\n\trocketSplashDmgFallDistanceValue: number;\n\n\tnrOfRockets: number;\n\trocketShards: number;\n\n\tfollowerBlasterDmg: number;\n\tfollowerBlasterDmgMultiplier: number;\n\tfollowerCanUseMissiles: number | undefined;\n\n\tcritChance: number;\n\tcritMultiplier: number;\n}\n\ninterface Session {\n\textraHealth: number;\n\textraRockets: number;\n\textraSpaceDebreeInMissiles: number;\n}\n\nexport const session: Session = {\n\textraHealth: 0,\n\textraRockets: 0,\n\textraSpaceDebreeInMissiles: 0,\n};\n\nexport function resetSession() {\n\tsession.extraHealth = 0;\n\tsession.extraRockets = 0;\n\tsession.extraSpaceDebreeInMissiles = 0;\n}\n\nexport const player: Ship = {\n\tmaxHealth: 2,\n\tscorePerPickup: 1,\n\tblasterDmg: 2,\n\tblasterDmgMultiplier: 1,\n\tblasterLvl: undefined,\n\tblasterParallel: undefined,\n\trocketsLvl: undefined,\n\tnrOfRockets: 3,\n\trocketShards: 0,\n\tblasterSpeedMultiplier: 1,\n\tdebreePickupDistance: 10,\n\tdebreeSeekDistance: 50,\n\tdebreeSeekSpeed: 80,\n\tdebreeSeekDistanceMultiplier: 1,\n\tdebreeSeekSpeedMultiplier: 1,\n\tdebreeValueMultiplier: 1,\n\trocketImpactDmg: 10,\n\trocketSplashDmg: 5,\n\trocketDmgMultiplier: 1,\n\trocketSplashSize: 30,\n\trocketSplashSizeMultiplier: 1,\n\trocketSplashDmgFallOverDistance: 0.7, // How much the splash dmg is reduced after distance met\n\trocketSplashDmgFallDistanceValue: 0.6,\n\trocketSeekDistance: 200,\n\tspeed: 100,\n\tcanSprint: undefined,\n\tsprintSpeedMultiplier: 1,\n\tspeedMultiplier: 1,\n\tspeedPwrUpMultiplier: 1,\n\tfollowerBlasterDmg: 1,\n\tfollowerBlasterDmgMultiplier: 1,\n\tfollowerCanUseMissiles: undefined,\n\tcritChance: 30,\n\tcritMultiplier: 1.5,\n};\n\nexport function loadPlayer() {\n\tplayer.blasterLvl = getToolUpgradeLvlValue(\"blaster\");\n\tplayer.blasterParallel = getToolUpgradeLvlValue(\"blasterParallel\");\n\tplayer.blasterDmgMultiplier = getToolUpgradeLvlValue(\"blasterDmg\") ?? 1;\n\tplayer.blasterSpeedMultiplier = getToolUpgradeLvlValue(\"blasterSpeed\") ?? 1;\n\n\tplayer.rocketsLvl = getToolUpgradeLvlValue(\"rockets\");\n\tplayer.nrOfRockets = getToolUpgradeLvlValue(\"nrOfRockets\") ?? 3;\n\tplayer.rocketShards = getToolUpgradeLvlValue(\"rocketShards\") ?? 0;\n\n\tplayer.debreeSeekDistanceMultiplier =\n\t\tgetToolUpgradeLvlValue(\"debreeDist\") ?? 1;\n\tplayer.debreeSeekSpeedMultiplier = getToolUpgradeLvlValue(\"debreeSpeed\") ?? 1;\n\tplayer.debreeValueMultiplier = getToolUpgradeLvlValue(\"debreeValue\") ?? 1;\n\n\tplayer.canSprint = getToolUpgradeLvlValue(\"sprint\");\n\tplayer.sprintSpeedMultiplier = getToolUpgradeLvlValue(\"sprintSpeed\") ?? 1;\n\n\tplayer.speedMultiplier = getToolUpgradeLvlValue(\"movespeed\") ?? 1;\n\tplayer.maxHealth = getToolUpgradeLvlValue(\"maxHealth\") ?? 2;\n\n\tplayer.followerBlasterDmg = getToolUpgradeLvlValue(\"followerBlasterDmg\") ?? 1;\n\tplayer.followerCanUseMissiles = getToolUpgradeLvlValue(\"followerMissiles\");\n}\n\nexport function hasLvlValue(value: number | undefined, lvl: number) {\n\tif (value === undefined) return false;\n\n\treturn value >= lvl;\n}\n","import { GameObj, ParticlesComp, PosComp } from \"kaplay\";\nimport { k } from \"./main\";\n\nexport let trailEmitter: GameObj<PosComp | ParticlesComp>;\nexport let starsEmitter: GameObj<PosComp | ParticlesComp>;\nexport let starsEmitterDir: GameObj<PosComp | ParticlesComp>;\nexport let explosionEmitter: GameObj<PosComp | ParticlesComp>;\nexport let debreeEmitter: GameObj<PosComp | ParticlesComp>;\nexport let debreeRocketEmitter: GameObj<PosComp | ParticlesComp>;\nexport let dustTrailEmitter: GameObj<PosComp | ParticlesComp>;\nexport let sparkEmitter: GameObj<PosComp | ParticlesComp>;\n\nexport function initParticles() {\n\ttrailEmitter = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 2000,\n\t\t\t\tspeed: [2, 30],\n\t\t\t\tlifeTime: [0.2, 0.6],\n\t\t\t\tcolors: [k.WHITE],\n\t\t\t\topacities: [0.8, 0.6],\n\t\t\t\tangle: [0, 360],\n\t\t\t\tdamping: [2, 2],\n\t\t\t\tscales: [0.4, 0.2, 0.1],\n\t\t\t\ttexture: k.getSprite(\"particle3\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"particle3\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 1,\n\t\t\t\tdirection: 0,\n\t\t\t\tspread: 90,\n\t\t\t\tposition: k.vec2(0, 0),\n\t\t\t}\n\t\t),\n\t\t\"trail\",\n\t]);\n\n\tstarsEmitter = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 1000,\n\t\t\t\tspeed: [10, 40],\n\t\t\t\tangle: [0, 360],\n\t\t\t\tlifeTime: [1, 1.5],\n\t\t\t\tcolors: [k.rgb(255, 255, 255)],\n\t\t\t\topacities: [1, 0.5],\n\t\t\t\tscales: [1.4, 1, 0.4, 0.1],\n\t\t\t\tdamping: [0, 0.5],\n\t\t\t\tangularVelocity: [-90, 90],\n\t\t\t\ttexture: k.getSprite(\"particle1\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"particle1\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 0,\n\t\t\t\tdirection: -90,\n\t\t\t\tspread: 360,\n\t\t\t\tposition: k.vec2(),\n\t\t\t}\n\t\t),\n\t]);\n\n\tstarsEmitterDir = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 1000,\n\t\t\t\tspeed: [200, 300],\n\t\t\t\tangle: [0, 360],\n\t\t\t\tlifeTime: [1, 1.5],\n\t\t\t\tcolors: [k.rgb(255, 255, 255)],\n\t\t\t\topacities: [1, 0.5],\n\t\t\t\tscales: [1.4, 1, 0.4, 0.1],\n\t\t\t\tdamping: [0, 0.5],\n\t\t\t\tangularVelocity: [-90, 90],\n\t\t\t\ttexture: k.getSprite(\"particle1\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"particle1\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 0,\n\t\t\t\tdirection: -90,\n\t\t\t\tspread: 40,\n\t\t\t\tposition: k.vec2(),\n\t\t\t}\n\t\t),\n\t]);\n\n\tsparkEmitter = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 1000,\n\t\t\t\tspeed: [100, 150],\n\t\t\t\tlifeTime: [1, 1.5],\n\t\t\t\tangle: [0, 360],\n\t\t\t\tcolors: [k.rgb(255, 255, 255)],\n\t\t\t\topacities: [1, 0.5],\n\t\t\t\tdamping: [0, 0.5],\n\t\t\t\ttexture: k.getSprite(\"particle4\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"particle4\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 0,\n\t\t\t\tdirection: -90,\n\t\t\t\tspread: 40,\n\t\t\t\tposition: k.vec2(),\n\t\t\t}\n\t\t),\n\t]);\n\n\tdustTrailEmitter = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 1000,\n\t\t\t\tspeed: [10, 40],\n\t\t\t\tlifeTime: [1, 1.5],\n\t\t\t\tcolors: [k.rgb(255, 255, 255)],\n\t\t\t\topacities: [1, 0.5],\n\t\t\t\tscales: [1, 0.4, 0.1],\n\t\t\t\tacceleration: [k.vec2(0, 1), k.vec2(0, 2)],\n\t\t\t\tangularVelocity: [-90, 90],\n\t\t\t\ttexture: k.getSprite(\"particle1\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"particle1\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 0,\n\t\t\t\tdirection: -90,\n\t\t\t\tspread: 0,\n\t\t\t\tposition: k.vec2(),\n\t\t\t}\n\t\t),\n\t]);\n\n\tdebreeEmitter = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 1000,\n\t\t\t\tspeed: [5, 40],\n\t\t\t\tangle: [0, 360],\n\t\t\t\tlifeTime: [1, 2],\n\t\t\t\tcolors: [k.rgb(255, 255, 255)],\n\t\t\t\topacities: [0.7, 0.4],\n\t\t\t\tangularVelocity: [-90, 90],\n\t\t\t\tscales: [1, 0.8, 0],\n\t\t\t\ttexture: k.getSprite(\"debree_part1\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"debree_part1\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 0,\n\t\t\t\tdirection: -90,\n\t\t\t\tspread: 360,\n\t\t\t\tposition: k.vec2(),\n\t\t\t}\n\t\t),\n\t]);\n\n\tdebreeRocketEmitter = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 1000,\n\t\t\t\tspeed: [60, 80],\n\t\t\t\tangle: [0, 360],\n\t\t\t\tlifeTime: [1, 2],\n\t\t\t\tcolors: [k.rgb(255, 255, 255)],\n\t\t\t\tangularVelocity: [-90, 90],\n\t\t\t\tscales: [1, 0.8, 0.2, 0],\n\t\t\t\ttexture: k.getSprite(\"debree_part1\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"debree_part1\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 0,\n\t\t\t\tdirection: -90,\n\t\t\t\tspread: 55,\n\t\t\t\tposition: k.vec2(),\n\t\t\t}\n\t\t),\n\t]);\n\n\texplosionEmitter = k.add([\n\t\tk.pos(),\n\t\tk.particles(\n\t\t\t{\n\t\t\t\tmax: 1000,\n\t\t\t\tspeed: [30, 80],\n\t\t\t\tangle: [0, 360],\n\t\t\t\tlifeTime: [0.5, 1.2],\n\t\t\t\tcolors: [k.rgb(255, 255, 255)],\n\t\t\t\topacities: [0.8, 0.5],\n\t\t\t\tscales: [0.4, 2, 1.2, 0.4, 0.1],\n\t\t\t\tdamping: [1, 2],\n\t\t\t\ttexture: k.getSprite(\"particle3\")!.data!.tex,\n\t\t\t\tquads: [k.getSprite(\"particle3\")!.data!.frames[0]],\n\t\t\t},\n\t\t\t{\n\t\t\t\trate: 0,\n\t\t\t\tdirection: -90,\n\t\t\t\tspread: 360,\n\t\t\t\tposition: k.vec2(),\n\t\t\t}\n\t\t),\n\t]);\n}\n","import { k } from \"./main\";\n\nexport interface Level {\n\tmusic: string; // The songs that plays the whole level\n\tbpm: number;\n\tsongTitle: string;\n\tsongAuthor: string;\n\tsongAlbumCover: string;\n\ttitle: string; // Main title which introduces the level\n\tintroduceSound: string; // What sound is played when the level is introduced?\n\tlevelLengthSeconds: number;\n\twaves: Wave[]; // Used for spawning enemies\n\tlvlUpd: () => void;\n\treset: () => void;\n}\n\ninterface Wave {\n\ttimeStamp: number; // timestamp in milliseconds\n\tduration?: number; // Duration of wave in milliseconds\n\tupd: (levelDuration: number) => void;\n\tbegin?: (levelDuration: number) => void;\n}\n\nlet currentLvl: Level | null = null;\nlet nextWaveIndex = -1;\nlet currentWaveIndex = -1;\nlet firstWaveTriggered = false;\nlet timeDuringLevel = 0;\nexport function loadLevel(lvl: Level) {\n\tcurrentLvl = lvl;\n\tnextWaveIndex = 0;\n\tcurrentWaveIndex = -1;\n}\n\nexport function updateLvl() {\n\tif (!currentLvl) return false;\n\ttimeDuringLevel += k.dt() * 1000;\n\n\t// Level ended\n\tif (currentLvl.levelLengthSeconds < timeDuringLevel / 1000) {\n\t\treturn true;\n\t}\n\n\tif (nextWaveIndex < currentLvl.waves.length) {\n\t\tconst nextTimestamp = currentLvl.waves[nextWaveIndex].timeStamp;\n\n\t\t// Timestamp reached, begin wave\n\t\tif (nextTimestamp < timeDuringLevel && currentWaveIndex != nextWaveIndex) {\n\t\t\tcurrentWaveIndex = nextWaveIndex;\n\t\t\tnextWaveIndex++;\n\t\t\tif (currentLvl.waves[currentWaveIndex].begin) {\n\t\t\t\tcurrentLvl.waves[currentWaveIndex].begin!(timeDuringLevel);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (currentWaveIndex > 0 && currentWaveIndex < currentLvl.waves.length) {\n\t\tconst waveEndedTimestamp =\n\t\t\t(currentLvl.waves[currentWaveIndex].duration ?? 0) +\n\t\t\tcurrentLvl.waves[currentWaveIndex].timeStamp;\n\n\t\tif (timeDuringLevel < waveEndedTimestamp) {\n\t\t\tcurrentLvl.waves[currentWaveIndex].upd(\n\t\t\t\ttimeDuringLevel - currentLvl.waves[currentWaveIndex].timeStamp\n\t\t\t);\n\t\t\tcurrentLvl.lvlUpd();\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nexport function activeLevel() {\n\treturn currentLvl != null;\n}\n\nexport function resetCurrentLevel() {\n\tif (!currentLvl) return;\n\tresetLvlData(currentLvl);\n\tcurrentLvl = null;\n\ttimeDuringLevel = 0;\n}\nexport function resetLvlData(lvl: Level) {\n\tnextWaveIndex = -1;\n\tcurrentWaveIndex = -1;\n\tlvl.reset();\n\tfirstWaveTriggered = false;\n}\n","export const tags = {\n\tfriendly: \"friendly\",\n\tenemy: \"enemy\",\n\tprops: \"props\",\n\tgameLoopUi: \"game_loop_ui\",\n\n\tblaster: \"blaster\",\n\trocket: \"rocket\",\n\tdebree: \"debree\",\n\tunit: \"unit\",\n\tpart: \"part\",\n\n\tlevelBg: \"level_bg\",\n};\n","import { AnimateComp, GameObj, OpacityComp, RectComp } from \"kaplay\";\nimport { k } from \"./main\";\nimport { tags } from \"./tags\";\n\nlet healthBars: GameObj<OpacityComp>[] = [];\nlet specialBar: GameObj<RectComp> | null = null;\n\nconst height = 10;\nconst specialHeight = 80;\nexport function setupGameLoopUi(health: number) {\n\tfor (let i = 0; i < health; i++) {\n\t\taddHealthBar(i);\n\t}\n\n\tk.add([\n\t\tk.pos(22, k.height() - 4 - specialHeight),\n\t\tk.rect(4, specialHeight),\n\t\tk.color(k.WHITE),\n\t\tk.opacity(0.2),\n\t\ttags.gameLoopUi,\n\t]);\n\tspecialBar = k.add([\n\t\tk.pos(22, k.height() - 4 - specialHeight),\n\t\tk.rect(4, specialHeight),\n\t\tk.color(k.WHITE),\n\t\ttags.gameLoopUi,\n\t]);\n}\n\nexport function addHealthBar(healthValue: number) {\n\tconst offset = height * healthValue;\n\tconst c = k.add([\n\t\tk.pos(10, k.height() - 10 - offset),\n\t\tk.rect(10, 6),\n\t\tk.color(k.WHITE),\n\t\tk.opacity(1),\n\t\ttags.gameLoopUi,\n\t]);\n\n\thealthBars.push(c);\n}\n\nexport function updatePlayerHealthBar(currentHealth: number) {\n\tfor (let i = 0; i < healthBars.length; i++) {\n\t\tif (i < currentHealth) {\n\t\t\thealthBars[i].opacity = 1;\n\t\t\tcontinue;\n\t\t}\n\t\thealthBars[i].opacity = 0.2;\n\t}\n}\n\nexport function updateSpecialBar(current: number, max: number) {\n\tspecialBar!.height = specialHeight * (current / max);\n}\n\nexport function clearGameLoopUi() {\n\tk.destroyAll(tags.gameLoopUi);\n\thealthBars = [];\n\tspecialBar = null;\n}\n","import { Vec2 } from \"kaplay\";\nimport { k, mainSoundVolume } from \"../main\";\n\nexport function spawnFlash(pos: Vec2, multiplier: number) {\n\tconst crit = k.add([\n\t\tk.pos(pos),\n\t\tk.circle(12 * multiplier),\n\t\tk.color(k.WHITE),\n\t\tk.scale(1),\n\t\tk.opacity(1),\n\t\tk.lifespan(0.04),\n\t]);\n}\n","import { projectiles } from \"../game\";\nimport { BULLET_SPEED, k, mainSoundVolume } from \"../main\";\nimport { spawnFlash } from \"../spawn/spawnFlash\";\nimport { tags } from \"../tags\";\n\nexport function shootBlaster(\n\tpos,\n\tdir,\n\trot,\n\tdmg,\n\tspeedMltp,\n\tattachTags,\n\tplaySound\n) {\n\tconst p = k.add([\n\t\tk.pos(pos),\n\t\tk.move(dir, BULLET_SPEED * speedMltp),\n\t\tk.area(),\n\t\tk.rotate(rot),\n\t\tk.offscreen({ destroy: true }),\n\t\tk.anchor(\"center\"),\n\t\tk.sprite(\"bullet1\"),\n\t\t{\n\t\t\tdmg,\n\t\t},\n\t\t...[...attachTags, tags.gameLoopUi],\n\t]);\n\n\tp.onDestroy(() => {\n\t\tconst index = projectiles.findIndex((p2) => p2.id == p.id);\n\n\t\tprojectiles.splice(index, 1);\n\t\tspawnFlash(p.pos, 0.2);\n\t});\n\n\tif (playSound) {\n\t\tk.play(\"shoot1\", { volume: mainSoundVolume });\n\t}\n\n\tprojectiles.push(p);\n}\n","import {\n\tAnimateComp,\n\tGameObj,\n\tOpacityComp,\n\tPosComp,\n\tRotateComp,\n\tScaleComp,\n\tVec2,\n} from \"kaplay\";\nimport { k } from \"./main\";\nimport { adjustedTarget } from \"./util\";\n\nexport function registerHitAnimation(m: GameObj<AnimateComp>) {\n\tm.animate(\"opacity\", [0, 1, 0, 1], {\n\t\tduration: 0.14,\n\t\tloops: 1,\n\t});\n}\n\nexport function lerpAngleBetweenPos(\n\tangle: number,\n\tpos1: Vec2,\n\tpos2: Vec2,\n\thardness: number,\n\taddAngle: number\n) {\n\tconst dir = pos1.sub(pos2).unit();\n\n\tconst a = Math.atan2(dir.y, dir.x);\n\n\tconst desiredRot = k.rad2deg(a) + addAngle;\n\tconst correctedDesiredRot = adjustedTarget(angle, desiredRot);\n\n\treturn { dir, lerp: k.lerp(angle, correctedDesiredRot, hardness) };\n}\n\nexport function lerpMoveRotateAndScale(\n\tm: GameObj<PosComp | RotateComp | ScaleComp | any>,\n\tlerp: number,\n\tspeed: number\n) {\n\tconst lerpAngle = k.deg2rad(lerp + 90);\n\tconst x = Math.cos(lerpAngle);\n\tconst y = Math.sin(lerpAngle);\n\tm.move(x * speed * -1, y * speed * -1);\n\tm.angle = lerp;\n\tm.scale = k.vec2(1, Math.abs(y));\n}\n\nexport function sum(values: number[]) {\n\treturn values.reduce((a, b) => a + b, 0);\n}\n","import { Vec2 } from \"kaplay\";\nimport { pickUnitInDistance, projectiles } from \"../game\";\nimport { k, mainSoundVolume, ROCKET_SPEED, subSoundVolume } from \"../main\";\nimport { trailEmitter } from \"../particles\";\nimport { lerpAngleBetweenPos, lerpMoveRotateAndScale } from \"../shared\";\nimport { shootBlaster } from \"./blaster\";\nimport { tags } from \"../tags\";\nimport { player, session } from \"../player\";\nimport { randomExplosion } from \"../util\";\n\nconst acquireTargetAfter = 0.5;\nconst trailOffset = 12;\nconst maxSpeed = 400;\nexport function shootRocket(\n\tpos,\n\tdir,\n\trot,\n\timpactDmg,\n\tsplashDmg,\n\tsplashSize,\n\tsplashDmgFallof,\n\tsplashDmgFallofDist,\n\tspeedMltp,\n\ttagsToAttach,\n\tcanSeek\n) {\n\tconst r = k.add([\n\t\tk.pos(pos),\n\t\tk.area(),\n\t\tk.rotate(rot),\n\t\tk.offscreen({ destroy: true }),\n\t\tk.anchor(\"center\"),\n\t\tk.scale(1),\n\t\tk.sprite(\"rocket1\"),\n\t\t{\n\t\t\timpactDmg,\n\t\t\tsplashDmg,\n\t\t\tsplashSize,\n\t\t\tsplashDmgFallof,\n\t\t\tsplashDmgFallofDist,\n\t\t\tlifetime: 0,\n\t\t\tspeedMltp,\n\t\t\tdir,\n\t\t\ttargetUnit: null,\n\t\t\tcanSeek,\n\t\t},\n\t\t...[...tagsToAttach, tags.gameLoopUi],\n\t]);\n\n\tk.play(\"fire_rocket1\", { volume: mainSoundVolume });\n\n\tr.onUpdate(() => {\n\t\tr.lifetime += k.dt();\n\n\t\tconst speed = k.clamp(\n\t\t\tROCKET_SPEED * r.speedMltp * (0.3 + r.lifetime),\n\t\t\t0,\n\t\t\tmaxSpeed\n\t\t);\n\n\t\tconst currentDir = k.Vec2.fromAngle(r.angle - 90);\n\t\tif (r.targetUnit) {\n\t\t\tconst { lerp, dir } = lerpAngleBetweenPos(\n\t\t\t\tr.angle,\n\t\t\t\tr.pos,\n\t\t\t\tr.targetUnit.pos,\n\t\t\t\t0.04,\n\t\t\t\t-90\n\t\t\t);\n\t\t\tlerpMoveRotateAndScale(r, lerp, speed);\n\t\t} else {\n\t\t\tr.move(currentDir.x * speed, currentDir.y * speed);\n\t\t}\n\n\t\tconst emitterPos = k.vec2(\n\t\t\tr.pos.x - trailOffset * currentDir.x,\n\t\t\tr.pos.y - trailOffset * currentDir.y\n\t\t);\n\t\ttrailEmitter.emitter.position = emitterPos;\n\t\ttrailEmitter.emitter.direction = r.angle;\n\t\ttrailEmitter.emit(1);\n\n\t\tif (r.canSeek && r.lifetime > acquireTargetAfter && r.targetUnit == null) {\n\t\t\tpickUnitInDistance(r.pos, 200, tags.enemy, (u) => {\n\t\t\t\tr.targetUnit = u;\n\n\t\t\t\tr.targetUnit?.onDestroy(() => {\n\t\t\t\t\tr.targetUnit = null;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t});\n\n\tr.onDestroy(() => {\n\t\tconst index = projectiles.findIndex((p2) => p2.id == r.id);\n\n\t\tprojectiles.splice(index, 1);\n\t\tk.play(randomExplosion(), { volume: subSoundVolume });\n\n\t\tconst shards = player.rocketShards + session.extraSpaceDebreeInMissiles;\n\t\tfor (let i = 0; i < shards; i++) {\n\t\t\tconst angle = 360 * (i / shards);\n\t\t\tshootBlaster(\n\t\t\t\tr.pos,\n\t\t\t\tk.Vec2.fromAngle(angle),\n\t\t\t\tangle + 90,\n\t\t\t\t1,\n\t\t\t\t1,\n\t\t\t\t[tags.friendly, tags.blaster],\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\t});\n\n\tprojectiles.push(r);\n}\n","import {\n\tcheckProjectileIntersection,\n\tclearGame,\n\tcreateExplosion,\n} from \"./game\";\nimport { updatePlayerHealthBar, updateSpecialBar } from \"./gameUi\";\nimport { k, mainSoundVolume } from \"./main\";\nimport { starsEmitter, trailEmitter } from \"./particles\";\nimport { hasLvlValue, player, session } from \"./player\";\nimport { shootBlaster } from \"./projectiles/blaster\";\nimport { shootRocket } from \"./projectiles/rocket\";\nimport {\n\tlerpAngleBetweenPos,\n\tlerpMoveRotateAndScale,\n\tregisterHitAnimation,\n} from \"./shared\";\nimport { tags } from \"./tags\";\nimport { randomExplosion } from \"./util\";\n\nlet blasters = 0;\nlet bulletIndex = 1;\nlet specialTimer = 0;\nconst rocketSpecialCooldown = 6;\nexport function setupPlayer() {\n\tconst playerObj = k.add([\n\t\tk.pos(k.center()),\n\t\tk.sprite(\"ship\"),\n\t\tk.rotate(0),\n\t\tk.scale(),\n\t\tk.health(player.maxHealth),\n\t\tk.area(),\n\t\tk.anchor(\"center\"),\n\t\tk.animate(),\n\t\ttags.friendly,\n\t]);\n\n\tregisterHitAnimation(playerObj);\n\n\tif (hasLvlValue(player.blasterLvl, 1)) {\n\t\tplayerObj.add([k.anchor(\"center\"), k.pos(10, 0)]);\n\t\tblasters++;\n\t\tplayerObj.add([k.anchor(\"center\"), k.pos(-10, 0)]);\n\t\tblasters++;\n\t} else {\n\t\tplayerObj.add([k.anchor(\"center\"), k.pos(0, -6)]);\n\t\tblasters++;\n\t}\n\tif (hasLvlValue(player.blasterLvl, 2)) {\n\t\tplayerObj.add([k.anchor(\"center\"), k.pos(0, -6)]);\n\t\tblasters++;\n\t}\n\n\tplayerObj.onDeath(() => {\n\t\tk.destroy(playerObj);\n\t\tstarsEmitter.emitter.position = playerObj.pos;\n\t\tstarsEmitter.emit(20);\n\t\tk.play(\"explosion1\", { volume: mainSoundVolume });\n\t\tclearGame();\n\t});\n\n\tplayerObj.onUpdate(() => {\n\t\tif (specialTimer < rocketSpecialCooldown) {\n\t\t\tspecialTimer += k.dt();\n\t\t\tupdateSpecialBar(specialTimer, rocketSpecialCooldown);\n\t\t}\n\n\t\tcheckProjectileIntersection(playerObj.pos, 12, tags.enemy, (p) => {\n\t\t\tk.destroy(p);\n\t\t\tif (p.tags.includes(tags.blaster)) {\n\t\t\t\tplayerObj.hurt(p.dmg);\n\t\t\t} else if (p.tags.includes(tags.rocket)) {\n\t\t\t\tplayerObj.hurt(p.impactDmg);\n\t\t\t\tcreateExplosion(\n\t\t\t\t\tp.pos,\n\t\t\t\t\tp.splashSize,\n\t\t\t\t\tp.splashDmg,\n\t\t\t\t\tp.splashDmgFallof,\n\t\t\t\t\tp.splashDmgFallofDist\n\t\t\t\t);\n\t\t\t\tk.play(randomExplosion(), { volume: mainSoundVolume });\n\t\t\t\tk.shake(3);\n\t\t\t}\n\t\t});\n\n\t\t// If rockets have a target for too long, find new target\n\t\tconst dist = playerObj.pos.dist(k.mousePos()) - 12;\n\t\tconst { dir, lerp } = lerpAngleBetweenPos(\n\t\t\tplayerObj.angle,\n\t\t\tplayerObj.pos,\n\t\t\tk.mousePos(),\n\t\t\t0.05,\n\t\t\t-90\n\t\t);\n\n\t\tconst maxSpeed =\n\t\t\tplayer.speed * player.speedMultiplier * player.speedPwrUpMultiplier;\n\t\tconst speed = k.clamp(dist * 4, 0, maxSpeed);\n\n\t\tplayerObj.angle = lerp;\n\n\t\tconst playerCurrentDir = k.Vec2.fromAngle(playerObj.angle + 90);\n\t\tconst emitterPos = k.vec2(\n\t\t\tplayerObj.pos.x + 12 * playerCurrentDir.x,\n\t\t\tplayerObj.pos.y + 12 * playerCurrentDir.y\n\t\t);\n\n\t\tif (speed > 4) {\n\t\t\ttrailEmitter.emitter.position = emitterPos;\n\t\t\ttrailEmitter.emitter.direction = k.Vec2.toAngle(dir);\n\t\t\ttrailEmitter.emit(1);\n\t\t}\n\n\t\tlerpMoveRotateAndScale(playerObj, lerp, speed);\n\t});\n\n\tplayerObj.onHurt(() => {\n\t\tk.play(\"hit2\", { volume: mainSoundVolume });\n\t\tplayerObj.animation.seek(0);\n\t\tk.shake(20);\n\t\tk.flash(k.RED, 0.4);\n\t\tupdatePlayerHealthBar(playerObj.hp());\n\t});\n\n\tplayerObj.onMousePress(\"left\", () => {\n\t\tif (hasLvlValue(player.blasterParallel, 1)) {\n\t\t\tfor (let i = 0; i < blasters; i++) {\n\t\t\t\tconst gunPipe = playerObj.children[i];\n\t\t\t\tshootBlaster(\n\t\t\t\t\tgunPipe.worldPos(),\n\t\t\t\t\tk.Vec2.fromAngle(playerObj.angle - 90),\n\t\t\t\t\tplayerObj.angle,\n\t\t\t\t\tplayer.blasterDmg * player.blasterDmgMultiplier,\n\t\t\t\t\tplayer.blasterSpeedMultiplier,\n\t\t\t\t\t[tags.friendly, tags.blaster],\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst gunPipe = playerObj.children[bulletIndex % blasters];\n\t\tshootBlaster(\n\t\t\tgunPipe.worldPos(),\n\t\t\tk.Vec2.fromAngle(playerObj.angle - 90),\n\t\t\tplayerObj.angle,\n\t\t\tplayer.blasterDmg * player.blasterDmgMultiplier,\n\t\t\tplayer.blasterSpeedMultiplier,\n\t\t\t[tags.friendly, tags.blaster],\n\t\t\ttrue\n\t\t);\n\t\tbulletIndex++;\n\t});\n\n\tplayerObj.onMousePress(\"right\", () => {\n\t\tif (player.rocketsLvl === undefined) return;\n\n\t\tif (specialTimer < rocketSpecialCooldown) {\n\t\t\treturn;\n\t\t}\n\n\t\tspecialTimer = 0;\n\t\tk.loop(\n\t\t\t0.1,\n\t\t\t() => {\n\t\t\t\tshootRocket(\n\t\t\t\t\tplayerObj.pos,\n\t\t\t\t\tk.Vec2.fromAngle(playerObj.angle - 90),\n\t\t\t\t\tplayerObj.angle,\n\t\t\t\t\tplayer.rocketImpactDmg * player.rocketDmgMultiplier,\n\t\t\t\t\tplayer.rocketSplashDmg * player.rocketDmgMultiplier,\n\t\t\t\t\tplayer.rocketSplashSize * player.rocketSplashSizeMultiplier,\n\t\t\t\t\tplayer.rocketSplashDmgFallDistanceValue,\n\t\t\t\t\tplayer.rocketSplashDmgFallOverDistance,\n\t\t\t\t\t1,\n\t\t\t\t\t[tags.friendly, tags.rocket],\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t},\n\t\t\tplayer.nrOfRockets + session.extraRockets\n\t\t);\n\t});\n\n\tplayerObj.onKeyDown(\"shift\", () => {\n\t\tif (player.canSprint === undefined) return;\n\t\tplayer.speedPwrUpMultiplier = 1.8 * player.sprintSpeedMultiplier;\n\t});\n\tplayerObj.onKeyRelease(\"shift\", () => {\n\t\tplayer.speedPwrUpMultiplier = 1;\n\t});\n\n\treturn playerObj;\n}\n\nexport function clearPlayer() {\n\tbulletIndex = 0;\n\tblasters = 0;\n}\n","import { Comp, GameObj, PosComp, Vec2 } from \"kaplay\";\nimport { k } from \"../main\";\nimport { pickUnitInDistance } from \"../game\";\n\nexport interface TargetComp extends Comp {\n\tlockedTarget: GameObj<PosComp> | null;\n\tpickTarget: (pos: Vec2, dist: number, tag: string) => boolean;\n\ttargetAngle: () => number;\n\thasTarget: () => boolean;\n}\n\nexport function target(): TargetComp {\n\treturn {\n\t\tlockedTarget: null,\n\t\tid: \"target\",\n\t\trequire: [\"pos\"],\n\n\t\tpickTarget(pos: Vec2, dist: number, tag: string) {\n\t\t\tif (this.lockedTarget) return true;\n\t\t\treturn pickUnitInDistance(pos, dist, tag, (u) => {\n\t\t\t\tthis.lockedTarget = u;\n\n\t\t\t\tthis.lockedTarget.onDestroy(() => {\n\t\t\t\t\tthis.lockedTarget = null;\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\thasTarget() {\n\t\t\treturn this.lockedTarget;\n\t\t},\n\t\ttargetAngle() {\n\t\t\tif (!this.lockedTarget) return this.angle;\n\n\t\t\treturn this.lockedTarget.pos.angle(this.pos);\n\t\t},\n\t};\n}\n","import { GameObj, PosComp, Vec2 } from \"kaplay\";\nimport {\n\tcheckProjectileIntersection,\n\tclearGame,\n\tcreateExplosion,\n\tplayerObj,\n} from \"../game\";\nimport { k, mainSoundVolume, subSoundVolume } from \"../main\";\nimport { debreeRocketEmitter, sparkEmitter, starsEmitter } from \"../particles\";\nimport {\n\tlerpAngleBetweenPos,\n\tlerpMoveRotateAndScale,\n\tregisterHitAnimation,\n} from \"../shared\";\nimport { tags } from \"../tags\";\nimport { randomExplosion } from \"../util\";\nimport { shootBlaster } from \"../projectiles/blaster\";\nimport { target } from \"../comp/target\";\nimport { shootRocket } from \"../projectiles/rocket\";\nimport { player } from \"../player\";\n\ninterface Props {\n\tpos: Vec2;\n\thp: number;\n\tblasterDmg: number;\n\tspeed: number;\n\tfollow: GameObj<PosComp>;\n}\n\nexport function spawnFollower(props: Props) {\n\tconst hb = 12;\n\tconst m = k.add([\n\t\tk.pos(props.pos),\n\t\tk.sprite(\"follower\"),\n\t\tk.rotate(0),\n\t\tk.anchor(\"center\"),\n\t\tk.scale(0.4),\n\t\tk.health(props.hp),\n\t\ttarget(),\n\t\tk.animate(),\n\t\tk.offscreen({ destroy: true }),\n\t\t{\n\t\t\tspeed: props.speed,\n\t\t\thb,\n\t\t\tdmg: props.blasterDmg,\n\t\t},\n\t\ttags.friendly,\n\t\ttags.unit,\n\t]);\n\n\tregisterHitAnimation(m);\n\n\tm.onUpdate(() => {\n\t\tconst { dir, lerp } = lerpAngleBetweenPos(\n\t\t\tm.angle,\n\t\t\tm.pos,\n\t\t\tprops.follow.pos,\n\t\t\t0.015,\n\t\t\t-90\n\t\t);\n\n\t\tlerpMoveRotateAndScale(m, lerp, m.speed);\n\n\t\tcheckProjectileIntersection(m.pos, m.hb, tags.enemy, (p) => {\n\t\t\tk.destroy(p);\n\n\t\t\tif (p.tags.includes(tags.blaster)) {\n\t\t\t\tm.hurt(p.dmg);\n\t\t\t}\n\t\t});\n\n\t\tif (player.followerCanUseMissiles && m.hasTarget()) {\n\t\t\tif (Math.floor(k.rand(0, 300)) == 1) {\n\t\t\t\tshootRocket(\n\t\t\t\t\tm.pos,\n\t\t\t\t\tk.Vec2.fromAngle(m.angle - 90),\n\t\t\t\t\tm.angle,\n\t\t\t\t\tplayer.rocketImpactDmg * player.rocketDmgMultiplier,\n\t\t\t\t\tplayer.rocketSplashDmg * player.rocketDmgMultiplier,\n\t\t\t\t\tplayer.rocketSplashSize * player.rocketSplashSizeMultiplier,\n\t\t\t\t\tplayer.rocketSplashDmgFallDistanceValue,\n\t\t\t\t\tplayer.rocketSplashDmgFallOverDistance,\n\t\t\t\t\t0.8,\n\t\t\t\t\t[tags.friendly, tags.rocket],\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (Math.floor(k.rand(0, 150)) == 1) {\n\t\t\tif (m.pickTarget(m.pos, 400, tags.enemy)) {\n\t\t\t\tshootBlaster(\n\t\t\t\t\tm.pos,\n\t\t\t\t\tk.Vec2.fromAngle(m.targetAngle()),\n\t\t\t\t\tm.targetAngle() + 90,\n\t\t\t\t\tm.dmg,\n\t\t\t\t\t2,\n\t\t\t\t\t[tags.friendly, tags.blaster],\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tm.onDeath(() => {\n\t\tstarsEmitter.emitter.position = m.pos;\n\t\tstarsEmitter.emit(20);\n\n\t\tk.play(randomExplosion(), { volume: subSoundVolume });\n\t\tk.destroy(m);\n\t});\n\n\tm.onHurt(() => {\n\t\tk.play(\"hit1\", { volume: mainSoundVolume });\n\t\tm.animation.seek(0);\n\t});\n}\n","import { playerObj } from \"../game\";\nimport { k, mainSoundVolume } from \"../main\";\nimport { starsEmitter } from \"../particles\";\nimport { player } from \"../player\";\nimport { PowerupKey, powerups, powerupsSprites } from \"../powerups\";\nimport { registerHitAnimation } from \"../shared\";\nimport { tags } from \"../tags\";\n\nexport function spawnPowerup(pos, powerupKey: PowerupKey) {\n\tconst m = k.add([\n\t\tk.pos(pos),\n\t\tk.sprite(powerupsSprites[powerupKey]),\n\t\tk.rotate(0),\n\t\tk.anchor(\"center\"),\n\t\tk.offscreen({ destroy: true }),\n\t\t{\n\t\t\tdir: k.rand(k.vec2(-1, -1), k.vec2(1, 1)),\n\t\t\tspeed: k.rand(40, 60),\n\t\t\tlifeSpan: 0,\n\t\t},\n\t\ttags.props,\n\t\ttags.unit,\n\t]);\n\n\tconst c = m.add([\n\t\tk.circle(16),\n\t\tk.scale(1),\n\t\tk.anchor(\"center\"),\n\t\tk.opacity(0.2),\n\t]);\n\n\tm.onUpdate(() => {\n\t\tif (m.lifeSpan < m.speed) {\n\t\t\tm.move(\n\t\t\t\tm.dir.x * (m.speed - m.lifeSpan),\n\t\t\t\tm.dir.y * (m.speed - m.lifeSpan)\n\t\t\t);\n\n\t\t\tm.lifeSpan += k.dt() * 45;\n\t\t}\n\n\t\tconst dist = m.pos.dist(playerObj.pos);\n\n\t\tif (\n\t\t\tdist <\n\t\t\tplayer.debreeSeekDistance * player.debreeSeekDistanceMultiplier\n\t\t) {\n\t\t\tm.moveTo(\n\t\t\t\tplayerObj.pos,\n\t\t\t\tplayer.debreeSeekSpeed * player.debreeSeekSpeedMultiplier\n\t\t\t);\n\n\t\t\tif (dist < player.debreePickupDistance) {\n\t\t\t\tstarsEmitter.emitter.position = m.pos;\n\t\t\t\tstarsEmitter.emit(20);\n\t\t\t\tk.play(\"powerup1\", { volume: mainSoundVolume });\n\t\t\t\tk.destroy(m);\n\t\t\t\tpowerups[powerupKey]();\n\t\t\t}\n\t\t}\n\t});\n}\n","import { Vec2 } from \"kaplay\";\nimport { addMaxHealth, playerObj } from \"./game\";\nimport { k } from \"./main\";\nimport { hasLvlValue, player, session } from \"./player\";\nimport { sum } from \"./shared\";\nimport { spawnFollower } from \"./spawn/spawnFollower\";\nimport { spawnPowerup } from \"./spawn/spawnPowerup\";\n\nexport const powerups = {\n\taddFollower: () => {\n\t\tspawnFollower({\n\t\t\tfollow: playerObj,\n\t\t\thp: 6,\n\t\t\tpos: k.vec2(k.rand(k.width()), 0),\n\t\t\tspeed: k.rand(80, 110),\n\t\t\tblasterDmg:\n\t\t\t\tplayer.followerBlasterDmg * player.followerBlasterDmgMultiplier,\n\t\t});\n\t},\n\taddPlayerMaxHealth: () => {\n\t\taddMaxHealth();\n\t},\n\taddExtraRockets: () => {\n\t\tsession.extraRockets += 1;\n\t},\n\taddSpaceDebree: () => {\n\t\tsession.extraSpaceDebreeInMissiles += 2;\n\t},\n} as const;\n\nexport type PowerupKey = keyof typeof powerups;\n\nexport const powerupsSprites: Record<PowerupKey, string> = {\n\taddFollower: \"follower_upg1\",\n\taddPlayerMaxHealth: \"hull_upg1\",\n\taddExtraRockets: \"more_missiles_upg1\",\n\taddSpaceDebree: \"missile_shards_upg1\",\n};\n\nexport const powerupWeights: Record<PowerupKey, number> = {\n\taddFollower: 350,\n\taddPlayerMaxHealth: 200,\n\taddExtraRockets: 120,\n\taddSpaceDebree: 110,\n};\n\nexport const powerupReq: Record<PowerupKey, (() => boolean) | undefined> = {\n\taddFollower: undefined,\n\taddPlayerMaxHealth: undefined,\n\taddExtraRockets: () => {\n\t\treturn player.rocketsLvl !== undefined;\n\t},\n\taddSpaceDebree: () => {\n\t\treturn player.rocketsLvl !== undefined;\n\t},\n};\n\nconst blankChance = 45000;\nfunction randomizePowerup(chanceMultiplier: number): PowerupKey | null {\n\tconst keyValues = Object.entries(powerupWeights).filter((x) => {\n\t\tif (powerupReq[x[0]] === undefined) return true;\n\n\t\treturn powerupReq[x[0]]();\n\t});\n\n\tconst chanceSpan =\n\t\tblankChance + sum(keyValues.map((x) => x[1] * chanceMultiplier));\n\n\tconst r = Math.floor(k.rand(0, chanceSpan));\n\n\tlet previous = 0;\n\tfor (let i = 0; i < keyValues.length; i++) {\n\t\tconst thisChance = previous + keyValues[i][1] * chanceMultiplier;\n\t\tif (r > previous && r <= thisChance) {\n\t\t\treturn keyValues[i][0] as PowerupKey;\n\t\t}\n\n\t\tprevious = thisChance;\n\t}\n\n\treturn null;\n}\n\nexport function trySpawnRandomizedPowerup(pos: Vec2, chanceMultiplier: number) {\n\tconst key = randomizePowerup(chanceMultiplier);\n\n\tif (!key) {\n\t\treturn;\n\t}\n\n\tspawnPowerup(pos, key);\n}\n\nexport function chance(c: number, max: number) {\n\treturn Math.floor(k.rand(0, max)) <= c;\n}\n","import { Vec2 } from \"kaplay\";\nimport { chance } from \"../powerups\";\nimport { spawnFlash } from \"../spawn/spawnFlash\";\nimport { k, mainSoundVolume } from \"../main\";\n\nexport function getDmg(\n\tcritChance: number,\n\tdmg: number,\n\tcritMultiplier: number,\n\tpos: Vec2\n) {\n\tif (chance(critChance, 100)) {\n\t\tspawnFlash(pos, critMultiplier);\n\n\t\tk.play(\"hit1\", { volume: mainSoundVolume });\n\t\treturn dmg * critMultiplier;\n\t}\n\n\treturn dmg;\n}\n","import { debrees } from \"../game\";\nimport { k } from \"../main\";\nimport { tags } from \"../tags\";\n\nexport function spawnDebree(pos, am) {\n\tfor (let i = 0; i < am; i++) {\n\t\tconst d = k.add([\n\t\t\tk.pos(pos),\n\t\t\tk.sprite(\"particle2\"),\n\t\t\tk.animate({ relative: true }),\n\t\t\tk.rotate(k.rand(360)),\n\t\t\tk.opacity(1),\n\t\t\t{\n\t\t\t\tdir: k.rand(k.vec2(-1, -1), k.vec2(1, 1)),\n\t\t\t\tspeed: k.rand(40, 60),\n\t\t\t\tlifeSpan: 0,\n\t\t\t},\n\t\t\ttags.debree,\n\t\t]);\n\n\t\td.onUpdate(() => {\n\t\t\tif (d.lifeSpan > d.speed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\td.move(\n\t\t\t\td.dir.x * (d.speed - d.lifeSpan),\n\t\t\t\td.dir.y * (d.speed - d.lifeSpan)\n\t\t\t);\n\n\t\t\td.lifeSpan += k.dt() * 45;\n\t\t});\n\n\t\td.animate(\"opacity\", [1, 0.5], {\n\t\t\tduration: 1,\n\t\t});\n\n\t\tdebrees.push(d);\n\t}\n}\n","import { GameObj, Vec2 } from \"kaplay\";\nimport { createExplosion } from \"../game\";\nimport { k } from \"../main\";\nimport { debreeRocketEmitter, starsEmitter } from \"../particles\";\nimport { player } from \"../player\";\nimport { getDmg } from \"../projectiles/shared\";\nimport { tags } from \"../tags\";\nimport { spawnDebree } from \"./spawnDebree\";\nimport { trySpawnRandomizedPowerup } from \"../powerups\";\n\nexport function onEnemyHit(m: GameObj, p: GameObj) {\n\tif (p.tags.includes(tags.blaster)) {\n\t\tconst dmg = getDmg(player.critChance, p.dmg, player.critMultiplier, p.pos);\n\t\tm.hurt(dmg);\n\t} else if (p.tags.includes(tags.rocket)) {\n\t\tconst dmg = getDmg(\n\t\t\tplayer.critChance,\n\t\t\tp.impactDmg,\n\t\t\tplayer.critMultiplier,\n\t\t\tm.pos\n\t\t);\n\t\tm.hurt(dmg);\n\t\tcreateExplosion(\n\t\t\tp.pos,\n\t\t\tp.splashSize,\n\t\t\tp.splashDmg,\n\t\t\tp.splashDmgFallof,\n\t\t\tp.splashDmgFallofDist\n\t\t);\n\t\tk.shake(3);\n\t\tdebreeRocketEmitter.emitter.position = m.pos;\n\t\tdebreeRocketEmitter.emitter.direction = p.angle - 90;\n\t\tdebreeRocketEmitter.emit(6);\n\t}\n}\n\nexport function enemyOnDeath(\n\tpos: Vec2,\n\tscore: number,\n\tpowerupMultiplier: number\n) {\n\tstarsEmitter.emitter.position = pos;\n\tstarsEmitter.emit(20);\n\tspawnDebree(pos, score);\n\ttrySpawnRandomizedPowerup(pos, powerupMultiplier);\n}\n","import { checkProjectileIntersection, playerObj } from \"../game\";\nimport { k, mainSoundVolume, subSoundVolume } from \"../main\";\nimport { shootBlaster } from \"../projectiles/blaster\";\nimport {\n\tlerpAngleBetweenPos,\n\tlerpMoveRotateAndScale,\n\tregisterHitAnimation,\n} from \"../shared\";\nimport { tags } from \"../tags\";\nimport { randomExplosion } from \"../util\";\nimport { enemyOnDeath, onEnemyHit } from \"./enemyShared\";\n\nexport function spawnAssasin(pos, am, hp, scale) {\n\tconst hb = 12 * scale;\n\tconst m = k.add([\n\t\tk.pos(pos),\n\t\tk.sprite(\"enemy_ship1\"),\n\t\tk.rotate(0),\n\t\tk.anchor(\"center\"),\n\t\tk.health(hp),\n\t\tk.animate(),\n\t\tk.scale(scale),\n\t\tk.offscreen({ destroy: true }),\n\t\t{\n\t\t\tspeed: k.rand(100, 130),\n\t\t\thb,\n\t\t\ttargetPos: k.rand(k.vec2(k.width(), k.height())),\n\t\t},\n\t\tk.state(\"retreat\", [\"attack\", \"retreat\"]),\n\t\ttags.enemy,\n\t\ttags.unit,\n\t]);\n\n\tm.onStateEnter(\"retreat\", async () => {\n\t\tconst pos = k.rand(k.vec2(k.width(), k.height()));\n\t\tm.targetPos = pos;\n\t\tawait k.wait(2);\n\t\tm.enterState(\"attack\");\n\t});\n\n\tm.onStateEnter(\"attack\", async () => {\n\t\tawait k.wait(3);\n\t\tm.enterState(\"retreat\");\n\t});\n\n\tm.onStateUpdate(\"attack\", () => {\n\t\tconst pos = playerObj.pos;\n\t\tm.targetPos = pos;\n\n\t\tconst dist = m.pos.dist(m.targetPos);\n\n\t\tif (dist < 50) {\n\t\t\tm.enterState(\"retreat\");\n\t\t} else if (dist > 50 && dist < 200) {\n\t\t\tif (Math.floor(k.rand(0, 200)) == 1) {\n\t\t\t\tshootBlaster(\n\t\t\t\t\tm.pos,\n\t\t\t\t\tk.Vec2.fromAngle(m.angle - 90),\n\t\t\t\t\tm.angle,\n\t\t\t\t\t2,\n\t\t\t\t\t1,\n\t\t\t\t\t[tags.enemy, tags.blaster],\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tregisterHitAnimation(m);\n\n\tm.onUpdate(() => {\n\t\tconst { lerp } = lerpAngleBetweenPos(\n\t\t\tm.angle,\n\t\t\tm.pos,\n\t\t\tm.targetPos,\n\t\t\t0.01,\n\t\t\t-90\n\t\t);\n\n\t\tlerpMoveRotateAndScale(m, lerp, m.speed);\n\n\t\tcheckProjectileIntersection(m.pos, m.hb, tags.friendly, (p) => {\n\t\t\tk.destroy(p);\n\n\t\t\tonEnemyHit(m, p);\n\t\t});\n\t});\n\n\tm.onDeath(() => {\n\t\tk.play(randomExplosion(), { volume: subSoundVolume });\n\t\tenemyOnDeath(m.pos, am, 1);\n\t\tk.destroy(m);\n\t});\n\n\tm.onHurt(() => {\n\t\tk.play(\"hit1\", { volume: mainSoundVolume });\n\t\tm.animation.seek(0);\n\t});\n}\n","import { Vec2 } from \"kaplay\";\nimport { checkProjectileIntersection, playerObj } from \"../game\";\nimport { k, mainSoundVolume, subSoundVolume } from \"../main\";\nimport { registerHitAnimation } from \"../shared\";\nimport { tags } from \"../tags\";\nimport { randomExplosion } from \"../util\";\nimport { enemyOnDeath, onEnemyHit } from \"./enemyShared\";\n\ninterface Props {\n\tpos: Vec2;\n\tdir: Vec2;\n\tscoreOnKill: number;\n\thp: number;\n\tspeed: number;\n\tsplitOnDeath: number;\n}\n\nexport function spawnMeteorite(props: Props) {\n\tconst initScale = k.rand(1, 2);\n\tconst hb = 12 * initScale;\n\tconst m = k.add([\n\t\tk.pos(props.pos),\n\t\tk.sprite(\"asteroid1\"),\n\t\tk.rotate(0),\n\t\tk.anchor(\"center\"),\n\t\tk.scale(k.rand(1, 2)),\n\t\tk.health(props.hp),\n\t\tk.animate(),\n\t\tk.offscreen({ destroy: true }),\n\t\t{\n\t\t\tvel: props.dir,\n\t\t\trotVel: k.rand(-4, 4),\n\t\t\tspeed: props.speed,\n\t\t\tinitScale,\n\t\t\thb,\n\t\t},\n\t\ttags.enemy,\n\t\ttags.unit,\n\t]);\n\n\tregisterHitAnimation(m);\n\n\tm.onUpdate(() => {\n\t\tm.move(m.vel.scale(m.speed));\n\t\tm.angle += m.rotVel;\n\n\t\tcheckProjectileIntersection(m.pos, m.hb, tags.friendly, (p) => {\n\t\t\tk.destroy(p);\n\n\t\t\tonEnemyHit(m, p);\n\t\t});\n\n\t\tif (playerObj.pos.dist(m.pos) < m.hb) {\n\t\t\tplayerObj.hurt(1);\n\t\t\tm.hurt(props.hp);\n\t\t}\n\t});\n\n\tm.onDeath(() => {\n\t\tenemyOnDeath(m.pos, props.scoreOnKill, 1);\n\t\tk.play(randomExplosion(), { volume: subSoundVolume });\n\t\tk.destroy(m);\n\n\t\tif (props.splitOnDeath) {\n\t\t\tfor (let i = 0; i < props.splitOnDeath; i++) {\n\t\t\t\tspawnMeteorite({\n\t\t\t\t\tpos: m.pos,\n\t\t\t\t\tdir: k.rand(k.vec2(-1, -1), k.vec2(1, 1)),\n\t\t\t\t\tscoreOnKill: props.scoreOnKill / 2,\n\t\t\t\t\thp: props.hp / 2,\n\t\t\t\t\tspeed: props.speed * 2,\n\t\t\t\t\tsplitOnDeath: 0,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tm.onHurt(() => {\n\t\tm.animation.seek(0);\n\t});\n}\n","import { GameObj, Vec2 } from \"kaplay\";\nimport {\n\tcheckProjectileIntersection,\n\tcreateExplosion,\n\tplayerObj,\n} from \"../game\";\nimport { k, mainSoundVolume, subSoundVolume } from \"../main\";\nimport { starsEmitterDir } from \"../particles\";\nimport { tags } from \"../tags\";\nimport { randomExplosion } from \"../util\";\nimport { spawnDebree } from \"./spawnDebree\";\nimport { registerHitAnimation } from \"../shared\";\nimport { onEnemyHit } from \"./enemyShared\";\n\nexport function spawnGenericVehicle(\n\taddTo: GameObj<{ killed: number }>,\n\tpos: Vec2,\n\tdir: Vec2,\n\thp,\n\tsprite\n) {\n\tconst hb = 12;\n\tconst m = k.add([\n\t\tk.pos(pos),\n\t\tk.sprite(sprite),\n\t\tk.rotate(dir.angle() - 90),\n\t\tk.anchor(\"center\"),\n\t\tk.health(hp),\n\t\tk.animate(),\n\t\tk.offscreen({ destroy: true }),\n\t\t{\n\t\t\tvel: dir,\n\t\t\tspeed: k.rand(300, 340),\n\t\t\thb,\n\t\t},\n\t\ttags.enemy,\n\t\ttags.unit,\n\t]);\n\n\tregisterHitAnimation(m);\n\n\tm.onUpdate(() => {\n\t\tm.move(m.vel.scale(m.speed));\n\n\t\tcheckProjectileIntersection(m.pos, m.hb, tags.friendly, (p) => {\n\t\t\tk.destroy(p);\n\n\t\t\tonEnemyHit(m, p);\n\t\t});\n\n\t\tif (playerObj.pos.dist(m.pos) < m.hb) {\n\t\t\tplayerObj.hurt(1);\n\t\t\tm.hurt(hp);\n\t\t}\n\t});\n\n\tm.onDeath(() => {\n\t\tstarsEmitterDir.emitter.position = m.pos;\n\t\tstarsEmitterDir.emitter.direction = m.angle + 90;\n\n\t\tstarsEmitterDir.emit(20);\n\t\tk.play(randomExplosion(), { volume: subSoundVolume });\n\t\tk.destroy(m);\n\n\t\taddTo.killed += 1;\n\t});\n\n\tm.onHurt(() => {\n\t\tk.play(\"hit1\", { volume: mainSoundVolume });\n\t\tm.animation.seek(0);\n\t});\n}\n","import { Vec2 } from \"kaplay\";\nimport { k, timeSeconds } from \"../main\";\nimport { tags } from \"../tags\";\nimport { spawnGenericVehicle } from \"./spawnGenericVehicle\";\n\ninterface Props {\n\tspawnChance: number;\n\tstartPos: Vec2;\n\tendPos: Vec2;\n\tdestroyAfterKills: number;\n}\n\nexport function spawnHighway(props: Props) {\n\tconst m = k.add([\n\t\tk.animate(),\n\t\t{\n\t\t\tstartPos: props.startPos,\n\t\t\tendPos: props.endPos,\n\t\t\topacity: 0.15,\n\t\t\tkilled: 0,\n\t\t},\n\t\ttags.enemy,\n\t]);\n\n\tm.onUpdate(() => {\n\t\tif (Math.floor(k.rand(0, props.spawnChance)) == 1) {\n\t\t\tconst offset = smallOffset(6);\n\t\t\tspawnGenericVehicle(\n\t\t\t\tm,\n\t\t\t\tm.startPos.add(offset),\n\t\t\t\tm.endPos.add(offset).sub(m.startPos).unit(),\n\t\t\t\t4,\n\t\t\t\trandomVehicle()\n\t\t\t);\n\t\t}\n\n\t\tm.opacity = k.wave(0.1, 0.2, k.time());\n\n\t\tif (m.killed >= props.destroyAfterKills) {\n\t\t\tm.destroy();\n\t\t}\n\t});\n\n\tm.onDraw(() => {\n\t\tk.drawLines({\n\t\t\tpts: [m.startPos, m.endPos],\n\t\t\twidth: 40,\n\t\t\topacity: m.opacity,\n\t\t});\n\t});\n}\n\nconst sprites = [\"enemy_ship1\", \"bike1\"];\nfunction randomVehicle() {\n\treturn sprites[Math.floor(k.rand(0, sprites.length))];\n}\n\nfunction smallOffset(offset) {\n\treturn k.rand(k.vec2(-offset, -offset), k.vec2(offset, offset));\n}\n","import {\n\tAnimateComp,\n\tGameObj,\n\tHealthComp,\n\tPosComp,\n\tSpriteComp,\n\tVec2,\n} from \"kaplay\";\nimport { k, mainSoundVolume } from \"./main\";\nimport { registerHitAnimation } from \"./shared\";\nimport { starsEmitter } from \"./particles\";\nimport { spawnDebree } from \"./spawn/spawnDebree\";\nimport { randomExplosion } from \"./util\";\nimport { unitComponents } from \"./spawn/spawnShip1\";\nimport { JitterComp } from \"./comp/jitter\";\nimport { enemyOnDeath } from \"./spawn/enemyShared\";\n\ninterface Part {\n\tobj: GameObj<HealthComp | AnimateComp | PosComp | SpriteComp | JitterComp>;\n\thitbox: number;\n\tisBody: boolean;\n\tscoreOnDestroy: number;\n}\n\ninterface Compose {\n\tparts: Part[];\n}\n\nexport interface Component {\n\tobj: GameObj<HealthComp | JitterComp>;\n\tlocalPos: Vec2;\n\thitbox: number;\n\tisBody: boolean;\n}\n\nexport function compose(c: Compose): Component[] {\n\tconst composed: Component[] = [];\n\tconst body = c.parts.find((x) => x.isBody);\n\n\tfor (let i = 0; i < c.parts.length; i++) {\n\t\tconst part = c.parts[i];\n\t\tregisterHitAnimation(part.obj);\n\n\t\tpart.obj.onHurt(() => {\n\t\t\tk.play(\"hit1\", { volume: mainSoundVolume });\n\t\t\tc.parts[i].obj.animation.seek(0);\n\t\t});\n\n\t\tpart.obj.onDeath(() => {\n\t\t\tconst pos = part.isBody ? part.obj.pos : body!.obj.pos.sub(part.obj.pos);\n\n\t\t\tspawnDebree(pos, part.scoreOnDestroy);\n\t\t\tk.play(randomExplosion(), { volume: mainSoundVolume });\n\n\t\t\tif (part.isBody) {\n\t\t\t\tdelete unitComponents[part.obj.id!];\n\t\t\t\tk.destroy(part.obj);\n\t\t\t\tenemyOnDeath(part.obj.pos, 10, 1);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpart.obj.hidden = true;\n\t\t\tpart.obj.paused = true;\n\t\t\tstarsEmitter.emitter.position = pos;\n\t\t\tstarsEmitter.emit(20);\n\t\t\tdetach(pos, part.obj.sprite, k.rand(40, 80));\n\t\t\tbody!.obj.jitter(20);\n\t\t});\n\n\t\tcomposed.push({\n\t\t\tobj: part.obj,\n\t\t\tlocalPos: part.isBody ? k.vec2(0, 0) : part.obj.pos,\n\t\t\thitbox: part.hitbox,\n\t\t\tisBody: part.isBody,\n\t\t});\n\t}\n\n\treturn composed;\n}\n\nexport function detach(pos: Vec2, sprite: string, force: number) {\n\tconst p = k.add([\n\t\tk.pos(pos),\n\t\tk.sprite(sprite),\n\t\tk.lifespan(2, {\n\t\t\tfade: 0.2,\n\t\t}),\n\t\tk.offscreen({ destroy: true }),\n\t\tk.opacity(1),\n\t\tk.scale(1),\n\t\tk.rotate(k.rand(0, 360)),\n\t\tk.move(k.rand(k.vec2(-1, -1), k.vec2(1, 1)), force),\n\t\t{\n\t\t\tspin: k.rand(2, 8),\n\t\t},\n\t]);\n\n\tp.onUpdate(() => {\n\t\tconst v = k.wave(-1, 1, k.time() * p.spin);\n\t\tp.scale = k.vec2(v, v);\n\t});\n}\n","import { Comp } from \"kaplay\";\nimport { k } from \"../main\";\n\nexport interface JitterComp extends Comp {\n\tjitterValue: number;\n\tjitter: (value: number) => void;\n}\n\nexport function jitter(): JitterComp {\n\treturn {\n\t\tjitterValue: 0,\n\t\tid: \"jitter\",\n\t\trequire: [\"pos\"],\n\t\tupdate() {\n\t\t\tif (this.jitterValue > 0) {\n\t\t\t\tconst strength = this.jitterValue * 8;\n\t\t\t\tvar toJitter = k.rand(\n\t\t\t\t\tk.vec2(-strength, -strength),\n\t\t\t\t\tk.vec2(strength, strength)\n\t\t\t\t);\n\t\t\t\tthis.move(toJitter);\n\t\t\t\tthis.jitterValue -= k.dt() * 100;\n\t\t\t}\n\t\t},\n\t\tjitter(value: number) {\n\t\t\tthis.jitterValue = value;\n\t\t},\n\t};\n}\n","import { Vec2 } from \"kaplay\";\nimport { checkProjectileComponentIntersection } from \"../game\";\nimport { k } from \"../main\";\nimport { trailEmitter } from \"../particles\";\nimport { shootBlaster } from \"../projectiles/blaster\";\nimport { tags } from \"../tags\";\n\nconst components = {\n\tbody: 1,\n\tleftWing: 2,\n\trightWing: 3,\n\tblaster: 4,\n};\nimport { Component, compose } from \"../compose\";\nimport { jitter } from \"../comp/jitter\";\nimport { onEnemyHit } from \"./enemyShared\";\n\nconst wingOffset = [6, 2];\nexport const unitComponents: Record<number, Component[]> = {};\n\nexport function spawnShip1(pos, dir: Vec2, am, hp, scale, speed) {\n\tconst hb = 16 * scale;\n\tconst m = k.add([\n\t\tk.pos(pos),\n\t\tk.sprite(\"enemy_ship1_body\"),\n\t\tk.rotate(dir.angle() + 90),\n\t\tk.anchor(\"center\"),\n\t\tk.health(hp),\n\t\tk.animate(),\n\t\tk.scale(scale),\n\t\tjitter(),\n\t\tk.offscreen({ destroy: true }),\n\t\t{\n\t\t\tvel: dir,\n\t\t\tspeed: speed,\n\t\t\thb,\n\t\t},\n\t\ttags.enemy,\n\t\ttags.unit,\n\t]);\n\n\tconst wing1 = m.add([\n\t\tk.pos(k.vec2(-wingOffset[0], -wingOffset[1])),\n\t\tk.sprite(\"enemy_ship1_left_wing\"),\n\t\tk.anchor(\"center\"),\n\t\tk.health(Math.floor(hp / 2)),\n\t\tk.animate(),\n\t\tjitter(),\n\t\ttags.part,\n\t]);\n\tconst wing2 = m.add([\n\t\tk.pos(k.vec2(wingOffset[0], -wingOffset[1])),\n\t\tk.sprite(\"enemy_ship1_right_wing\"),\n\t\tk.anchor(\"center\"),\n\t\tk.health(Math.floor(hp / 2)),\n\t\tk.animate(),\n\t\tjitter(),\n\t\ttags.part,\n\t]);\n\n\tunitComponents[m.id!] = compose({\n\t\tparts: [\n\t\t\t{ obj: m, hitbox: 8, isBody: true, scoreOnDestroy: am },\n\t\t\t{ obj: wing1, hitbox: 8, isBody: false, scoreOnDestroy: 0 },\n\t\t\t{ obj: wing2, hitbox: 8, isBody: false, scoreOnDestroy: 0 },\n\t\t],\n\t});\n\n\tm.onUpdate(() => {\n\t\tm.move(m.vel.scale(m.speed));\n\n\t\tcheckProjectileComponentIntersection(\n\t\t\tm.pos,\n\t\t\tm.hb,\n\t\t\ttags.friendly,\n\t\t\tunitComponents[m.id!],\n\t\t\t(p, i) => {\n\t\t\t\tk.destroy(p);\n\n\t\t\t\tonEnemyHit(unitComponents[m.id!][i].obj, p);\n\t\t\t}\n\t\t);\n\n\t\tif (Math.floor(k.rand(0, 500)) == 10) {\n\t\t\tshootBlaster(\n\t\t\t\tm.pos,\n\t\t\t\tk.Vec2.fromAngle(m.angle - 90),\n\t\t\t\tm.angle,\n\t\t\t\t1,\n\t\t\t\t1,\n\t\t\t\t[tags.enemy, tags.blaster],\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tconst dir = k.Vec2.fromAngle(m.angle - 90);\n\t\tconst emitterPos = k.vec2(m.pos.x - 12 * dir.x, m.pos.y - 12 * dir.y);\n\t\ttrailEmitter.emitter.position = emitterPos;\n\t\ttrailEmitter.emitter.direction = k.Vec2.toAngle(dir);\n\t\ttrailEmitter.emit(1);\n\t});\n}\n","export function loadSongData(title: string, author: string, albumSrc: string) {\n\tconst container = document.getElementById(\"song\");\n\n\tconst titleEl = document.getElementById(\"song_title\");\n\tconst authorEl = document.getElementById(\"song_author\");\n\tconst coverEl = document.getElementById(\"song_cover\");\n\n\tauthorEl!.textContent = author;\n\ttitleEl!.textContent = title;\n\tcoverEl!.setAttribute(\"src\", albumSrc);\n\n\tcontainer?.classList.add(\"show\");\n}\n\nexport function endSong() {\n\tconst container = document.getElementById(\"song\");\n\n\tcontainer?.classList.remove(\"show\");\n}\n","import { Vec2 } from \"kaplay\";\nimport { checkProjectileIntersection, playerObj } from \"../game\";\nimport { k, mainSoundVolume } from \"../main\";\nimport { registerHitAnimation } from \"../shared\";\nimport { tags } from \"../tags\";\nimport { enemyOnDeath, onEnemyHit } from \"./enemyShared\";\n\ninterface Props {\n\tpos: Vec2;\n\tam: number;\n\thp: number;\n\tpowerupMultiplier: number;\n}\n\nexport function spawnCrate(props: Props) {\n\tconst m = k.add([\n\t\tk.pos(props.pos),\n\t\tk.sprite(\"crate1\"),\n\t\tk.rotate(0),\n\t\tk.anchor(\"center\"),\n\t\tk.health(props.hp),\n\t\tk.animate(),\n\t\tk.offscreen({ destroy: true }),\n\t\t{\n\t\t\tvel: k.Vec2.fromAngle(k.rand(0, 360)),\n\t\t\trotVel: k.rand(-4, 4),\n\t\t\tspeed: k.rand(20, 60),\n\t\t\thitAngle: 0,\n\t\t},\n\t\ttags.enemy,\n\t\ttags.unit,\n\t]);\n\n\tregisterHitAnimation(m);\n\n\tm.onUpdate(() => {\n\t\tm.move(m.vel.scale(m.speed));\n\t\tm.angle += m.rotVel;\n\n\t\tcheckProjectileIntersection(m.pos, 12, tags.friendly, (p) => {\n\t\t\tk.destroy(p);\n\n\t\t\tm.hitAngle = p.angle;\n\t\t\tonEnemyHit(m, p);\n\t\t});\n\n\t\tif (playerObj.pos.dist(m.pos) < 16) {\n\t\t\tm.hurt(props.hp);\n\t\t}\n\t});\n\n\tm.onDeath(() => {\n\t\tenemyOnDeath(m.pos, props.am, props.powerupMultiplier);\n\t\tk.play(\"explosion4\", { volume: mainSoundVolume });\n\t\tk.destroy(m);\n\t});\n\n\tm.onHurt(() => {\n\t\tk.play(\"hit2\", { volume: mainSoundVolume });\n\t\tm.animation.seek(0);\n\t});\n}\n","import { Vec2 } from \"kaplay\";\nimport { k } from \"../main\";\nimport { tags } from \"../tags\";\n\ninterface Props {\n\tspawnChance: number;\n\tpos: Vec2;\n\tmaxSpawns: number;\n\tonSpawn: (pos: Vec2) => void;\n}\n\nexport function spawnSpawner(props: Props) {\n\tconst m = k.add([\n\t\tk.pos(props.pos),\n\t\tk.anchor(\"center\"),\n\t\tk.circle(12),\n\t\tk.animate(),\n\t\t{\n\t\t\topacity: 0.15,\n\t\t\tspawned: 0,\n\t\t\tmaxSpawn: props.maxSpawns,\n\t\t},\n\t\ttags.enemy,\n\t]);\n\n\tm.onUpdate(() => {\n\t\tif (Math.floor(k.rand(0, props.spawnChance)) == 1) {\n\t\t\tprops.onSpawn(m.pos);\n\t\t\tm.spawned++;\n\t\t}\n\n\t\tif (m.spawned >= m.maxSpawn) {\n\t\t\tm.destroy();\n\t\t}\n\n\t\tm.opacity = k.wave(0.03, 0.4, k.time() * 3);\n\t});\n}\n","import { AudioPlay, MusicData } from \"kaplay\";\nimport { playerObj } from \"../game\";\nimport { getPosAtBorder, k, layers, musicVolume } from \"../main\";\nimport { spawnAssasin } from \"../spawn/spawnAssasin\";\nimport { spawnMeteorite } from \"../spawn/spawnAsteroid\";\nimport { spawnHighway } from \"../spawn/spawnHighway\";\nimport { spawnShip1 } from \"../spawn/spawnShip1\";\nimport { tags } from \"../tags\";\nimport { Level } from \"../wave\";\nimport { endSong, loadSongData } from \"../web\";\nimport { spawnCrate } from \"../spawn/spawnCrate\";\nimport { spawnSpawner } from \"../spawn/spawnSpawner\";\n\nlet lvlData: any = {};\nlet timer = 0;\nlet spawned = 0;\nlet toSpawn = 0;\nlet song: AudioPlay;\nexport const level1: Level = {\n\tmusic: \"arcadia\",\n\tsongTitle: \"Arcadia\",\n\tsongAuthor: \"Dunderpatrullen\",\n\tsongAlbumCover: \"/covers/arcadia_cover.jpg\",\n\tbpm: 0.44,\n\ttitle: \"\",\n\tintroduceSound: \"\",\n\tlevelLengthSeconds: 190,\n\treset: () => {\n\t\tlvlData = {};\n\t\tsong.stop();\n\t\tendSong();\n\t},\n\tlvlUpd: () => {},\n\twaves: [\n\t\t{\n\t\t\ttimeStamp: 0,\n\t\t\tbegin: () => {\n\t\t\t\tsong = k.play(level1.music, { volume: musicVolume });\n\t\t\t},\n\t\t\tupd: () => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 3500,\n\t\t\tbegin: () => {\n\t\t\t\tloadSongData(\n\t\t\t\t\tlevel1.songTitle,\n\t\t\t\t\tlevel1.songAuthor,\n\t\t\t\t\tlevel1.songAlbumCover\n\t\t\t\t);\n\t\t\t},\n\t\t\tupd: () => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 4500,\n\t\t\tbegin: (ld) => {\n\t\t\t\tvar txt = k.add([\n\t\t\t\t\tk.pos(k.center()),\n\t\t\t\t\tk.anchor(\"center\"),\n\t\t\t\t\tk.animate(),\n\t\t\t\t\tk.text(\"...INIT SPACEJUMP...\", { font: \"\", size: 42 }),\n\t\t\t\t\ttags.gameLoopUi,\n\t\t\t\t]);\n\n\t\t\t\ttxt.animate(\"opacity\", [1, 0], {\n\t\t\t\t\tloops: 5,\n\t\t\t\t\tduration: 0.7,\n\t\t\t\t});\n\n\t\t\t\tlvlData[\"txt\"] = txt;\n\t\t\t},\n\t\t\tupd: () => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 4550,\n\t\t\tduration: 3550,\n\t\t\tbegin: () => {\n\t\t\t\tlvlData[\"lines\"] = [];\n\t\t\t},\n\t\t\tupd: (ld) => {\n\t\t\t\tvar randomPos = k.rand(k.vec2(k.width(), k.height()));\n\n\t\t\t\tvar line = k.add([\n\t\t\t\t\tk.pos(randomPos),\n\t\t\t\t\tk.rect(2, 4 * (ld / 100)),\n\t\t\t\t\tk.color(k.WHITE),\n\t\t\t\t\t\"dust\",\n\t\t\t\t]);\n\n\t\t\t\tlvlData[\"lines\"].push(line);\n\n\t\t\t\tfor (let i = 0; i < lvlData[\"lines\"].length; i++) {\n\t\t\t\t\tlvlData[\"lines\"][i].move(0, -10 * (ld / 50));\n\t\t\t\t}\n\n\t\t\t\tif (ld > 2000) {\n\t\t\t\t\tk.shake(0.01 * (ld / 100));\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 8120,\n\t\t\tbegin: () => {\n\t\t\t\tk.destroyAll(\"dust\");\n\t\t\t\tk.flash(k.WHITE, 1);\n\t\t\t\tk.destroy(lvlData[\"txt\"]);\n\t\t\t\tdelete lvlData[\"lines\"];\n\t\t\t\tconst spawn = 40;\n\n\t\t\t\tfor (let i = 0; i < spawn; i++) {\n\t\t\t\t\tvar randomPos = k.rand(k.vec2(k.width(), k.height()));\n\n\t\t\t\t\tif (playerObj.pos.dist(randomPos) < 200) continue;\n\t\t\t\t\tspawnMeteorite({\n\t\t\t\t\t\tpos: randomPos,\n\t\t\t\t\t\tdir: k.DOWN,\n\t\t\t\t\t\tscoreOnKill: 1,\n\t\t\t\t\t\thp: 4,\n\t\t\t\t\t\tspeed: k.rand(20, 40),\n\t\t\t\t\t\tsplitOnDeath: 2,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tfor (let i = 0; i < spawn / 10; i++) {\n\t\t\t\t\tvar randomPos = k.rand(k.vec2(k.width(), k.height()));\n\n\t\t\t\t\tif (playerObj.pos.dist(randomPos) < 200) continue;\n\t\t\t\t\tspawnCrate({\n\t\t\t\t\t\tpos: randomPos,\n\t\t\t\t\t\tam: 1,\n\t\t\t\t\t\thp: 3,\n\t\t\t\t\t\tpowerupMultiplier: 3,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tk.add([\n\t\t\t\t\tk.pos(100),\n\t\t\t\t\tk.color(k.rgb(50, 50, 50)),\n\t\t\t\t\tk.sprite(\"bg_moon1\"),\n\t\t\t\t\tk.scale(2),\n\t\t\t\t\tk.layer(layers.bg),\n\t\t\t\t\ttags.levelBg,\n\t\t\t\t]);\n\n\t\t\t\tk.add([\n\t\t\t\t\tk.pos(100, 400),\n\t\t\t\t\tk.color(k.rgb(50, 50, 50)),\n\t\t\t\t\tk.sprite(\"bg_building1\"),\n\t\t\t\t\tk.scale(2),\n\t\t\t\t\tk.layer(layers.bg),\n\t\t\t\t\ttags.levelBg,\n\t\t\t\t]);\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 16000,\n\t\t\tbegin: () => {\n\t\t\t\tvar txt = k.add([\n\t\t\t\t\tk.pos(k.center()),\n\t\t\t\t\tk.anchor(\"center\"),\n\t\t\t\t\tk.animate(),\n\t\t\t\t\tk.text(\"!!THREAT DETECTED!!\", { font: \"\", size: 42 }),\n\t\t\t\t\ttags.gameLoopUi,\n\t\t\t\t]);\n\n\t\t\t\ttxt.animate(\"opacity\", [1, 0], {\n\t\t\t\t\tloops: 10,\n\t\t\t\t\tduration: level1.bpm,\n\t\t\t\t});\n\n\t\t\t\tlvlData[\"txt\"] = txt;\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 21000,\n\t\t\tbegin: () => {\n\t\t\t\tk.destroy(lvlData[\"txt\"]);\n\t\t\t\tconst max = 6;\n\n\t\t\t\tfor (let i = 0; i < max; i++) {\n\t\t\t\t\tconst pos = getPosAtBorder(0.25 * (i / max));\n\n\t\t\t\t\tspawnShip1(pos, k.DOWN, 2, 7, 1, k.rand(40, 60));\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 18790,\n\t\t\tbegin: () => {\n\t\t\t\tk.flash(k.WHITE, level1.bpm);\n\t\t\t\tconst max = 12;\n\n\t\t\t\tfor (let i = 0; i < max; i++) {\n\t\t\t\t\tconst pos = getPosAtBorder(1 * (i / max));\n\n\t\t\t\t\tspawnShip1(\n\t\t\t\t\t\tpos,\n\t\t\t\t\t\tk.Vec2.fromAngle(pos.angleBetween(k.center())),\n\t\t\t\t\t\t2,\n\t\t\t\t\t\t7,\n\t\t\t\t\t\t1,\n\t\t\t\t\t\tk.rand(40, 60)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 22790,\n\t\t\tbegin: () => {\n\t\t\t\tk.flash(k.WHITE, level1.bpm);\n\t\t\t\tconst max = 12;\n\n\t\t\t\tfor (let i = 0; i < max; i++) {\n\t\t\t\t\tconst pos = getPosAtBorder(1 * (i / max));\n\n\t\t\t\t\tspawnShip1(\n\t\t\t\t\t\tpos,\n\t\t\t\t\t\tk.Vec2.fromAngle(pos.angleBetween(k.center())),\n\t\t\t\t\t\t2,\n\t\t\t\t\t\t5,\n\t\t\t\t\t\t1,\n\t\t\t\t\t\tk.rand(40, 60)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 36744,\n\t\t\tduration: 1000,\n\t\t\tbegin: () => {\n\t\t\t\tk.shake(10);\n\t\t\t},\n\t\t\tupd: (ld) => {\n\t\t\t\ttimer += k.dt();\n\n\t\t\t\tif (timer >= 0.05) {\n\t\t\t\t\tconst rnd = k.rand(1);\n\t\t\t\t\tspawnAssasin(getPosAtBorder(rnd), 2, 4, 1);\n\t\t\t\t\ttimer = 0;\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 43824,\n\t\t\tduration: 1500,\n\t\t\tbegin: () => {\n\t\t\t\ttimer = 0;\n\t\t\t\tspawned = 0;\n\t\t\t\ttoSpawn = 30;\n\t\t\t},\n\t\t\tupd: (ld) => {\n\t\t\t\ttimer += k.dt();\n\n\t\t\t\tif (timer >= 0.03 && spawned < toSpawn) {\n\t\t\t\t\tconst t = 0.25 + 0.25 * (spawned / toSpawn);\n\t\t\t\t\tspawnMeteorite({\n\t\t\t\t\t\tpos: getPosAtBorder(t),\n\t\t\t\t\t\tdir: k.LEFT,\n\t\t\t\t\t\tscoreOnKill: 0,\n\t\t\t\t\t\thp: 3,\n\t\t\t\t\t\tspeed: 40,\n\t\t\t\t\t\tsplitOnDeath: 2,\n\t\t\t\t\t});\n\t\t\t\t\tspawned++;\n\t\t\t\t\ttimer = 0;\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 45600,\n\t\t\tduration: 1500,\n\t\t\tbegin: () => {\n\t\t\t\ttimer = 0;\n\t\t\t\tspawned = 0;\n\t\t\t\ttoSpawn = 30;\n\t\t\t},\n\t\t\tupd: (ld) => {\n\t\t\t\ttimer += k.dt();\n\n\t\t\t\tif (timer >= 0.03 && spawned < toSpawn) {\n\t\t\t\t\tconst t = 0.75 + 0.25 * (spawned / toSpawn);\n\t\t\t\t\tspawnMeteorite({\n\t\t\t\t\t\tpos: getPosAtBorder(t),\n\t\t\t\t\t\tdir: k.RIGHT,\n\t\t\t\t\t\tscoreOnKill: 0,\n\t\t\t\t\t\thp: 3,\n\t\t\t\t\t\tspeed: 40,\n\t\t\t\t\t\tsplitOnDeath: 2,\n\t\t\t\t\t});\n\t\t\t\t\tspawned++;\n\t\t\t\t\ttimer = 0;\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 47000,\n\t\t\tduration: 5000,\n\t\t\tbegin: () => {\n\t\t\t\ttimer = 0;\n\t\t\t\tspawned = 0;\n\t\t\t\ttoSpawn = 40;\n\t\t\t\tconst max = 6;\n\n\t\t\t\tfor (let i = 0; i < max; i++) {\n\t\t\t\t\tconst pos = getPosAtBorder(0.25 * (i / max));\n\n\t\t\t\t\tspawnShip1(pos, k.DOWN, 2, 10, 1, k.rand(40, 60));\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {\n\t\t\t\ttimer += k.dt();\n\n\t\t\t\tif (timer >= 0.03 && spawned < toSpawn) {\n\t\t\t\t\tfor (let i = 0; i < 2; i++) {\n\t\t\t\t\t\tconst t = 0.5 * i + 0.25 * (spawned / toSpawn);\n\t\t\t\t\t\tspawnMeteorite({\n\t\t\t\t\t\t\tpos: getPosAtBorder(t),\n\t\t\t\t\t\t\tdir: i == 0 ? k.DOWN : k.UP,\n\t\t\t\t\t\t\tscoreOnKill: 0,\n\t\t\t\t\t\t\thp: 3,\n\t\t\t\t\t\t\tspeed: 40,\n\t\t\t\t\t\t\tsplitOnDeath: 2,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tspawned++;\n\t\t\t\t\ttimer = 0;\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 66000,\n\t\t\tduration: 14000,\n\t\t\tbegin: () => {\n\t\t\t\ttimer = 0;\n\t\t\t},\n\t\t\tupd: (ld) => {\n\t\t\t\ttimer += k.dt();\n\n\t\t\t\tif (timer >= level1.bpm * 2) {\n\t\t\t\t\tconst rnd = k.rand(1);\n\t\t\t\t\tspawnAssasin(getPosAtBorder(rnd), 2, 2, 1);\n\t\t\t\t\ttimer = 0;\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 79300,\n\t\t\tbegin: () => {\n\t\t\t\ttimer = 0;\n\t\t\t\tfor (let i = 0; i < 2; i++) {\n\t\t\t\t\tconst yPos = 200 + 300 * i;\n\t\t\t\t\tspawnHighway({\n\t\t\t\t\t\tstartPos: k.vec2(0, yPos),\n\t\t\t\t\t\tendPos: k.vec2(k.width(), yPos),\n\t\t\t\t\t\tspawnChance: 90,\n\t\t\t\t\t\tdestroyAfterKills: 5,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 86450,\n\t\t\tbegin: () => {\n\t\t\t\ttimer = 0;\n\t\t\t\tfor (let i = 0; i < 2; i++) {\n\t\t\t\t\tconst xPos = 200 + 300 * i;\n\t\t\t\t\tspawnHighway({\n\t\t\t\t\t\tstartPos: k.vec2(xPos, 0),\n\t\t\t\t\t\tendPos: k.vec2(xPos, k.height()),\n\t\t\t\t\t\tspawnChance: 80,\n\t\t\t\t\t\tdestroyAfterKills: 5,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tconst max = 14;\n\n\t\t\t\tfor (let i = 0; i < max; i++) {\n\t\t\t\t\tconst pos = getPosAtBorder(0.25 * (i / max));\n\n\t\t\t\t\tspawnShip1(pos, k.DOWN, 2, 5, 1, k.rand(40, 60));\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 97340,\n\t\t\tbegin: () => {\n\t\t\t\tk.flash(k.WHITE, 0.5);\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 100700,\n\t\t\tbegin: () => {\n\t\t\t\tk.flash(k.WHITE, 0.5);\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 107900,\n\t\t\tbegin: () => {\n\t\t\t\tk.flash(k.WHITE, 0.5);\n\n\t\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\t\tspawnSpawner({\n\t\t\t\t\t\tmaxSpawns: 5,\n\t\t\t\t\t\tonSpawn: (p) => {\n\t\t\t\t\t\t\tspawnAssasin(p, 2, 6, 1);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tspawnChance: 100,\n\t\t\t\t\t\tpos: k.rand(k.vec2(k.width(), k.height())),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 115000,\n\t\t\tbegin: () => {\n\t\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\t\tspawnSpawner({\n\t\t\t\t\t\tmaxSpawns: 10,\n\t\t\t\t\t\tonSpawn: (p) => {\n\t\t\t\t\t\t\tspawnAssasin(p, 2, 6, 1);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tspawnChance: 70,\n\t\t\t\t\t\tpos: k.rand(k.vec2(k.width(), k.height())),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t\t{\n\t\t\ttimeStamp: 125000,\n\t\t\tbegin: () => {\n\t\t\t\tfor (let i = 0; i < 6; i++) {\n\t\t\t\t\tspawnSpawner({\n\t\t\t\t\t\tmaxSpawns: 10,\n\t\t\t\t\t\tonSpawn: (p) => {\n\t\t\t\t\t\t\tspawnMeteorite({\n\t\t\t\t\t\t\t\tpos: p,\n\t\t\t\t\t\t\t\thp: 15,\n\t\t\t\t\t\t\t\tdir: k.rand(k.vec2(-1, -1), k.vec2(1, 1)),\n\t\t\t\t\t\t\t\tscoreOnKill: 2,\n\t\t\t\t\t\t\t\tspeed: k.rand(80, 120),\n\t\t\t\t\t\t\t\tsplitOnDeath: Math.floor(k.rand(3)),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tspawnChance: 50,\n\t\t\t\t\t\tpos: k.rand(k.vec2(k.width(), k.height())),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupd: (ld) => {},\n\t\t},\n\t],\n};\n","import {\n\tAnchorComp,\n\tAnimateComp,\n\tAreaComp,\n\tGameObj,\n\tHealthComp,\n\tPosComp,\n\tRotateComp,\n\tSpriteComp,\n\tVec2,\n} from \"kaplay\";\nimport {\n\tk,\n\tGameState,\n\tchangeGameState,\n\taddScore,\n\tmainSoundVolume,\n} from \"./main\";\nimport { player, resetSession, session } from \"./player\";\nimport { explosionEmitter } from \"./particles\";\nimport { activeLevel, loadLevel, resetCurrentLevel, updateLvl } from \"./wave\";\nimport { clearPlayer, setupPlayer } from \"./setupPlayer\";\nimport { level1 } from \"./levels/level1\";\nimport { tags } from \"./tags\";\nimport {\n\taddHealthBar,\n\tclearGameLoopUi,\n\tsetupGameLoopUi,\n\tupdatePlayerHealthBar,\n} from \"./gameUi\";\nimport { Component } from \"./compose\";\nimport { spawnPowerup } from \"./spawn/spawnPowerup\";\nimport { getDmg } from \"./projectiles/shared\";\nimport { spawnFlash } from \"./spawn/spawnFlash\";\nimport { spawnSpawner } from \"./spawn/spawnSpawner\";\nimport { spawnAssasin } from \"./spawn/spawnAssasin\";\n\nconst lengthBetweenLevels = 1;\n\nexport let playerObj: GameObj<\n\tPosComp | SpriteComp | RotateComp | AreaComp | AnchorComp | HealthComp\n>;\nlet timeSinceLastLevel = 0;\n\nexport let debrees: GameObj<AnimateComp | PosComp | SpriteComp>[] = [];\nexport const projectiles: GameObj<PosComp | any>[] = [];\n\nexport function startGame() {\n\tplayerObj = setupPlayer();\n\tresetSession();\n\tsetupGameLoopUi(player.maxHealth);\n}\n\nexport function updateGameLoop() {\n\tconst dt = k.dt();\n\ttimeSinceLastLevel += dt;\n\n\tif (timeSinceLastLevel >= lengthBetweenLevels && !activeLevel()) {\n\t\tloadLevel(level1);\n\n\t\tspawnPowerup(k.center(), \"addPlayerMaxHealth\");\n\t}\n\n\tif (activeLevel()) {\n\t\tif (updateLvl()) {\n\t\t\ttimeSinceLastLevel = 0;\n\t\t\tresetCurrentLevel();\n\t\t}\n\t}\n\n\tfor (let i = 0; i < debrees.length; i++) {\n\t\tconst d = debrees[i];\n\n\t\tconst dist = d.pos.dist(playerObj.pos);\n\n\t\tif (\n\t\t\tdist <\n\t\t\tplayer.debreeSeekDistance * player.debreeSeekDistanceMultiplier\n\t\t) {\n\t\t\td.moveTo(\n\t\t\t\tplayerObj.pos,\n\t\t\t\tplayer.debreeSeekSpeed * player.debreeSeekSpeedMultiplier\n\t\t\t);\n\n\t\t\tif (dist < player.debreePickupDistance) {\n\t\t\t\tk.destroy(d);\n\t\t\t\tdebrees.splice(i, 1);\n\t\t\t\tk.play(\"collect1\", { volume: mainSoundVolume });\n\t\t\t\taddScore(player.scorePerPickup);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearGame() {\n\tclearPlayer();\n\ttimeSinceLastLevel = 0;\n\tdebrees = [];\n\tresetCurrentLevel();\n\tk.destroyAll(tags.enemy);\n\tk.destroyAll(tags.blaster);\n\tk.destroyAll(tags.rocket);\n\tk.destroyAll(tags.enemy);\n\tk.destroyAll(tags.levelBg);\n\tk.destroyAll(tags.unit);\n\tk.destroyAll(tags.debree);\n\tk.destroyAll(tags.props);\n\tclearGameLoopUi();\n\tchangeGameState(GameState.LevelUp);\n}\n\nexport function createExplosion(\n\tpos,\n\tradius,\n\tsplashDmg,\n\tsplashDmgFallof,\n\tsplashDmgFallofDist\n) {\n\tconst enemies = k.query({\n\t\tinclude: [tags.enemy, tags.unit],\n\t\tincludeOp: \"and\",\n\t});\n\texplosionEmitter.emitter.position = pos;\n\texplosionEmitter.emit(14);\n\tspawnFlash(pos, 2);\n\n\tfor (let i = 0; i < enemies.length; i++) {\n\t\tif (enemies[i].pos.dist(pos) < radius) {\n\t\t\tconst dmg = getDmg(\n\t\t\t\tplayer.critChance,\n\t\t\t\tsplashDmg,\n\t\t\t\tplayer.critMultiplier,\n\t\t\t\tenemies[i].pos\n\t\t\t);\n\t\t\tenemies[i].hurt(dmg);\n\t\t}\n\t}\n}\n\nexport function checkProjectileIntersection(\n\tpos: Vec2,\n\tdist: number,\n\tprojectilesWithTag: string,\n\tonHit: (p: GameObj<PosComp | RotateComp | any>) => void\n) {\n\tfor (let i = 0; i < projectiles.length; i++) {\n\t\tconst p = projectiles[i];\n\n\t\tif (p.pos.dist(pos) < dist) {\n\t\t\tif (!p.tags.includes(projectilesWithTag)) continue;\n\n\t\t\tonHit(p);\n\t\t}\n\t}\n}\nexport function checkProjectileComponentIntersection(\n\tpos: Vec2,\n\tdist: number,\n\tprojectilesWithTag: string,\n\tcomponents: Component[],\n\tonHit: (p: GameObj<PosComp | RotateComp | any>, index: number) => void\n) {\n\tfor (let i = 0; i < projectiles.length; i++) {\n\t\tconst p = projectiles[i];\n\n\t\tif (p.pos.dist(pos) < dist) {\n\t\t\tif (!p.tags.includes(projectilesWithTag)) continue;\n\n\t\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\t\tif (components[i].obj.hidden) continue;\n\n\t\t\t\tif (\n\t\t\t\t\tp.pos.dist(pos.sub(components[i].localPos)) < components[i].hitbox\n\t\t\t\t) {\n\t\t\t\t\tonHit(p, i);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pickUnitInDistance(\n\tpos: Vec2,\n\tdist: number,\n\ttag: string,\n\tonFound: (u: GameObj) => void\n) {\n\tconst units = k.query({ include: [tag, tags.unit], includeOp: \"and\" });\n\tfor (let i = 0; i < units.length; i++) {\n\t\tconst u = units[i];\n\n\t\tif (u.pos.dist(pos) < dist) {\n\t\t\tonFound(u);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nexport function addMaxHealth() {\n\tif (!playerObj) return;\n\n\tsession.extraHealth++;\n\tconst totalHealth = player.maxHealth + session.extraHealth;\n\tplayerObj.setMaxHP(totalHealth);\n\taddHealthBar(totalHealth - 1);\n\tplayerObj.heal();\n\tupdatePlayerHealthBar(playerObj.hp());\n}\n","import {\n\tAreaComp,\n\tGameObj,\n\tOpacityComp,\n\tPosComp,\n\tSpriteComp,\n\tTextComp,\n\tVec2,\n} from \"kaplay\";\nimport {\n\taddScore,\n\tchangeGameState,\n\tGameState,\n\tk,\n\tmainSoundVolume,\n\tscore,\n} from \"./main\";\nimport { loadPlayer } from \"./player\";\nimport { addLvl, getNextLvl, loadout, Tool, ToolKey, upgrades } from \"./upg\";\nimport { starsEmitter } from \"./particles\";\n\nconst gridTag = \"ui_grid\";\n\ninterface ToolGroup {\n\tgroup?: GameObj<PosComp>;\n\ttitle?: GameObj<TextComp>;\n\theader?: GameObj<TextComp>;\n\tdesc?: GameObj<TextComp>;\n\ticon?: GameObj<SpriteComp>;\n\tpurchaseBtn?: GameObj<AreaComp | OpacityComp>;\n\tpurchaseBtnText?: GameObj<TextComp>;\n}\n\nlet selectedTool: { key: ToolKey; index: number };\nlet toolGroupObj: ToolGroup = {\n\tgroup: undefined,\n\ttitle: undefined,\n\theader: undefined,\n\tdesc: undefined,\n\ticon: undefined,\n};\nlet highlightKeyObj: Record<string, GameObj> = {};\nlet scoreTxt: GameObj<TextComp>;\nlet selectedPos: Vec2;\n\nexport function enterLevelUp() {\n\tconst center = k.center();\n\n\tconst g1 = uiGroup(k.vec2(center.x, 40), \"ui\");\n\n\tg1.add([k.text(\"UPGRADE\", { size: 22, font: \"unscii\" }), k.anchor(\"center\")]);\n\n\tscoreTxt = addTextWithBorder(g1, 12, getScoreStr(score), k.vec2(0, 50));\n\n\treloadUpgradeGrid(center);\n\n\ttoolGroupObj.group = uiGroup(\n\t\tk.vec2(center.x + center.x / 2 - 100, center.y - center.y / 2 - 40),\n\t\t\"ui\"\n\t);\n\ttoolGroupObj.group.hidden = true;\n\tbuildToolUi();\n\n\taddBtn(\"START GAME\", k.vec2(center.x, center.y * 2 - 60), () => {\n\t\tclearLevelUp();\n\t\tchangeGameState(GameState.Playing);\n\t});\n}\n\nexport function updateLevelUpLoop() {}\n\nexport function clearLevelUp() {\n\tk.destroyAll(\"ui\");\n\tk.destroyAll(gridTag);\n}\n\nfunction reloadUpgradeGrid(pos: Vec2) {\n\tk.destroyAll(gridTag);\n\tconst gridGroup = uiGroup(k.vec2(60, pos.y), gridTag);\n\n\tvar upgs = upgrades;\n\n\tvar keys = Object.entries(upgs)\n\t\t.filter(([_, v]) => {\n\t\t\tif (!v.requiredTool) return true;\n\n\t\t\treturn loadout[v.requiredTool] !== undefined;\n\t\t})\n\t\t.map(([k, _]) => k) as ToolKey[];\n\n\tconst maxColumns = 4;\n\tlet row = -1;\n\tconst size = 42;\n\tconst spacing = 8;\n\tconst upgSize = 16;\n\n\tfor (let i = 0; i < keys.length; i++) {\n\t\tconst tool = upgrades[keys[i]] as Tool;\n\t\tconst upgIndex = getNextLvl(keys[i]);\n\n\t\tif (i % maxColumns == 0) {\n\t\t\trow++;\n\t\t}\n\n\t\tconst col = i - maxColumns * row;\n\n\t\tconst btn = gridGroup.add([\n\t\t\tk.pos(k.vec2((size + spacing) * col, (size + spacing) * row)),\n\t\t\tk.rect(size, size),\n\t\t\tk.area(),\n\t\t\tk.color(0, 0, 0),\n\t\t\tk.anchor(\"center\"),\n\t\t\tk.outline(1, new k.Color(255, 255, 255)),\n\t\t\tgridTag,\n\t\t]);\n\n\t\tconst highlight = btn.add([\n\t\t\tk.rect(size + 6, size + 6),\n\t\t\tk.pos(0, 0),\n\t\t\tk.color(0, 0, 0),\n\t\t\tk.anchor(\"center\"),\n\t\t\tk.outline(2, new k.Color(255, 255, 255)),\n\t\t\tgridTag,\n\t\t]);\n\t\thighlight.hidden = true;\n\t\thighlightKeyObj[keys[i]] = highlight;\n\n\t\tif (upgIndex > 0) {\n\t\t\tconst c = btn.add([\n\t\t\t\tk.pos(upgSize, -size / 2),\n\t\t\t\tk.rect(upgSize, upgSize),\n\t\t\t\tk.anchor(\"center\"),\n\t\t\t\tk.color(255, 255, 255),\n\t\t\t]);\n\t\t\tc.add([\n\t\t\t\tk.text(`${upgIndex}`, { size: 14, font: \"unscii\" }),\n\t\t\t\tk.pos(0, 2),\n\t\t\t\tk.anchor(\"center\"),\n\t\t\t\tk.color(0, 0, 0),\n\t\t\t]);\n\t\t}\n\n\t\tconst clampIndex = k.clamp(upgIndex, 0, tool.upgrades.length - 1);\n\n\t\tbtn.add([\n\t\t\tk.sprite(tool.upgrades[clampIndex].sprite, { height: 24, width: 24 }),\n\t\t\tk.anchor(\"center\"),\n\t\t]);\n\n\t\tbtn.onClick(() => onClick(keys[i], upgIndex, btn.worldPos()!));\n\t}\n}\n\nfunction onClick(key: ToolKey, upgIndex: number, pos: Vec2) {\n\tif (selectedTool) {\n\t\thighlightKeyObj[selectedTool.key].hidden = true;\n\t}\n\thighlightKeyObj[key].hidden = false;\n\tloadTool(key, upgIndex);\n\tk.play(\"click1\", { volume: mainSoundVolume });\n\tselectedPos = pos;\n}\n\nfunction buildToolUi() {\n\tconst containerWidth = 200;\n\tconst containerHeight = 300;\n\ttoolGroupObj.header = toolGroupObj.group!.add([\n\t\tk.text(\"LEVEL 1\", { size: 10, font: \"unscii\" }),\n\t\tk.anchor(\"top\"),\n\t\tk.pos(containerWidth / 2, 0),\n\t]);\n\ttoolGroupObj.title = toolGroupObj.group!.add([\n\t\tk.text(\"BLASTER\", { size: 14, font: \"unscii\" }),\n\t\tk.anchor(\"top\"),\n\t\tk.pos(containerWidth / 2, 22),\n\t]);\n\tconst container = toolGroupObj.group!.add([\n\t\tk.pos(0, 80),\n\t\tk.rect(containerWidth, containerHeight),\n\t\tk.color(0, 0, 0),\n\t\tk.outline(2, new k.Color(255, 255, 255)),\n\t]);\n\tconst c2 = container.add([\n\t\tk.rect(containerWidth / 2, 60),\n\t\tk.color(0, 0, 0),\n\t\tk.anchor(\"center\"),\n\t\tk.pos(containerWidth / 2, 10),\n\n\t\tk.outline(2, new k.Color(255, 255, 255)),\n\t]);\n\n\ttoolGroupObj.icon = c2.add([\n\t\tk.sprite(\"ship\", { height: 32, width: 32 }),\n\t\tk.anchor(\"center\"),\n\t]);\n\n\ttoolGroupObj.desc = container.add([\n\t\tk.pos(0, 80),\n\t\tk.text(\"EQUIPE YOUR SHIP WITH A LASER BLASTER, LEFT MOUSE TO FIRE\", {\n\t\t\tsize: 12,\n\t\t\tfont: \"unscii\",\n\t\t\twidth: containerWidth,\n\t\t\talign: \"center\",\n\t\t\tlineSpacing: 12,\n\t\t}),\n\t]);\n\n\ttoolGroupObj.purchaseBtn = toolGroupObj.group!.add([\n\t\tk.rect(containerWidth + 40, 50),\n\t\tk.area(),\n\t\tk.opacity(1),\n\t\tk.anchor(\"center\"),\n\t\tk.pos(containerWidth / 2, containerHeight + 40),\n\t]);\n\n\ttoolGroupObj.purchaseBtnText = toolGroupObj.purchaseBtn!.add([\n\t\tk.text(\"PURCHASE 12P\", { size: 16, font: \"unscii\" }),\n\t\tk.color(0, 0, 0),\n\t\tk.anchor(\"center\"),\n\t]);\n\n\ttoolGroupObj.purchaseBtn!.onClick(() => {\n\t\tif (toolGroupObj.group!.hidden || toolGroupObj.purchaseBtn?.hidden) return;\n\t\tconst toPurchase = upgrades[selectedTool.key].upgrades[selectedTool.index];\n\t\tif (score < toPurchase.price) {\n\t\t\tk.play(\"error\", { volume: mainSoundVolume });\n\t\t\treturn;\n\t\t}\n\n\t\taddScore(-toPurchase.price);\n\t\taddLvl(selectedTool.key);\n\t\treloadUpgradeGrid(k.center());\n\t\tloadTool(selectedTool.key, selectedTool.index + 1);\n\t\tstarsEmitter.emitter.position = selectedPos;\n\t\tstarsEmitter.emit(20);\n\t\tloadPlayer();\n\t\tk.play(\"purchase1\", { volume: mainSoundVolume });\n\t\tscoreTxt.text = getScoreStr(score);\n\t});\n}\n\nfunction loadTool(key: ToolKey, upgIndex: number) {\n\tconst tool = upgrades[key];\n\tconst clampedUpgIndex = k.clamp(upgIndex, 0, tool.upgrades.length - 1);\n\ttoolGroupObj.group!.hidden = false;\n\tconst upg = tool.upgrades[clampedUpgIndex];\n\n\ttoolGroupObj.title!.text = tool.toolName.toUpperCase();\n\ttoolGroupObj.desc!.text = upg.desc.toUpperCase();\n\ttoolGroupObj.header!.text = upg.name.toUpperCase();\n\ttoolGroupObj.icon!.sprite = upg.sprite;\n\tselectedTool = {\n\t\tkey: key,\n\t\tindex: clampedUpgIndex,\n\t};\n\n\tif (upgIndex != clampedUpgIndex) {\n\t\ttoolGroupObj.purchaseBtn!.hidden = true;\n\t\treturn;\n\t}\n\n\ttoolGroupObj.purchaseBtnText!.text = `PURCHASE ${upg.price}P`;\n\n\ttoolGroupObj.purchaseBtn!.hidden = false;\n\tif (score < upg.price) {\n\t\ttoolGroupObj.purchaseBtn!.opacity = 0.3;\n\t\treturn;\n\t}\n\ttoolGroupObj.purchaseBtn!.opacity = 1;\n}\n\nfunction addBtn(txt: string, pos: Vec2, onClick: () => void) {\n\tconst btn = k.add([\n\t\tk.pos(pos),\n\t\tk.rect(300, 50),\n\t\tk.area(),\n\t\tk.color(0, 0, 0),\n\t\tk.anchor(\"center\"),\n\t\t\"ui\",\n\t]);\n\n\tbtn.add([k.text(txt, { size: 16, font: \"unscii\" }), k.anchor(\"center\")]);\n\n\tbtn.onClick(onClick);\n\n\treturn btn;\n}\n\nfunction addTextWithBorder(group: GameObj, size: number, txt: string, p: Vec2) {\n\tconst b = group.add([\n\t\tk.rect(80, 40),\n\t\tk.pos(p),\n\t\tk.anchor(\"center\"),\n\t\tk.outline(2, new k.Color(255, 255, 255)),\n\t\tk.color(0, 0, 0),\n\t]);\n\n\tconst text = b.add([\n\t\tk.text(txt, { size: size, font: \"unscii\" }),\n\t\tk.anchor(\"center\"),\n\t]);\n\treturn text;\n}\n\nfunction uiGroup(pos: Vec2, tag: string) {\n\treturn k.add([k.pos(pos), tag]);\n}\n\nfunction getScoreStr(s: number) {\n\treturn `${s}P`;\n}\n","import kaplay, { Vec2 } from \"kaplay\";\nimport { init, loadGame, saveGame } from \"./util\";\nimport { startGame, updateGameLoop } from \"./game\";\nimport { enterLevelUp, updateLevelUpLoop } from \"./levelUp\";\nimport { setLoadout } from \"./upg\";\nimport { loadPlayer } from \"./player\";\nimport { initParticles } from \"./particles\";\n\nexport const layers = {\n\tbg: \"bg\",\n\tgame: \"game\",\n\tui: \"ui\",\n};\n\nexport const GameState = {\n\tPlaying: 1,\n\tLevelUp: 2,\n};\n\nconst borderOffset = -22;\nexport let score = 60;\nexport const BULLET_SPEED = 320;\nexport const ROCKET_SPEED = 280;\nexport let timeSeconds = 0;\nexport const outsideBorderPos: Vec2[] = [];\n\nexport const subSoundVolume = 0.3;\nexport const mainSoundVolume = 0.5;\nexport const musicVolume = 0.6;\n\nlet gameState = GameState.Playing;\n\nexport const k = kaplay({\n\tbackground: \"#000000\",\n\tglobal: false,\n\tscale: 1.2,\n\twidth: 700,\n\theight: 700,\n});\n\ninit(k).then(() => {\n\tinitParticles();\n\tloadGameSlot();\n\tk.setLayers([layers.bg, layers.game, layers.ui], layers.game);\n\n\taddBorderOffsets();\n\n\tchangeGameState(GameState.LevelUp);\n\n\tk.onUpdate(() => {\n\t\tif (gameState == GameState.Playing) {\n\t\t\ttimeSeconds += k.dt();\n\t\t\tupdateGameLoop();\n\t\t} else if (gameState == GameState.LevelUp) {\n\t\t\tupdateLevelUpLoop();\n\t\t}\n\t});\n});\n\nexport function changeGameState(state: number) {\n\tgameState = state;\n\n\tif (gameState == GameState.Playing) {\n\t\tstartGame();\n\t} else if (gameState == GameState.LevelUp) {\n\t\tsaveGame(\"slot1\");\n\t\tenterLevelUp();\n\t}\n}\n\nexport function addScore(am: number) {\n\tscore += am;\n}\n\nfunction loadGameSlot() {\n\tvar slot = loadGame(\"slot1\");\n\tif (!slot) return;\n\n\tsetLoadout(slot.loadout);\n\tscore = slot.score;\n\ttimeSeconds = slot.time;\n\tloadPlayer();\n}\n\nfunction addBorderOffsets() {\n\tconst center = k.center();\n\toutsideBorderPos.push(k.vec2(-borderOffset, -borderOffset));\n\toutsideBorderPos.push(k.vec2(center.x * 2 + borderOffset, -borderOffset));\n\toutsideBorderPos.push(\n\t\tk.vec2(center.x * 2 + borderOffset, center.y * 2 + borderOffset)\n\t);\n\toutsideBorderPos.push(k.vec2(-borderOffset, center.y * 2 + borderOffset));\n}\n\nexport function getPosAtBorder(t: number) {\n\tconst index = Math.floor(outsideBorderPos.length * t);\n\tconst subtractT = (1 / outsideBorderPos.length) * index;\n\tconst deltaT = (t - subtractT) * outsideBorderPos.length;\n\tconst newPos = (\n\t\tindex + 1 >= outsideBorderPos.length\n\t\t\t? outsideBorderPos[0]\n\t\t\t: outsideBorderPos[index + 1]\n\t).sub(outsideBorderPos[index]);\n\n\tconst clampedIndex = k.clamp(index, 0, outsideBorderPos.length - 1);\n\n\treturn outsideBorderPos[clampedIndex].add(newPos.scale(deltaT));\n}\n"],"names":["blaster","blasterMultiple","blasterSpeed","blasterDmg","followerBlasterDmg","followerMissiles","rocket","increaseRockets","rocketShards","debreeDist","debreeSpeed","sprint","sprintSpeed","movespeed","debreeValue","maxHealth","upgrades","loadout","getToolUpgradeLvlValue","key","addLvl","getNextLvl","saveGame","setLoadout","set","init","k","explArr","randomExplosion","r","adjustedTarget","from","to","shortestAngleDelta","delta","slot","save","score","timeSeconds","loadGame","p","session","resetSession","player","loadPlayer","hasLvlValue","value","lvl","trailEmitter","starsEmitter","starsEmitterDir","explosionEmitter","debreeRocketEmitter","initParticles","currentLvl","nextWaveIndex","currentWaveIndex","timeDuringLevel","loadLevel","updateLvl","waveEndedTimestamp","activeLevel","resetCurrentLevel","resetLvlData","tags","healthBars","specialBar","height","specialHeight","setupGameLoopUi","health","i","addHealthBar","healthValue","offset","c","updatePlayerHealthBar","currentHealth","updateSpecialBar","current","max","clearGameLoopUi","spawnFlash","pos","multiplier","shootBlaster","dir","rot","dmg","speedMltp","attachTags","playSound","BULLET_SPEED","index","projectiles","p2","mainSoundVolume","registerHitAnimation","m","lerpAngleBetweenPos","angle","pos1","pos2","hardness","addAngle","a","desiredRot","correctedDesiredRot","lerpMoveRotateAndScale","lerp","speed","lerpAngle","x","y","sum","values","b","acquireTargetAfter","trailOffset","maxSpeed","shootRocket","impactDmg","splashDmg","splashSize","splashDmgFallof","splashDmgFallofDist","tagsToAttach","canSeek","ROCKET_SPEED","currentDir","emitterPos","pickUnitInDistance","u","_a","subSoundVolume","shards","blasters","bulletIndex","specialTimer","rocketSpecialCooldown","setupPlayer","playerObj","clearGame","checkProjectileIntersection","createExplosion","dist","playerCurrentDir","gunPipe","clearPlayer","target","tag","spawnFollower","props","spawnPowerup","powerupKey","powerupsSprites","powerups","addMaxHealth","powerupWeights","powerupReq","blankChance","randomizePowerup","chanceMultiplier","keyValues","chanceSpan","previous","thisChance","trySpawnRandomizedPowerup","chance","getDmg","critChance","critMultiplier","spawnDebree","am","d","debrees","onEnemyHit","enemyOnDeath","powerupMultiplier","spawnAssasin","hp","scale","hb","spawnMeteorite","initScale","spawnGenericVehicle","addTo","sprite","spawnHighway","smallOffset","randomVehicle","sprites","compose","composed","body","part","unitComponents","detach","force","v","jitter","strength","toJitter","wingOffset","spawnShip1","wing1","wing2","checkProjectileComponentIntersection","loadSongData","title","author","albumSrc","container","titleEl","authorEl","coverEl","endSong","spawnCrate","spawnSpawner","lvlData","timer","spawned","toSpawn","song","level1","musicVolume","ld","txt","randomPos","line","spawn","layers","getPosAtBorder","rnd","t","yPos","xPos","lengthBetweenLevels","timeSinceLastLevel","startGame","updateGameLoop","dt","addScore","changeGameState","GameState","radius","enemies","projectilesWithTag","onHit","components","onFound","units","totalHealth","gridTag","selectedTool","toolGroupObj","highlightKeyObj","scoreTxt","selectedPos","enterLevelUp","center","g1","uiGroup","addTextWithBorder","getScoreStr","reloadUpgradeGrid","buildToolUi","addBtn","clearLevelUp","gridGroup","upgs","keys","_","maxColumns","row","size","spacing","upgSize","tool","upgIndex","col","btn","highlight","clampIndex","onClick","loadTool","c2","toPurchase","clampedUpgIndex","upg","group","s","borderOffset","outsideBorderPos","gameState","kaplay","loadGameSlot","addBorderOffsets","state","subtractT","deltaT","newPos","clampedIndex"],"mappings":"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"}