import{U as Fe}from"./kaplay-D9oRpw-2.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();const qe={toolName:"Blaster",upgrades:[{name:"Level 1",desc:"Add a second blaster to your ship",price:12,sprite:"blaster1",value:1},{name:"Level 2",desc:"Add a third blaster to your ship",price:12,sprite:"blaster1",value:2}]},Ce={toolName:"Parallel processor",requiredTool:"blaster",upgrades:[{name:"Level 1",desc:"Fire all blasters at the same time",price:12,sprite:"parallel_blasters_upg1",value:1}]},Ne={toolName:"Blaster speed",requiredTool:"blaster",upgrades:[{name:"Level 1",desc:"Increase velocity of blaster projectiles",price:12,sprite:"blaster_upg_speed1",value:1.65}]},Re={toolName:"Blaster dmg",requiredTool:"blaster",upgrades:[{name:"Level 1",desc:"Increase damage of the ships primary blasters",price:12,sprite:"blaster_upg_dmg1",value:2}]},We={toolName:"Followers",upgrades:[{name:"Level 1",desc:"Purchase a follower for your social media account",sprite:"follower_upg1",price:22,value:1},{name:"Level 2",desc:"Your social media is blowing up",sprite:"follower_upg1",price:22,value:2},{name:"Level 3",desc:"Wow, you are popular!!",sprite:"follower_upg1",price:22,value:3},{name:"Level 4",desc:"Alright rockstar...",sprite:"follower_upg1",price:22,value:10}]},ze={toolName:"Followers",requiredTool:"follower",upgrades:[{name:"Level 1",desc:"Increase your followers blaster damage",sprite:"follower_blaster_dmg_upg1",price:22,value:1},{name:"Level 2",desc:"Too... Many... Damage... Numbers...",sprite:"follower_blaster_dmg_upg1",price:22,value:2}]},Ge={toolName:"Followers",requiredTool:"follower",upgrades:[{name:"Level 1",desc:"Your followers will become quite dangerous (with missiles)",sprite:"follower_missiles_upg1",price:22,value:1}]},Ke={toolName:"Missile barrage",upgrades:[{name:"Level 1",desc:"Install missile pods to the ship",sprite:"rocket_upg1",price:22,value:1}]},Je={toolName:"Increase missiles",requiredTool:"rockets",upgrades:[{name:"Level 1",desc:"Increase missiles to 6",sprite:"more_missiles_upg1",price:22,value:6},{name:"Level 2",desc:"Increase missiles to 8",sprite:"more_missiles_upg1",price:22,value:8},{name:"Level 3",desc:"Increase missiles to 10",sprite:"more_missiles_upg1",price:22,value:10},{name:"Level 4",desc:"Increase missiles to 16, missiles will be taped outside the pod",sprite:"more_missiles_upg1",price:22,value:16}]},Ye={toolName:"Missile shards",requiredTool:"rockets",upgrades:[{name:"Level 1",desc:"Missiles are loaded with space debree, shooting shards when exploded",sprite:"missile_shards_upg1",price:22,value:5},{name:"Level 2",desc:"Squeeze some more debree in those missiles!!",sprite:"missile_shards_upg1",price:22,value:7},{name:"Level 3",desc:"Squeeze some more debree in those missiles!!",sprite:"missile_shards_upg1",price:22,value:9}]},$e={toolName:"Debree magnets",upgrades:[{name:"Level 1",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.2},{name:"Level 2",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.4},{name:"Level 3",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.6},{name:"Level 4",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:1.8},{name:"Level 5",desc:"Upgrade the ships magnetic magnets and increase debree collect distance",sprite:"debree_dist_upg1",price:32,value:2}]},Qe={toolName:"Stronger magnets",upgrades:[{name:"Level 1",desc:"Stronger magnets = faster debree, easy math",sprite:"debree_speed_upg1",price:32,value:1.2},{name:"Level 2",desc:"Stronger magnets = faster debree, easy math",sprite:"debree_speed_upg1",price:32,value:1.4},{name:"Level 3",desc:"Stronger magnets = faster debree, easy math",sprite:"debree_speed_upg1",price:32,value:2}]},Xe={toolName:"Thrusters overclock",upgrades:[{name:"Level 1",desc:"Hold SHIFT to overclock thrusters, increasing speed",sprite:"overclock_thrusters_upg1",price:32,value:1.2},{name:"Level 2",desc:"Increase speed when overclocking thrusters",sprite:"overclock_thrusters_upg1",price:32,value:1.4}]},Ze={toolName:"Thrusters cooling",requiredTool:"sprint",upgrades:[{name:"Level 1",desc:"Pouring unknown liquid on the thrusters seems to make them go faster during overclock??",sprite:"faster_speed_upg1",price:32,value:1.3},{name:"Level 2",desc:"Pour more liquid, the ship probably need some pumps soon...",sprite:"faster_speed_upg1",price:32,value:1.4}]},et={toolName:"Improved thrusters",upgrades:[{name:"Level 1",desc:"Bigger thrusters, more speed",sprite:"faster_speed_upg1",price:32,value:1.05},{name:"Level 2",desc:"Bigger thrusters, more speed",sprite:"faster_speed_upg1",price:32,value:1.15}]},tt={toolName:"Shiny debree",requiredTool:"debreeDist",upgrades:[{name:"Level 1",desc:"Debree becomes more valueable, who could have thought",sprite:"debree_value_upg1",price:32,value:2},{name:"Level 2",desc:"Debree becomes almost as valuable as gold",sprite:"debree_value_upg1",price:32,value:3}]},rt={toolName:"Stronger hull",upgrades:[{name:"Level 1",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:3},{name:"Level 2",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:4},{name:"Level 3",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:5},{name:"Level 4",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:6},{name:"Level 5",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:7},{name:"Level 6",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:8},{name:"Level 7",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:9},{name:"Level 8",desc:"Upgrade hull and increase health by one",sprite:"hull_upg1",price:32,value:10}]},X={blaster:qe,blasterParallel:Ce,blasterDmg:Re,blasterSpeed:Ne,rockets:Ke,nrOfRockets:Je,rocketShards:Ye,debreeDist:$e,debreeSpeed:Qe,debreeValue:tt,sprint:Xe,sprintSpeed:Ze,movespeed:et,maxHealth:rt,follower:We,followerBlasterDmg:ze,followerMissiles:Ge};let j={blaster:void 0,blasterDmg:void 0,blasterSpeed:void 0,rockets:void 0,debreeDist:void 0,debreeSpeed:void 0,nrOfRockets:void 0,sprint:void 0,movespeed:void 0,debreeValue:void 0,maxHealth:void 0,follower:void 0,followerBlasterDmg:void 0,followerMissiles:void 0,rocketShards:void 0,sprintSpeed:void 0,blasterParallel:void 0};function v(t){if(j[t]!==void 0)return X[t].upgrades[j[t]].value}function st(t){j[t]=Pe(t),Te("slot1")}function Pe(t){return j[t]===void 0?0:j[t]+1}function at(t){j=t}async function ot(t){await t.loadRoot("./"),await t.loadSprite("ship","sprites/ship.png"),await t.loadSprite("crate1","sprites/crate1.png"),await t.loadSprite("bullet1","sprites/bullet1.png"),await t.loadSprite("rocket1","sprites/rocket1.png"),await t.loadSprite("follower","sprites/follower.png"),await t.loadSprite("asteroid1","sprites/asteroid1.png"),await t.loadSprite("enemy_ship1","sprites/enemy_ship1.png"),await t.loadSprite("bike1","sprites/bike1.png"),await t.loadSprite("particle1","sprites/particle1.png"),await t.loadSprite("particle2","sprites/particle2.png"),await t.loadSprite("particle3","sprites/particle3.png"),await t.loadSprite("particle4","sprites/particle4.png"),await t.loadSprite("spark1","sprites/spark1.png"),await t.loadSprite("debree_part1","sprites/debree_part1.png"),await t.loadSprite("blaster1","sprites/upgrades/laser_cannon1.png"),await t.loadSprite("rocket_upg1","sprites/upgrades/rocket_upg1.png"),await t.loadSprite("blaster_upg_speed1","sprites/upgrades/blaster_upg_speed1.png"),await t.loadSprite("blaster_upg_dmg1","sprites/upgrades/blaster_upg_dmg1.png"),await t.loadSprite("debree_dist_upg1","sprites/upgrades/debree_dist_upg1.png"),await t.loadSprite("debree_speed_upg1","sprites/upgrades/debree_speed_upg1.png"),await t.loadSprite("debree_value_upg1","sprites/upgrades/debree_value_upg1.png"),await t.loadSprite("faster_speed_upg1","sprites/upgrades/faster_speed_upg1.png"),await t.loadSprite("hull_upg1","sprites/upgrades/hull_upg1.png"),await t.loadSprite("missile_shards_upg1","sprites/upgrades/missiles_shards_upg1.png"),await t.loadSprite("more_missiles_upg1","sprites/upgrades/more_missiles_upg1.png"),await t.loadSprite("overclock_thrusters_upg1","sprites/upgrades/overclock_thrusters_upg1.png"),await t.loadSprite("parallel_blasters_upg1","sprites/upgrades/parallel_blasters_upg1.png"),await t.loadSprite("follower_upg1","sprites/upgrades/follower_upg1.png"),await t.loadSprite("follower_missiles_upg1","sprites/upgrades/follower_missiles_upg1.png"),await t.loadSprite("follower_blaster_dmg_upg1","sprites/upgrades/follower_blaster_dmg_upg1.png"),await t.loadSprite("bg_moon1","sprites/bg/moon1.png"),await t.loadSprite("bg_building1","sprites/bg/building1.png"),await t.loadBitmapFont("unscii","/fonts/unscii_8x8.png",8,8),await t.loadSound("shoot1","sounds/shoot1.wav"),await t.loadSound("fire_rocket1","sounds/rocket_fire1.wav"),await t.loadSound("explosion1","sounds/explosion1.wav"),await t.loadSound("explosion2","sounds/explosion2.wav"),await t.loadSound("explosion3","sounds/explosion3.wav"),await t.loadSound("explosion4","sounds/explosion4.wav"),await t.loadSound("hit1","sounds/hit1.wav"),await t.loadSound("hit2","sounds/hit2.wav"),await t.loadSound("player_hit1","sounds/player_hit1.wav"),await t.loadSound("collect1","sounds/collect1.wav"),await t.loadSound("click1","sounds/click.wav"),await t.loadSound("purchase","sounds/purchase.wav"),await t.loadSound("error","sounds/error.wav"),await t.loadSound("purchase1","sounds/purchase1.wav"),await t.loadMusic("arcadia","songs/arcadia.mp3"),await t.loadSprite("enemy_ship1_left_wing","sprites/ships/enemy1/enemy_ship1_left_wing.png"),await t.loadSprite("enemy_ship1_right_wing","sprites/ships/enemy1/enemy_ship1_right_wing.png"),await t.loadSprite("enemy_ship1_body","sprites/ships/enemy1/enemy_ship1_body.png")}const _e=["explosion1","explosion2","explosion3"];function A(){const t=Math.floor(Math.random()*_e.length);return _e[t]}function it(t,r){return t+lt(t,r)}function lt(t,r){let a=(r-t)%360;return a>180&&(a-=360),a<-180&&(a+=360),a}function Te(t){const r={loadout:j,score:C,time:Se};localStorage.setItem(t,JSON.stringify(r))}function nt(t){var r=localStorage.getItem(t);return r?JSON.parse(r):null}const d={maxHealth:2,scorePerPickup:1,blasterDmg:2,blasterDmgMultiplier:1,blasterLvl:void 0,blasterParallel:void 0,rocketsLvl:void 0,nrOfRockets:3,rocketShards:0,blasterSpeedMultiplier:1,debreePickupDistance:10,debreeSeekDistance:50,debreeSeekSpeed:80,debreeSeekDistanceMultiplier:1,debreeSeekSpeedMultiplier:1,debreeValueMultiplier:1,rocketImpactDmg:10,rocketSplashDmg:5,rocketDmgMultiplier:1,rocketSplashSize:30,rocketSplashSizeMultiplier:1,rocketSplashDmgFallOverDistance:.7,rocketSplashDmgFallDistanceValue:.6,speed:100,canSprint:void 0,sprintSpeedMultiplier:1,speedMultiplier:1,speedPwrUpMultiplier:1,nrOfFollowers:0,followerBlasterDmg:1,followerBlasterDmgMultiplier:1,followerCanUseMissiles:void 0};function Ue(){d.blasterLvl=v("blaster"),d.blasterParallel=v("blasterParallel"),d.blasterDmgMultiplier=v("blasterDmg")??1,d.blasterSpeedMultiplier=v("blasterSpeed")??1,d.rocketsLvl=v("rockets"),d.nrOfRockets=v("nrOfRockets")??3,d.rocketShards=v("rocketShards")??0,d.debreeSeekDistanceMultiplier=v("debreeDist")??1,d.debreeSeekSpeedMultiplier=v("debreeSpeed")??1,d.debreeValueMultiplier=v("debreeValue")??1,d.canSprint=v("sprint"),d.sprintSpeedMultiplier=v("sprintSpeed")??1,d.speedMultiplier=v("movespeed")??1,d.maxHealth=v("maxHealth")??2,d.nrOfFollowers=v("follower")??0,d.followerBlasterDmg=v("followerBlasterDmg")??1,d.followerCanUseMissiles=v("followerMissiles")}function re(t,r){return t===void 0?!1:t>=r}let T,w,ae,he,oe;function dt(){T=e.add([e.pos(),e.particles({max:2e3,speed:[2,30],lifeTime:[.2,.6],colors:[e.WHITE],opacities:[.8,.6],angle:[0,360],damping:[2,2],scales:[.4,.2,.1],texture:e.getSprite("particle3").data.tex,quads:[e.getSprite("particle3").data.frames[0]]},{rate:1,direction:0,spread:90,position:e.vec2(0,0)}),"trail"]),w=e.add([e.pos(),e.particles({max:1e3,speed:[10,40],angle:[0,360],lifeTime:[1,1.5],colors:[e.rgb(255,255,255)],opacities:[1,.5],scales:[1.4,1,.4,.1],damping:[0,.5],angularVelocity:[-90,90],texture:e.getSprite("particle1").data.tex,quads:[e.getSprite("particle1").data.frames[0]]},{rate:0,direction:-90,spread:360,position:e.vec2()})]),ae=e.add([e.pos(),e.particles({max:1e3,speed:[200,300],angle:[0,360],lifeTime:[1,1.5],colors:[e.rgb(255,255,255)],opacities:[1,.5],scales:[1.4,1,.4,.1],damping:[0,.5],angularVelocity:[-90,90],texture:e.getSprite("particle1").data.tex,quads:[e.getSprite("particle1").data.frames[0]]},{rate:0,direction:-90,spread:40,position:e.vec2()})]),e.add([e.pos(),e.particles({max:1e3,speed:[100,150],lifeTime:[1,1.5],angle:[0,360],colors:[e.rgb(255,255,255)],opacities:[1,.5],damping:[0,.5],texture:e.getSprite("particle4").data.tex,quads:[e.getSprite("particle4").data.frames[0]]},{rate:0,direction:-90,spread:40,position:e.vec2()})]),e.add([e.pos(),e.particles({max:1e3,speed:[10,40],lifeTime:[1,1.5],colors:[e.rgb(255,255,255)],opacities:[1,.5],scales:[1,.4,.1],acceleration:[e.vec2(0,1),e.vec2(0,2)],angularVelocity:[-90,90],texture:e.getSprite("particle1").data.tex,quads:[e.getSprite("particle1").data.frames[0]]},{rate:0,direction:-90,spread:0,position:e.vec2()})]),e.add([e.pos(),e.particles({max:1e3,speed:[5,40],angle:[0,360],lifeTime:[1,2],colors:[e.rgb(255,255,255)],opacities:[.7,.4],angularVelocity:[-90,90],scales:[1,.8,0],texture:e.getSprite("debree_part1").data.tex,quads:[e.getSprite("debree_part1").data.frames[0]]},{rate:0,direction:-90,spread:360,position:e.vec2()})]),oe=e.add([e.pos(),e.particles({max:1e3,speed:[60,80],angle:[0,360],lifeTime:[1,2],colors:[e.rgb(255,255,255)],angularVelocity:[-90,90],scales:[1,.8,.2,0],texture:e.getSprite("debree_part1").data.tex,quads:[e.getSprite("debree_part1").data.frames[0]]},{rate:0,direction:-90,spread:55,position:e.vec2()})]),he=e.add([e.pos(),e.particles({max:1e3,speed:[30,80],angle:[0,360],lifeTime:[.5,1.2],colors:[e.rgb(255,255,255)],opacities:[.8,.5],scales:[.4,2,1.2,.4,.1],damping:[1,2],texture:e.getSprite("particle3").data.tex,quads:[e.getSprite("particle3").data.frames[0]]},{rate:0,direction:-90,spread:360,position:e.vec2()})])}let b=null,F=-1,x=-1,V=0;function pt(t){b=t,F=0,x=-1}function ct(){if(!b)return!1;if(V+=e.dt()*1e3,b.levelLengthSeconds<V/1e3)return!0;if(F<b.waves.length&&b.waves[F].timeStamp<V&&x!=F&&(x=F,F++,b.waves[x].begin&&b.waves[x].begin(V)),x>0&&x<b.waves.length){const t=(b.waves[x].duration??0)+b.waves[x].timeStamp;if(V<t)return b.waves[x].upd(V-b.waves[x].timeStamp),b.lvlUpd(),!1}return!1}function De(){return b!=null}function Me(){b&&(ut(b),b=null,V=0)}function ut(t){F=-1,x=-1,t.reset()}const l={friendly:"friendly",enemy:"enemy",gameLoopUi:"game_loop_ui",blaster:"blaster",rocket:"rocket",debree:"debree",unit:"unit",part:"part",levelBg:"level_bg"};let $=[],ye=null;const gt=10,G=80;function mt(t){for(let r=0;r<t;r++){const a=gt*(r+1),s=e.add([e.pos(10,e.height()-a),e.rect(10,6),e.color(e.WHITE),e.opacity(1),l.gameLoopUi]);$.push(s)}e.add([e.pos(22,e.height()-4-G),e.rect(4,G),e.color(e.WHITE),e.opacity(.2),l.gameLoopUi]),ye=e.add([e.pos(22,e.height()-4-G),e.rect(4,G),e.color(e.WHITE),l.gameLoopUi])}function ht(t){const r=e.clamp(t,0,$.length-1);for(let a=$.length-1;a>r;a--)$[a].opacity=.2}function ft(t,r){ye.height=G*(t/r)}function vt(){e.destroyAll(l.gameLoopUi),$=[],ye=null}function R(t,r,a,s,o,i,p){const n=e.add([e.pos(t),e.move(r,Wt*o),e.area(),e.rotate(a),e.offscreen({destroy:!0}),e.anchor("center"),e.sprite("bullet1"),{dmg:s},...i]);n.onDestroy(()=>{const m=M.findIndex(f=>f.id==n.id);M.splice(m,1)}),p&&e.play("shoot1",{volume:.6}),M.push(n)}function W(t){t.animate("opacity",[0,1,0,1],{duration:.14,loops:1})}function ne(t,r,a,s,o){const i=r.sub(a).unit(),p=Math.atan2(i.y,i.x),n=e.rad2deg(p)+o,m=it(t,n);return{dir:i,lerp:e.lerp(t,m,s)}}function de(t,r,a){const s=e.deg2rad(r+90),o=Math.cos(s),i=Math.sin(s);t.move(o*a*-1,i*a*-1),t.angle=r,t.scale=e.vec2(1,Math.abs(i))}const bt=.5,xe=12,yt=400;function Ae(t,r,a,s,o,i,p,n,m,f,_){const c=e.add([e.pos(t),e.area(),e.rotate(a),e.offscreen({destroy:!0}),e.anchor("center"),e.scale(1),e.sprite("rocket1"),{impactDmg:s,splashDmg:o,splashSize:i,splashDmgFallof:p,splashDmgFallofDist:n,lifetime:0,speedMltp:m,dir:r,targetUnit:null,canSeek:_},...f]);e.play("fire_rocket1",{volume:.4}),c.onUpdate(()=>{c.lifetime+=e.dt();const h=e.clamp(zt*c.speedMltp*(.3+c.lifetime),0,yt),y=e.Vec2.fromAngle(c.angle-90);if(c.targetUnit){const{lerp:E}=ne(c.angle,c.pos,c.targetUnit.pos,.04,-90);de(c,E,h)}else c.move(y.x*h,y.y*h);const L=e.vec2(c.pos.x-xe*y.x,c.pos.y-xe*y.y);T.emitter.position=L,T.emitter.direction=c.angle,T.emit(1),c.canSeek&&c.lifetime>bt&&c.targetUnit==null&&Be(c.pos,200,"enemy",E=>{var pe;c.targetUnit=E,(pe=c.targetUnit)==null||pe.onDestroy(()=>{c.targetUnit=null})})}),c.onDestroy(()=>{const h=M.findIndex(L=>L.id==c.id);M.splice(h,1);const y=d.rocketShards;for(let L=0;L<y;L++){const E=360*(L/y);R(c.pos,e.Vec2.fromAngle(E),E+90,1,1,[l.friendly,l.blaster],!1)}}),M.push(c)}let H=0,fe=1,z=0;const ce=6;function St(){const t=e.add([e.pos(e.center()),e.sprite("ship"),e.rotate(0),e.scale(),e.health(d.maxHealth),e.area(),e.anchor("center"),e.animate(),l.friendly]);return W(t),re(d.blasterLvl,1)?(t.add([e.anchor("center"),e.pos(10,0)]),H++,t.add([e.anchor("center"),e.pos(-10,0)]),H++):(t.add([e.anchor("center"),e.pos(0,-6)]),H++),re(d.blasterLvl,2)&&(t.add([e.anchor("center"),e.pos(0,-6)]),H++),t.onDeath(()=>{e.destroy(t),w.emitter.position=t.pos,w.emit(20),e.play("explosion1",{volume:1}),jt()}),t.onUpdate(()=>{z<ce&&(z+=e.dt(),ft(z,ce)),te(t.pos,12,l.enemy,m=>{e.destroy(m),m.tags.includes(l.blaster)?t.hurt(m.dmg):m.tags.includes(l.rocket)&&(t.hurt(m.impactDmg),ee(m.pos,m.splashSize,m.splashDmg,m.splashDmgFallof,m.splashDmgFallofDist),e.play(A(),{volume:.6}),e.shake(3))});const r=t.pos.dist(e.mousePos())-12,{dir:a,lerp:s}=ne(t.angle,t.pos,e.mousePos(),.05,-90),o=d.speed*d.speedMultiplier*d.speedPwrUpMultiplier,i=e.clamp(r*4,0,o);t.angle=s;const p=e.Vec2.fromAngle(t.angle+90),n=e.vec2(t.pos.x+12*p.x,t.pos.y+12*p.y);i>4&&(T.emitter.position=n,T.emitter.direction=e.Vec2.toAngle(a),T.emit(1)),de(t,s,i)}),t.onHurt(()=>{e.play("hit2",{volume:.4}),t.animation.seek(0),e.shake(20),e.flash(e.RED,.4),ht(t.hp())}),t.onMousePress("left",()=>{if(re(d.blasterLvl,1)){if(re(d.blasterParallel,1)){for(let a=0;a<H;a++){const s=t.children[a];R(s.worldPos(),e.Vec2.fromAngle(t.angle-90),t.angle,d.blasterDmg*d.blasterDmgMultiplier,d.blasterSpeedMultiplier,[l.friendly,l.blaster],!0)}return}const r=t.children[fe%H];R(r.worldPos(),e.Vec2.fromAngle(t.angle-90),t.angle,d.blasterDmg*d.blasterDmgMultiplier,d.blasterSpeedMultiplier,[l.friendly,l.blaster],!0),fe++}}),t.onMousePress("right",()=>{d.rocketsLvl!==void 0&&(z<ce||(z=0,e.loop(.1,()=>{Ae(t.pos,e.Vec2.fromAngle(t.angle-90),t.angle,d.rocketImpactDmg*d.rocketDmgMultiplier,d.rocketSplashDmg*d.rocketDmgMultiplier,d.rocketSplashSize*d.rocketSplashSizeMultiplier,d.rocketSplashDmgFallDistanceValue,d.rocketSplashDmgFallOverDistance,1,[l.friendly,l.rocket],!0)},d.nrOfRockets)))}),t.onKeyDown("shift",()=>{d.canSprint!==void 0&&(d.speedPwrUpMultiplier=1.8*d.sprintSpeedMultiplier)}),t.onKeyRelease("shift",()=>{d.speedPwrUpMultiplier=1}),t}function wt(){fe=0,H=0}function Z(t,r){for(let a=0;a<r;a++){const s=e.add([e.pos(t),e.sprite("particle2"),e.animate({relative:!0}),e.rotate(e.rand(360)),e.opacity(1),{dir:e.rand(e.vec2(-1,-1),e.vec2(1,1)),speed:e.rand(40,60),lifeSpan:0},l.debree]);s.onUpdate(()=>{s.lifeSpan>s.speed||(s.move(s.dir.x*(s.speed-s.lifeSpan),s.dir.y*(s.speed-s.lifeSpan)),s.lifeSpan+=e.dt()*45)}),s.animate("opacity",[1,.5],{duration:1}),Q.push(s)}}function ue(t,r,a,s){const o=12*s,i=e.add([e.pos(t),e.sprite("enemy_ship1"),e.rotate(0),e.anchor("center"),e.health(a),e.animate(),e.scale(s),e.offscreen({destroy:!0}),{speed:e.rand(100,130),hb:o,targetPos:e.rand(e.vec2(e.width(),e.height()))},e.state("retreat",["attack","retreat"]),l.enemy,l.unit]);i.onStateEnter("retreat",async()=>{const p=e.rand(e.vec2(e.width(),e.height()));i.targetPos=p,await e.wait(1),i.enterState("attack")}),i.onStateEnter("attack",async()=>{await e.wait(3),i.enterState("retreat")}),i.onStateUpdate("attack",()=>{const p=U.pos;i.targetPos=p;const n=i.pos.dist(i.targetPos);n<50?i.enterState("retreat"):n>50&&n<200&&Math.floor(e.rand(0,200))==1&&R(i.pos,e.Vec2.fromAngle(i.angle-90),i.angle,2,1,[l.enemy,l.blaster],!0)}),W(i),i.onUpdate(()=>{const{lerp:p}=ne(i.angle,i.pos,i.targetPos,.01,-90);de(i,p,i.speed),te(i.pos,i.hb,l.friendly,n=>{e.destroy(n),n.tags.includes(l.blaster)?i.hurt(n.dmg):n.tags.includes(l.rocket)&&(i.hurt(n.impactDmg),ee(n.pos,n.splashSize,n.splashDmg,n.splashDmgFallof,n.splashDmgFallofDist),e.play(A(),{volume:.6}),e.shake(3))})}),i.onDeath(()=>{w.emitter.position=i.pos,w.emit(20),Z(i.pos,r),e.play(A(),{volume:.6}),e.destroy(i)}),i.onHurt(()=>{e.play("hit1",{volume:.6}),i.animation.seek(0)})}function K(t){const r=e.rand(1,2),a=12*r,s=e.add([e.pos(t.pos),e.sprite("asteroid1"),e.rotate(0),e.anchor("center"),e.scale(e.rand(1,2)),e.health(t.hp),e.animate(),e.offscreen({destroy:!0}),{vel:t.dir,rotVel:e.rand(-4,4),speed:t.speed,initScale:r,hb:a},l.enemy,l.unit]);W(s),s.onUpdate(()=>{s.move(s.vel.scale(s.speed)),s.angle+=s.rotVel,te(s.pos,s.hb,l.friendly,o=>{e.destroy(o),o.tags.includes(l.blaster)?(s.hurt(o.dmg),Z(s.pos,1)):o.tags.includes(l.rocket)&&(s.hurt(o.impactDmg),ee(o.pos,o.splashSize,o.splashDmg,o.splashDmgFallof,o.splashDmgFallofDist),e.play(A(),{volume:.6}),e.shake(3),oe.emitter.position=s.pos,oe.emitter.direction=o.angle-90,oe.emit(6))}),U.pos.dist(s.pos)<s.hb&&(U.hurt(1),s.hurt(t.hp))}),s.onDeath(()=>{if(w.emitter.position=s.pos,w.emit(20),Z(s.pos,t.scoreOnKill),e.play(A(),{volume:.6}),e.destroy(s),t.splitOnDeath)for(let o=0;o<t.splitOnDeath;o++)K({pos:s.pos,dir:e.rand(e.vec2(-1,-1),e.vec2(1,1)),scoreOnKill:t.scoreOnKill/2,hp:t.hp/2,speed:t.speed*2,splitOnDeath:0})}),s.onHurt(()=>{e.play("hit1",{volume:.6}),s.animation.seek(0)})}function _t(t,r,a,s,o){const p=e.add([e.pos(r),e.sprite(o),e.rotate(a.angle()-90),e.anchor("center"),e.health(s),e.animate(),e.offscreen({destroy:!0}),{vel:a,speed:e.rand(300,340),hb:12},l.enemy,l.unit]);W(p),p.onUpdate(()=>{p.move(p.vel.scale(p.speed)),te(p.pos,p.hb,l.friendly,n=>{e.destroy(n),n.tags.includes(l.blaster)?(p.hurt(n.dmg),Z(p.pos,1)):n.tags.includes(l.rocket)&&(p.hurt(n.impactDmg),ee(n.pos,n.splashSize,n.splashDmg,n.splashDmgFallof,n.splashDmgFallofDist),e.play(A(),{volume:.6}),e.shake(3))}),U.pos.dist(p.pos)<p.hb&&(U.hurt(1),p.hurt(s))}),p.onDeath(()=>{ae.emitter.position=p.pos,ae.emitter.direction=p.angle+90,ae.emit(20),e.play(A(),{volume:.6}),e.destroy(p),t.killed+=1}),p.onHurt(()=>{e.play("hit1",{volume:.6}),p.animation.seek(0)})}function Dt(t,r,a){const s=e.add([e.animate(),{startPos:t,endPos:r,opacity:.15,killed:0},l.enemy]);s.onUpdate(()=>{if(Math.floor(e.rand(0,100-a))==1){const o=Lt(6);_t(s,s.startPos.add(o),s.endPos.add(o).sub(s.startPos).unit(),4,xt())}s.opacity=e.wave(.1,.2,e.time()),s.killed>=5&&s.destroy()}),s.onDraw(()=>{e.drawLines({pts:[s.startPos,s.endPos],width:40,opacity:s.opacity})})}const Le=["enemy_ship1","bike1"];function xt(){return Le[Math.floor(e.rand(0,Le.length))]}function Lt(t){return e.rand(e.vec2(-6,-6),e.vec2(t,t))}function kt(t){const r=[],a=t.parts.find(s=>s.isBody);for(let s=0;s<t.parts.length;s++){const o=t.parts[s];W(o.obj),o.obj.onHurt(()=>{e.play("hit1",{volume:.6}),t.parts[s].obj.animation.seek(0)}),o.obj.onDeath(()=>{const i=o.isBody?o.obj.pos:a.obj.pos.sub(o.obj.pos);if(w.emitter.position=i,w.emit(20),Z(i,o.scoreOnDestroy),e.play(A(),{volume:.6}),o.isBody){delete J[o.obj.id],e.destroy(o.obj);return}o.obj.hidden=!0,o.obj.paused=!0,Pt(i,o.obj.sprite,e.rand(40,80)),a.obj.jitter(20)}),r.push({obj:o.obj,localPos:o.isBody?e.vec2(0,0):o.obj.pos,hitbox:o.hitbox,isBody:o.isBody})}return r}function Pt(t,r,a){const s=e.add([e.pos(t),e.sprite(r),e.lifespan(2,{fade:.2}),e.offscreen({destroy:!0}),e.opacity(1),e.scale(1),e.rotate(e.rand(0,360)),e.move(e.rand(e.vec2(-1,-1),e.vec2(1,1)),a),{spin:e.rand(2,8)}]);s.onUpdate(()=>{const o=e.wave(-1,1,e.time()*s.spin);s.scale=e.vec2(o,o)})}function ge(){return{jitterValue:0,id:"jitter",require:["pos"],update(){if(this.jitterValue>0){const r=this.jitterValue*8;var t=e.rand(e.vec2(-r,-r),e.vec2(r,r));this.move(t),this.jitterValue-=e.dt()*100}},jitter(t){this.jitterValue=t}}}const Tt=[6,2],J={};function me(t,r,a,s,o,i){const p=16*o,n=e.add([e.pos(t),e.sprite("enemy_ship1_body"),e.rotate(r.angle()+90),e.anchor("center"),e.health(s),e.animate(),e.scale(o),ge(),e.offscreen({destroy:!0}),{vel:r,speed:i,hb:p},l.enemy,l.unit]),m=n.add([e.pos(e.vec2(-6,-2)),e.sprite("enemy_ship1_left_wing"),e.anchor("center"),e.health(Math.floor(s/2)),e.animate(),ge(),l.part]),f=n.add([e.pos(e.vec2(Tt[0],-2)),e.sprite("enemy_ship1_right_wing"),e.anchor("center"),e.health(Math.floor(s/2)),e.animate(),ge(),l.part]);J[n.id]=kt({parts:[{obj:n,hitbox:8,isBody:!0,scoreOnDestroy:a},{obj:m,hitbox:8,isBody:!1,scoreOnDestroy:2},{obj:f,hitbox:8,isBody:!1,scoreOnDestroy:2}]}),n.onUpdate(()=>{n.move(n.vel.scale(n.speed)),Vt(n.pos,n.hb,l.friendly,J[n.id],(h,y)=>{e.destroy(h),h.tags.includes(l.blaster)?J[n.id][y].obj.hurt(h.dmg):h.tags.includes(l.rocket)&&(J[n.id][y].obj.hurt(h.impactDmg),ee(h.pos,h.splashSize,h.splashDmg,h.splashDmgFallof,h.splashDmgFallofDist),e.play(A(),{volume:.6}),e.shake(3))}),Math.floor(e.rand(0,500))==10&&R(n.pos,e.Vec2.fromAngle(n.angle-90),n.angle,2,1,[l.enemy,l.blaster],!0);const _=e.Vec2.fromAngle(n.angle-90),c=e.vec2(n.pos.x-12*_.x,n.pos.y-12*_.y);T.emitter.position=c,T.emitter.direction=e.Vec2.toAngle(_),T.emit(1)})}function Ut(t,r,a){const s=document.getElementById("song"),o=document.getElementById("song_title"),i=document.getElementById("song_author"),p=document.getElementById("song_cover");i.textContent=r,o.textContent=t,p.setAttribute("src",a),s==null||s.classList.add("show")}function Mt(){const t=document.getElementById("song");t==null||t.classList.remove("show")}let k={},g=0,D=0,B=0,ke;const P={music:"arcadia",songTitle:"Arcadia",songAuthor:"Dunderpatrullen",songAlbumCover:"/covers/arcadia_cover.jpg",bpm:.44,title:"",introduceSound:"",levelLengthSeconds:190,reset:()=>{k={},ke.stop(),Mt()},lvlUpd:()=>{},waves:[{timeStamp:0,begin:()=>{ke=e.play(P.music,{volume:.9})},upd:()=>{}},{timeStamp:3500,begin:()=>{Ut(P.songTitle,P.songAuthor,P.songAlbumCover)},upd:()=>{}},{timeStamp:4500,begin:t=>{var r=e.add([e.pos(e.center()),e.anchor("center"),e.animate(),e.text("...INIT SPACEJUMP...",{font:"",size:42}),l.gameLoopUi]);r.animate("opacity",[1,0],{loops:5,duration:.7}),k.txt=r},upd:()=>{}},{timeStamp:4550,duration:3550,begin:()=>{k.lines=[]},upd:t=>{var r=e.rand(e.vec2(e.width(),e.height())),a=e.add([e.pos(r),e.rect(2,4*(t/100)),e.color(e.WHITE),"dust"]);k.lines.push(a);for(let s=0;s<k.lines.length;s++)k.lines[s].move(0,-10*(t/50));t>2e3&&e.shake(.01*(t/100))}},{timeStamp:8120,begin:()=>{e.destroyAll("dust"),e.flash(e.WHITE,1),e.destroy(k.txt),delete k.lines;const t=40;for(let a=0;a<t;a++){var r=e.rand(e.vec2(e.width(),e.height()));U.pos.dist(r)<200||K({pos:r,dir:e.DOWN,scoreOnKill:1,hp:3,speed:e.rand(20,40),splitOnDeath:2})}e.add([e.pos(100),e.color(e.rgb(50,50,50)),e.sprite("bg_moon1"),e.scale(2),e.layer(N.bg),l.levelBg]),e.add([e.pos(100,400),e.color(e.rgb(50,50,50)),e.sprite("bg_building1"),e.scale(2),e.layer(N.bg),l.levelBg])},upd:t=>{}},{timeStamp:16e3,begin:()=>{var t=e.add([e.pos(e.center()),e.anchor("center"),e.animate(),e.text("!!THREAT DETECTED!!",{font:"",size:42}),l.gameLoopUi]);t.animate("opacity",[1,0],{loops:10,duration:P.bpm}),k.txt=t},upd:t=>{}},{timeStamp:21e3,begin:()=>{e.destroy(k.txt);const t=6;for(let r=0;r<t;r++){const a=O(.25*(r/t));me(a,e.DOWN,3,5,1,e.rand(40,60))}},upd:t=>{}},{timeStamp:18790,begin:()=>{e.flash(e.WHITE,P.bpm);const t=12;for(let r=0;r<t;r++){const a=O(1*(r/t));me(a,e.Vec2.fromAngle(a.angleBetween(e.center())),3,5,1,e.rand(40,60))}},upd:t=>{}},{timeStamp:22790,begin:()=>{e.flash(e.WHITE,P.bpm);const t=12;for(let r=0;r<t;r++){const a=O(1*(r/t));me(a,e.Vec2.fromAngle(a.angleBetween(e.center())),3,5,1,e.rand(40,60))}},upd:t=>{}},{timeStamp:36744,duration:1e3,begin:()=>{e.shake(10)},upd:t=>{if(g+=e.dt(),g>=.05){const r=e.rand(1);ue(O(r),2,2,1),g=0}}},{timeStamp:43824,duration:1500,begin:()=>{g=0,D=0,B=30},upd:t=>{if(g+=e.dt(),g>=.03&&D<B){const r=.25+.25*(D/B);K({pos:O(r),dir:e.LEFT,scoreOnKill:1,hp:3,speed:40,splitOnDeath:2}),D++,g=0}}},{timeStamp:45600,duration:1500,begin:()=>{g=0,D=0,B=30},upd:t=>{if(g+=e.dt(),g>=.03&&D<B){const r=.75+.25*(D/B);K({pos:O(r),dir:e.RIGHT,scoreOnKill:1,hp:3,speed:40,splitOnDeath:2}),D++,g=0}}},{timeStamp:47e3,duration:5e3,begin:()=>{g=0,D=0,B=30},upd:t=>{if(g+=e.dt(),g>=.03&&D<B){for(let r=0;r<2;r++){const a=.5*r+.25*(D/B);K({pos:O(a),dir:r==0?e.DOWN:e.UP,scoreOnKill:1,hp:3,speed:40,splitOnDeath:2})}D++,g=0}}},{timeStamp:66e3,duration:14e3,begin:()=>{g=0},upd:t=>{if(g+=e.dt(),g>=P.bpm*2){const r=e.rand(1);ue(O(r),2,2,1),g=0}}},{timeStamp:79300,begin:()=>{g=0;for(let t=0;t<2;t++){const r=200+300*t;Dt(e.vec2(0,r),e.vec2(e.width(),r),10)}},upd:t=>{if(g+=e.dt(),g>=P.bpm){const r=e.rand(1);ue(O(r),2,2,1),g=0}}}]};function At(){return{lockedTarget:null,id:"target",require:["pos"],pickTarget(t,r,a){return this.lockedTarget?!0:Be(t,r,a,s=>{this.lockedTarget=s,this.lockedTarget.onDestroy(()=>{this.lockedTarget=null})})},hasTarget(){return this.lockedTarget},targetAngle(){return this.lockedTarget?this.lockedTarget.pos.angle(this.pos):this.angle}}}function Bt(t){const a=e.add([e.pos(t.pos),e.sprite("follower"),e.rotate(0),e.anchor("center"),e.scale(.4),e.health(t.hp),At(),e.animate(),e.offscreen({destroy:!0}),{speed:t.speed,hb:12,dmg:t.blasterDmg,missiles:t.canUseMissiles},l.friendly,l.unit]);W(a),a.onUpdate(()=>{const{lerp:s}=ne(a.angle,a.pos,t.follow.pos,.015,-90);de(a,s,a.speed),te(a.pos,a.hb,l.enemy,o=>{e.destroy(o),o.tags.includes(l.blaster)&&a.hurt(o.dmg)}),a.missiles&&a.hasTarget()&&Math.floor(e.rand(0,300))==1&&Ae(a.pos,e.Vec2.fromAngle(a.angle-90),a.angle,d.rocketImpactDmg*d.rocketDmgMultiplier,d.rocketSplashDmg*d.rocketDmgMultiplier,d.rocketSplashSize*d.rocketSplashSizeMultiplier,d.rocketSplashDmgFallDistanceValue,d.rocketSplashDmgFallOverDistance,.8,[l.friendly,l.rocket],!0),Math.floor(e.rand(0,110))==1&&a.pickTarget(a.pos,400,l.enemy)&&R(a.pos,e.Vec2.fromAngle(a.targetAngle()),a.targetAngle()+90,a.dmg,2,[l.friendly,l.blaster],!0)}),a.onDeath(()=>{w.emitter.position=a.pos,w.emit(20),e.play(A(),{volume:.6}),e.destroy(a)}),a.onHurt(()=>{e.play("hit1",{volume:.6}),a.animation.seek(0)})}const Ot=1;let U,ie=0,Q=[];const M=[];function Et(){U=St(),mt(d.maxHealth)}function It(){const t=e.dt();if(ie+=t,ie>=Ot&&!De()){pt(P);for(let r=0;r<d.nrOfFollowers;r++)Bt({follow:U,hp:6,pos:e.vec2(e.rand(e.width()),0),speed:e.rand(80,110),blasterDmg:d.followerBlasterDmg*d.followerBlasterDmgMultiplier,canUseMissiles:d.followerCanUseMissiles!==void 0})}De()&&ct()&&(ie=0,Me());for(let r=0;r<Q.length;r++){const a=Q[r],s=a.pos.dist(U.pos);s<d.debreeSeekDistance*d.debreeSeekDistanceMultiplier&&(a.moveTo(U.pos,d.debreeSeekSpeed*d.debreeSeekSpeedMultiplier),s<d.debreePickupDistance&&(e.destroy(a),Q.splice(r,1),e.play("collect1",{volume:.6}),He(d.scorePerPickup),r--))}}function jt(){wt(),ie=0,Q=[],Me(),e.destroyAll(l.enemy),e.destroyAll(l.blaster),e.destroyAll(l.rocket),e.destroyAll(l.enemy),e.destroyAll(l.levelBg),e.destroyAll(l.unit),e.destroyAll(l.debree),vt(),we(q.LevelUp)}function ee(t,r,a,s,o){const i=e.query({include:[l.enemy,l.unit],includeOp:"and"});he.emitter.position=t,he.emit(14);for(let p=0;p<i.length;p++)i[p].pos.dist(t)<r&&i[p].hurt(a)}function te(t,r,a,s){for(let o=0;o<M.length;o++){const i=M[o];if(i.pos.dist(t)<r){if(!i.tags.includes(a))continue;s(i)}}}function Vt(t,r,a,s,o){for(let i=0;i<M.length;i++){const p=M[i];if(p.pos.dist(t)<r){if(!p.tags.includes(a))continue;for(let n=0;n<s.length;n++)if(!s[n].obj.hidden&&p.pos.dist(t.sub(s[n].localPos))<s[n].hitbox){o(p,n);return}}}}function Be(t,r,a,s){const o=e.query({include:[a,l.unit],includeOp:"and"});for(let i=0;i<o.length;i++){const p=o[i];if(p.pos.dist(t)<r)return s(p),!0}return!1}const Y="ui_grid";let I,u={group:void 0,title:void 0,header:void 0,desc:void 0,icon:void 0},ve={},Oe,Ee;function Ht(){const t=e.center(),r=be(e.vec2(t.x,40),"ui");r.add([e.text("UPGRADE",{size:22,font:"unscii"}),e.anchor("center")]),Oe=Rt(r,12,Ve(C),e.vec2(0,50)),Ie(t),u.group=be(e.vec2(t.x+t.x/2-100,t.y-t.y/2-40),"ui"),u.group.hidden=!0,Ct(),Nt("START GAME",e.vec2(t.x,t.y*2-60),()=>{Ft(),we(q.Playing)})}function Ft(){e.destroyAll("ui"),e.destroyAll(Y)}function Ie(t){e.destroyAll(Y);const r=be(e.vec2(60,t.y),Y);var a=X,s=Object.entries(a).filter(([f,_])=>_.requiredTool?j[_.requiredTool]!==void 0:!0).map(([f,_])=>f);const o=4;let i=-1;const p=42,n=8,m=16;for(let f=0;f<s.length;f++){const _=X[s[f]],c=Pe(s[f]);f%o==0&&i++;const h=f-o*i,y=r.add([e.pos(e.vec2((p+n)*h,(p+n)*i)),e.rect(p,p),e.area(),e.color(0,0,0),e.anchor("center"),e.outline(1,new e.Color(255,255,255)),Y]),L=y.add([e.rect(p+6,p+6),e.pos(0,0),e.color(0,0,0),e.anchor("center"),e.outline(2,new e.Color(255,255,255)),Y]);L.hidden=!0,ve[s[f]]=L,c>0&&y.add([e.pos(m,-21),e.rect(m,m),e.anchor("center"),e.color(255,255,255)]).add([e.text(`${c}`,{size:14,font:"unscii"}),e.pos(0,2),e.anchor("center"),e.color(0,0,0)]);const E=e.clamp(c,0,_.upgrades.length-1);y.add([e.sprite(_.upgrades[E].sprite,{height:24,width:24}),e.anchor("center")]),y.onClick(()=>qt(s[f],c,y.worldPos()))}}function qt(t,r,a){I&&(ve[I.key].hidden=!0),ve[t].hidden=!1,je(t,r),e.play("click1",{volume:1}),Ee=a}function Ct(){u.header=u.group.add([e.text("LEVEL 1",{size:10,font:"unscii"}),e.anchor("top"),e.pos(200/2,0)]),u.title=u.group.add([e.text("BLASTER",{size:14,font:"unscii"}),e.anchor("top"),e.pos(200/2,22)]);const a=u.group.add([e.pos(0,80),e.rect(200,300),e.color(0,0,0),e.outline(2,new e.Color(255,255,255))]),s=a.add([e.rect(200/2,60),e.color(0,0,0),e.anchor("center"),e.pos(200/2,10),e.outline(2,new e.Color(255,255,255))]);u.icon=s.add([e.sprite("ship",{height:32,width:32}),e.anchor("center")]),u.desc=a.add([e.pos(0,80),e.text("EQUIPE YOUR SHIP WITH A LASER BLASTER, LEFT MOUSE TO FIRE",{size:12,font:"unscii",width:200,align:"center",lineSpacing:12})]),u.purchaseBtn=u.group.add([e.rect(240,50),e.area(),e.opacity(1),e.anchor("center"),e.pos(200/2,340)]),u.purchaseBtnText=u.purchaseBtn.add([e.text("PURCHASE 12P",{size:16,font:"unscii"}),e.color(0,0,0),e.anchor("center")]),u.purchaseBtn.onClick(()=>{var i;if(u.group.hidden||(i=u.purchaseBtn)!=null&&i.hidden)return;const o=X[I.key].upgrades[I.index];if(C<o.price){e.play("error",{volume:.4});return}He(-o.price),st(I.key),Ie(e.center()),je(I.key,I.index+1),w.emitter.position=Ee,w.emit(20),Ue(),e.play("purchase1",{volume:.8}),Oe.text=Ve(C)})}function je(t,r){const a=X[t],s=e.clamp(r,0,a.upgrades.length-1);u.group.hidden=!1;const o=a.upgrades[s];if(u.title.text=a.toolName.toUpperCase(),u.desc.text=o.desc.toUpperCase(),u.header.text=o.name.toUpperCase(),u.icon.sprite=o.sprite,I={key:t,index:s},r!=s){u.purchaseBtn.hidden=!0;return}if(u.purchaseBtnText.text=`PURCHASE ${o.price}P`,u.purchaseBtn.hidden=!1,C<o.price){u.purchaseBtn.opacity=.3;return}u.purchaseBtn.opacity=1}function Nt(t,r,a){const s=e.add([e.pos(r),e.rect(300,50),e.area(),e.color(0,0,0),e.anchor("center"),"ui"]);return s.add([e.text(t,{size:16,font:"unscii"}),e.anchor("center")]),s.onClick(a),s}function Rt(t,r,a,s){return t.add([e.rect(80,40),e.pos(s),e.anchor("center"),e.outline(2,new e.Color(255,255,255)),e.color(0,0,0)]).add([e.text(a,{size:r,font:"unscii"}),e.anchor("center")])}function be(t,r){return e.add([e.pos(t),r])}function Ve(t){return`${t}P`}const N={bg:"bg",game:"game",ui:"ui"},q={Playing:1,LevelUp:2},se=-22;let C=60;const Wt=320,zt=280;let Se=0;const S=[];let le=q.Playing;const e=Fe({background:"#000000",global:!1,scale:1.3,width:600,height:600});ot(e).then(()=>{dt(),Gt(),e.setLayers([N.bg,N.game,N.ui],N.game),Kt(),we(q.LevelUp),e.onUpdate(()=>{le==q.Playing&&(Se+=e.dt(),It())})});function we(t){le=t,le==q.Playing?Et():le==q.LevelUp&&(Te("slot1"),Ht())}function He(t){C+=t}function Gt(){var t=nt("slot1");t&&(at(t.loadout),C=t.score,Se=t.time,Ue())}function Kt(){const t=e.center();S.push(e.vec2(22,22)),S.push(e.vec2(t.x*2+se,22)),S.push(e.vec2(t.x*2+se,t.y*2+se)),S.push(e.vec2(22,t.y*2+se))}function O(t){const r=Math.floor(S.length*t),a=1/S.length*r,s=(t-a)*S.length,o=(r+1>=S.length?S[0]:S[r+1]).sub(S[r]),i=e.clamp(r,0,S.length-1);return S[i].add(o.scale(s))}
//# sourceMappingURL=index-BnK1odDY.js.map
